  <HTML>
  <HEAD>
  <!-- This HTML file has been created by texi2html 1.52 (hacked by david@detron.se)
     from manual.ja.texi on 1 December 1999 -->

  <TITLE>MySQL Reference Manual for version 3.22.21. - 12  MySQL ユーティリティ</TITLE>
  </HEAD>
  <BODY BGCOLOR=#FFFFFF TEXT=#000000 LINK=#101090 VLINK=#7030B0>
Go to the <A HREF="manual.ja_Introduction.html">first</A>, <A HREF="manual.ja_MySQL_Benchmarks.html">previous</A>, <A HREF="manual.ja_Maintenance.html">next</A>, <A HREF="manual.ja_Concept_Index.html">last</A> section, <A HREF="manual.ja_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="Tools" HREF="manual.ja_toc.html#Tools">12  <STRONG>MySQL</STRONG> ユーティリティ</A></H1>

<P>
<A NAME="IDX639"></A>


<H2><A NAME="Programs" HREF="manual.ja_toc.html#Programs">12.1  様々な <STRONG>MySQL</STRONG> プログラムの概要</A></H2>

<P>
サーバと通信する <CODE>mysqlclient</CODE> ライブラリを使用している全ての 
<STRONG>MySQL</STRONG> クライアントは次の環境変数を使用します:

</P>
<P>
<A NAME="IDX640"></A>
<A NAME="IDX641"></A>
<A NAME="IDX642"></A>
<A NAME="IDX643"></A>
<A NAME="IDX644"></A>
<A NAME="IDX645"></A>
<A NAME="IDX646"></A>
<A NAME="IDX647"></A>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD><STRONG>Name</STRONG> </TD><TD> <STRONG>Description</STRONG>
</TR NOSAVE>
<TR><TD><CODE>MYSQL_UNIX_PORT</CODE> </TD><TD> デフォルトのソケット; <CODE>localhost</CODE> への接続に使用される
</TR NOSAVE>
<TR><TD><CODE>MYSQL_TCP_PORT</CODE> </TD><TD> デフォルトの TCP/IP ポート
</TR NOSAVE>
<TR><TD><CODE>MYSQL_PWD</CODE> </TD><TD> デフォルトのパスワード
</TR NOSAVE>
<TR><TD><CODE>MYSQL_DEBUG</CODE> </TD><TD> デバッグオプション
</TR NOSAVE>
<TR><TD><CODE>TMPDIR</CODE> </TD><TD> 一時 tables/files が作成されるディレクトリ
</TR>
</TABLE>

</P>
<P>
<CODE>MYSQL_PWD</CODE> の使用は安全ではありません。
 「<A HREF="manual.ja_Privilege_system.html#Connecting">6.3  <STRONG>MySQL</STRONG> サーバーに接続</A>」節参照.

</P>
<P>
<A NAME="IDX648"></A>
<A NAME="IDX649"></A>
<A NAME="IDX650"></A>
<A NAME="IDX651"></A>
<A NAME="IDX652"></A>
<A NAME="IDX653"></A>
<A NAME="IDX654"></A>
<TT>`mysql'</TT> クライアントは、<CODE>MYSQL_HISTFILE</CODE> 環境変数に
指定されているファイルにコマンドラインの履歴を書き出します。
デフォルトの履歴ファイルは、 <TT>`$HOME/.mysql_history'</TT> で、<CODE>$HOME</CODE> は
 <CODE>HOME</CODE> 環境変数の値です。

</P>
<P>
全ての <STRONG>MySQL</STRONG> プログラムは多くの様々なオプションを持ちます。種々
のオプションの完全な説明を得るにはスイッチ <CODE>--help</CODE> を使用してください。例
えば<CODE>mysql --help</CODE> を試してください。

</P>
<P>
オプションファイルで、全ての標準クライアントのデフォルトのオプションを
変更することが可能です。
 「<A HREF="manual.ja_Installing.html#Option_files">4.15.4  オプションファイル ( <CODE>my.cnf</CODE> )</A>」節.

</P>
<P>
<STRONG>MySQL</STRONG> プログラムを以下に示します:

</P>
<DL COMPACT>

<DT><CODE>myisamchk</CODE>
<DD>
<A NAME="IDX655"></A>
 
<STRONG>MySQL</STRONG> テーブルをチェック, 最適化そして修復します。
<CODE>myisamchk</CODE> には多くの機能があるので、一章割り当てて説明しています。
 「<A HREF="manual.ja_Maintenance.html#Maintenance">13  Maintaining a <STRONG>MySQL</STRONG> installation</A>」節参照.

<A NAME="IDX656"></A>
<DT><CODE>make_binary_release</CODE>
<DD>
コンパイルされた <STRONG>MySQL</STRONG> のバイナリリリースを作成します。これは他
の MySQL ユーザの利便のために、ftp で <CODE>ftp.tcx.se</CODE> の  <TT>`/pub/mysql/Incoming'</TT>
に送ることができます。

<A NAME="IDX657"></A>
<DT><CODE>msql2mysql</CODE>
<DD>
<CODE>mSQL</CODE> プログラムを <STRONG>MySQL</STRONG> に変換するシェルスクリプト。全て
のケースで処理できるわけではありませんが、変換時に良いスタートを与えます。

<A NAME="IDX658"></A>
<A NAME="IDX659"></A>
<DT><CODE>mysql</CODE>
<DD>
<CODE>mysql</CODE> は簡単な SQL シェル (GNU <CODE>readline</CODE> つき) です。これは対話的な使用や
非対話型問い合わせをサポートします。対話的に使用されると、ASCII テーブル
形式で結果が与えられます。フィルタとして使用されると、出力はタブで区切ら
れます（これは起動時のオプションで他のものに変更できます）。
あなたは以下のように簡単にスクリプトを実行できます:


<PRE>
shell&#62; mysql database &#60; script.sql &#62; output.tab
</PRE>

クライアントのメモリが十分でないことによる問題がある場合は、
<CODE>--quick</CODE> スイッチを使用してください！ これは結果を取り出すのに 
 <CODE>mysql_store_result()</CODE> の代わりに <CODE>mysql_use_result()</CODE> を使用
するように <CODE>mysql</CODE> に強制させます。

<A NAME="IDX660"></A>
<DT><CODE>mysqlaccess</CODE>
<DD>
ホスト, ユーザそしてデータベースの組合せで特権をチェックするためのスクリ
プト。

<A NAME="IDX661"></A>
<DT><CODE>mysqladmin</CODE>
<DD>
管理ユーティリティ。データベースの作成/破棄。reload (新しいユーザの読み
込み) と refresh (ディスクへのテーブルのフラッシュ, ログファイルの再オー
プン)。サーバのバージョンと処理と状態情報も与えます。
 「<A HREF="manual.ja_Tools.html#mysqladmin">12.2  <STRONG>MySQL</STRONG> サーバーの管理　( <CODE>mysqladmin</CODE> )</A>」節参照.

<A NAME="IDX662"></A>
<DT><CODE>mysqlbug</CODE>
<DD>
<STRONG>MySQL</STRONG> バグレポートスクリプト。
このスクリプトは <STRONG>MySQL</STRONG> メーリングリストにバグレポートを出す際、
常に使用します。

<A NAME="IDX663"></A>
<DT><CODE>mysqld</CODE>
<DD>
SQL デーモン。これは常に実行されてます。

<A NAME="IDX664"></A>
<DT><CODE>mysqldump</CODE>
<DD>
<STRONG>MySQL</STRONG> データベースの SQL ステートメントまたはタブで区切られたテ
キストのファイルにダンプします。Igor Romanenko によって独創的にエンハン
スされたフリーウェア。
 「<A HREF="manual.ja_Tools.html#mysqldump">12.3  <STRONG>MySQL</STRONG> データベースとテーブルから、構造とデータをダンプ　( <CODE>mysqldump</CODE> )</A>」節参照.

<A NAME="IDX665"></A>
<DT><CODE>mysqlimport</CODE>
<DD>
一つまたは複数のテキストファイルをそれぞれのテーブルに読み込みます。<CODE>LOAD
DATA INFILE</CODE> でサポートされる全ての形式を使用できます。  「<A HREF="manual.ja_Tools.html#mysqlimport">12.4  テキストファイルからデータを取り込む　( <CODE>mysqlimport</CODE> )</A>」節参照.

<A NAME="IDX666"></A>
<DT><CODE>mysqlshow</CODE>
<DD>
データベース, テーブル, 項目そしてインデックスについての情報を表示します。

<A NAME="IDX667"></A>
<DT><CODE>mysql_install_db</CODE>
<DD>
<STRONG>MySQL</STRONG> 承認テーブルをデフォルト特権で作成します。これは通常、最
初の <STRONG>MySQL</STRONG> リリースを新しいシステム上にインストールする時に一回
だけ実行されます。

<A NAME="IDX668"></A>
<DT><CODE>replace</CODE>
<DD>
<CODE>msql2mysql</CODE> で使用されるバイナリ。ファイル内または標準入力上の文字列を変
換するユーティリティプログラム。より長い文字列に最初に適合するため有限状
態マシンを使用します。文字列を交換するために使用できます。例えば、
<CODE>a</CODE> と <CODE>b</CODE> を与えられたファイル内で交換します:


<PRE>
shell&#62; replace a b b a -- file1 file2 ...
</PRE>

<A NAME="IDX669"></A>

<DT><CODE>safe_mysqld</CODE>
<DD>
<CODE>mysqld</CODE> デーモンをいくつかの安全な機能で開始します。エラー時には再起動し、
実行時情報をログファイルへ記入します。
</DL>



<H2><A NAME="mysqladmin" HREF="manual.ja_toc.html#mysqladmin">12.2  <STRONG>MySQL</STRONG> サーバーの管理　( <CODE>mysqladmin</CODE> )</A></H2>

<P>
管理オペレーションを実行するためのユーティリティ。シンタックスは: 

</P>

<PRE>
shell&#62; mysqladmin [OPTIONS] command [command-option] command ...
</PRE>

<P>
<CODE>mysqladmin --help</CODE> によって、オプションの一覧を手にいれることができます。

</P>
<P>
現在の <CODE>mysqladmin</CODE> は以下のコマンドをサポートします：

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>create databasename </TD><TD> データベースの作成
</TR NOSAVE>
<TR><TD>drop databasename </TD><TD> データベースとテーブルの全削除。
</TR NOSAVE>
<TR><TD>extended-status </TD><TD> サーバーから拡張ステータスを取得。
</TR NOSAVE>
<TR><TD>flush-hosts </TD><TD> キャッシュされている全ホストをフラッシュ。
</TR NOSAVE>
<TR><TD>flush-logs </TD><TD> 全てのログをフラッシュ
</TR NOSAVE>
<TR><TD>flush-tables </TD><TD> 全てのテーブルをフラッシュ
</TR NOSAVE>
<TR><TD>flush-privileges </TD><TD> 許可テーブルの再読み込み (reload と同じ)
</TR NOSAVE>
<TR><TD>kill id,id,... </TD><TD> mysql スレッドの kill.
</TR NOSAVE>
<TR><TD>password new-password </TD><TD> 古いパスワードを new-password に変更
</TR NOSAVE>
<TR><TD>ping </TD><TD> mysqld が生きているかチェック
</TR NOSAVE>
<TR><TD>processlist </TD><TD> 現在活動中の mysql スレッドを表示
</TR NOSAVE>
<TR><TD>reload </TD><TD> 許可テーブルの再読み込み
</TR NOSAVE>
<TR><TD>refresh </TD><TD> 全テーブルをフラッシュし、ログファイルを一度閉じて開きます。
</TR NOSAVE>
<TR><TD>shutdown </TD><TD> サーバーをダウンさせます。
</TR NOSAVE>
<TR><TD>status </TD><TD> サーバーから短いステータスを得ます。
</TR NOSAVE>
<TR><TD>variables </TD><TD> 変数の表示
</TR NOSAVE>
<TR><TD>version </TD><TD> サーバーからバージョンを得ます。
</TR>
</TABLE>

<P>
全てのコマンドは、ユニークなプレフィックスで省略可能です。
例えば：

</P>

<PRE>
shell&#62; mysqladmin proc stat
+----+-------+-----------+----+-------------+------+-------+------+
| Id | User  | Host      | db | Command     | Time | State | Info |
+----+-------+-----------+----+-------------+------+-------+------+
| 6  | monty | localhost |    | Processlist | 0    |       |      |
+----+-------+-----------+----+-------------+------+-------+------+
Uptime: 10077  Threads: 1  Questions: 9  Slow queries: 0  Opens: 6  Flush tables: 1  Open tables: 2  Memory in use: 1092K  Max memory used: 1116K
</PRE>

<P>
<CODE>mysqladmin status</CODE> コマンドの結果は、以下の項目を持ちます:

</P>
<TABLE BORDER WIDTH="100%" NOSAVE >
<TR><TD>Uptime </TD><TD> <STRONG>MySQL</STRONG> サーバーの起動秒数
</TR NOSAVE>
<TR><TD>Threads </TD><TD> 稼働中のスレッド数 (clients)
</TR NOSAVE>
<TR><TD>Questions </TD><TD> <CODE>mysqld</CODE> が開始してからのクライアントからのクエリ数
</TR NOSAVE>
<TR><TD>Slow queries </TD><TD> <CODE>long_query_time</CODE> 秒より時間のかかったクエリの数
</TR NOSAVE>
<TR><TD>Opens </TD><TD> <CODE>mysqld</CODE> が開いたテーブル数
</TR NOSAVE>
<TR><TD>Flush tables </TD><TD> <CODE>flush ...</CODE>, <CODE>refresh</CODE> and <CODE>reload</CODE> コマンドの実行回数
</TR NOSAVE>
<TR><TD>Open tables </TD><TD> 現在開かれているテーブルの数
</TR NOSAVE>
<TR><TD>Memory in use </TD><TD> mysqld のコードによって直接割り当てられたメモリ (only available when <STRONG>MySQL</STRONG> is compiled with --with-debug)
</TR NOSAVE>
<TR><TD>Max memory used </TD><TD> mysqld のコードによって直接割り当てられる最大メモリー量 (only available when <STRONG>MySQL</STRONG> is compiled with --with-debug)
</TR>
</TABLE>



<H2><A NAME="mysqldump" HREF="manual.ja_toc.html#mysqldump">12.3  <STRONG>MySQL</STRONG> データベースとテーブルから、構造とデータをダンプ　( <CODE>mysqldump</CODE> )</A></H2>

<P>
データベース、あるいは、
バックアップ、他のSQLサーバーへのデータを移動を目的としたデータのまとまり、
これらをダンプするためのユーティリティ。
ダンプは、テーブルの作成のための SQL 文を含みます。

</P>

<PRE>
shell&#62; mysqldump [OPTIONS] database [tables]
</PRE>

<P>
もしテーブルを与えなければ、データベースの全てのテーブルがダンプされます。

</P>
<P>
<CODE>mysqldump --help</CODE> によって、オプションの一覧を手にいれることができます。

</P>
<P>
もし <CODE>mysqldump</CODE> を <CODE>--quick</CODE> や <CODE>--opt</CODE> なしで実行するならば、
<CODE>mysqldump</CODE> は結果を表示する前に、結果をメモリに全てロードすることに
注意してください。
これは大きなデータベースをダンプする際に問題になるでしょう。

</P>
<P>
<CODE>mysqldump</CODE> は以下のオプションをサポートします：

</P>
<DL COMPACT>

<DT><CODE>--add-locks</CODE>
<DD>
テーブルのダンプの前に <CODE>LOCK TABLES</CODE> 文を追加し、
テーブルのダンプ後に <CODE>UNLOCK TABLE</CODE> 文を追加します。
( あとで <STRONG>MySQL</STRONG> に挿入するときにこれは速くなります ).
<DT><CODE>--add-drop-table</CODE>
<DD>
テーブルの create 文の前に、<CODE>drop table</CODE> 文を追加します。
<DT><CODE>--allow-keywords</CODE>
<DD>
キーワード(予約語) と同じ名前をもつフィールドの作成を許します。
これは、それぞれのフィールドの前に、テーブル名を付け足します。
<DT><CODE>-c, --complete-insert</CODE>
<DD>
完全な INSERT 文(フィールド名を書いた文) を使用します。
<DT><CODE>-C, --compress</CODE>
<DD>
もしサーバーとクライアントの双方が圧縮をサポートしているならば、
両者の間で行われる通信を全て圧縮します。
<DT><CODE>--delayed</CODE>
<DD>
<CODE>INSERT DELAYED</CODE> コマンドを使用してレコードを INSERT します。
<DT><CODE>-e, --extended-insert</CODE>
<DD>
新しいマルチライン <CODE>INSERT</CODE> 構文を使用します。(これはあとで挿入する際、
よりコンパクトかつ速くなります。)
<DT><CODE>-#, --debug[=option_string]</CODE>
<DD>
Trace usage of the program (for debugging).
<DT><CODE>--help</CODE>
<DD>
Display a help message and exit.
<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
<DT><CODE>--fields-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-optionally-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-escaped-by=...</CODE>
<DD>
<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
これらのオプションは <CODE>-T</CODE> とともに使用され、
<CODE>LOAD DATA INFILE</CODE> と同様の意味をなします。
 「<A HREF="manual.ja_Reference.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE>構文</A>」節参照.
<DT><CODE>-F, --flush-logs</CODE>
<DD>
ダンプする前に、 <STRONG>MySQL</STRONG> サーバーのログファイルをフラッシュします。
<DT><CODE>-f, --force,</CODE>
<DD>
ダンプの途中で SQL エラーが発生しても、ダンプを続けます。
<DT><CODE>-h, --host=..</CODE>
<DD>
指定されたホストの <STRONG>MySQL</STRONG> サーバーからダンプします。
デフォルトのホストは <CODE>localhost</CODE>.
<DT><CODE>-l, --lock-tables.</CODE>
<DD>
ダンプを開始するとき全てのテーブルをロックします。
<DT><CODE>-t, --no-create-info</CODE>
<DD>
テーブルの作成情報( <CODE>CREATE TABLE</CODE> 文) を書き出しません。
<DT><CODE>-d, --no-data</CODE>
<DD>
テーブル内のレコードを書き出しません。
これはテーブルの構造だけを取り出したいときにとても便利です！
<DT><CODE>--opt</CODE>
<DD>
<CODE>--quick --add-drop-table --add-locks --extended-insert --lock-tables</CODE> と同じ.
<STRONG>MySQL</STRONG> サーバーから読み出す時間を最短にしてくれます。
<DT><CODE>-pyour_pass, --password[=your_pass]</CODE>
<DD>
サーバーに接続する際のパスワードを与えます。
もし <SAMP>`=your_pass'</SAMP> 部分を与えなかった場合は、
<CODE>mysqldump</CODE> は端末からパスワードを読み取ろうとします。
<DT><CODE>-P port_num, --port=port_num</CODE>
<DD>
サーバーに接続する際に使用する TCP/IP ポート番号。
 (This は <CODE>localhost</CODE> 以外のホストへの接続に使用されます。
 <CODE>localhost</CODE> の場合は、Unix ソケットが使用されます。)
<DT><CODE>-q, --quick</CODE>
<DD>
クエリをバッファにため込みません。stdout に直接出します。
<CODE>mysql_use_result()</CODE> をこれに使用しています。
<DT><CODE>-S /path/to/socket, --socket=/path/to/socket</CODE>
<DD>
<CODE>localhost</CODE> に接続する際のソケットファイルの指定 (デフォルトは /tmp/mysql.sock )
<DT><CODE>-T, --tab=path-to-some-directory</CODE>
<DD>
与えられたテーブル毎に、
SQL CREATE 文を含む <CODE>table_name.sql</CODE> ファイル、
データを含む <CODE>table_name.txt</CODE> ファイルを作成します。
<STRONG>NOTE</STRONG>: 
これは <CODE>mysqld</CODE> デーモンが走っているマシン上で <CODE>mysqldump</CODE> を
実行する場合にだけ、動作します。
 <CODE>.txt</CODE> ファイルのフォーマットは、
 <CODE>--fields-xxx</CODE> と <CODE>--lines--xxx</CODE> オプションに従います。
<DT><CODE>-u user_name, --user=user_name</CODE>
<DD>
サーバーに接続する際の <STRONG>MySQL</STRONG> ユーザー名。
デフォルトでは、Unix のログイン名になります。
<DT><CODE>-O var=option, --set-variable var=option</CODE>
<DD>
変数の値をセット。 可能な変数は後で示しします。
<DT><CODE>-v, --verbose</CODE>
<DD>
冗長モード。 プログラムが何を行っているかより表示します。
<DT><CODE>-V, --version</CODE>
<DD>
バージョンを示して終了。
<DT><CODE>-w, --where='where-condition'</CODE>
<DD>
選択されたレコードのみをダンプ： クオートは必須です！


<PRE>
"--where=user='jimf'" "-wuserid&#62;1" "-wuserid&#60;1"
</PRE>

</DL>

<P>
<CODE>mysqldump</CODE> の普通の使用はデータベースのバックアップでしょう：

</P>

<PRE>
mysqldump --opt database &#62; backup-file.sql
</PRE>

<P>
他の <STRONG>MySQL</STRONG> サーバーへデータベースをコピーする場合にも便利です：

</P>

<PRE>
mysqldump --opt database | mysql --host=remote-host -C database
</PRE>



<H2><A NAME="mysqlimport" HREF="manual.ja_toc.html#mysqlimport">12.4  テキストファイルからデータを取り込む　( <CODE>mysqlimport</CODE> )</A></H2>

<P>
<CODE>mysqlimport</CODE> は、<CODE>LOAD DATA INFILE</CODE> SQL 構文を、
コマンドラインインターフェースで提供します。
<CODE>mysqlimport</CODE> のオプションのほとんどが、
 <CODE>LOAD DATA INFILE</CODE> への同じオプションに対応します。
 「<A HREF="manual.ja_Reference.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE>構文</A>」節参照.

</P>
<P>
<CODE>mysqlimport</CODE> の実行は以下のようにします:

</P>

<PRE>
shell&#62; mysqlimport [options] filename ...
</PRE>

<P>
<CODE>mysqlimport</CODE> は、コマンドラインの引数に与えられたファイル名の拡張子を取り、
拡張子を取った後の名前を、ファイルの内容を取り込むテーブルの名前とします。
例えば、<TT>`patient.txt'</TT>, <TT>`patient.text'</TT>, <TT>`patient'</TT> という
ファイルは全て、<CODE>patient</CODE> とという名前のテーブルに取り込まれます。

</P>
<P>
<CODE>mysqlimport</CODE> は以下のオプションをサポートします:

</P>
<DL COMPACT>

<DT><CODE>-C, --compress</CODE>
<DD>
クライアントとサーバーの両方が圧縮をサポートしているなら、
クライアント・サーバー間でやり取りされる全ての情報を圧縮します。

<DT><CODE>-#, --debug[=option_string]</CODE>
<DD>
プログラムのトレース(デバッグ)

<DT><CODE>-d, --delete</CODE>
<DD>
テキストファイルを取り込む前にテーブルを空にします。

<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
<DT><CODE>--fields-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-optionally-enclosed-by=...</CODE>
<DD>
<DT><CODE>--fields-escaped-by=...</CODE>
<DD>
<DT><CODE>--fields-terminated-by=...</CODE>
<DD>
これらのオプションは、<CODE>LOAD DATA INFILE</CODE> の対応する文節と同じ意味になります。
 「<A HREF="manual.ja_Reference.html#LOAD_DATA">7.16  <CODE>LOAD DATA INFILE</CODE>構文</A>」節参照.

<DT><CODE>-f, --force</CODE>
<DD>
エラーを無視します。例えば、テキストファイルを取り込むテーブルがない場合、
残りのファイルの処理に移ります。 <CODE>--force</CODE> がなければ、
テーブルがなければ <CODE>mysqlimport</CODE> は終了します。

<DT><CODE>--help</CODE>
<DD>
ヘルプを表示して終了。

<DT><CODE>-h host_name, --host=host_name</CODE>
<DD>
名前を指定された <STRONG>MySQL</STRONG> サーバーにデータを取り入れます。
デフォルトでは <CODE>localhost</CODE>.

<DT><CODE>-i, --ignore</CODE>
<DD>
<CODE>--replace</CODE> オプションの説明を見てください。

<DT><CODE>-l, --lock-tables</CODE>
<DD>
それぞれのテキストファイルを処理する前に、書き込まれる
<STRONG>全ての</STRONG>テーブルをロックします。
これは確実に、すべてのテーブルをサーバ上で同期させます。

<DT><CODE>-L, --local</CODE>
<DD>
クライアントからの入力ファイルを読みます。
デフォルトでは、<CODE>localhost</CODE> に接続した場合、テキストファイルは
サーバー上にあると仮定されます。(<CODE>localhost</CODE> はデフォルト値)

<DT><CODE>-pyour_pass, --password[=your_pass]</CODE>
<DD>
サーバーに接続するときに使用するパスワード。
もし <SAMP>`=your_pass'</SAMP> のところにパスワードを書かなければ、
<CODE>mysqlimport</CODE> は端末からのパスワードの入力を要求します。

<DT><CODE>-P port_num, --port=port_num</CODE>
<DD>
ホストに接続するための TCP/IP ポート番号。
(これは <CODE>localhost</CODE> を除くホストへの接続に使用します。
<CODE>localhost</CODE> へは、UNIX ソケットを使用します。)

<DT><CODE>-r, --replace</CODE>
<DD>
<CODE>--replace</CODE> と <CODE>--ignore</CODE> オプションは、
入力されているレコードのユニークキーの値が、
既に存在しているレコードのユニークキーの値と同じ場合、
その入力されているデータの取り扱いを決定します。
もし <CODE>--replace</CODE> が指定されているなら、
既にあるレコードは新しく読まれたレコードに置き換えられます。
もし <CODE>--ignore</CODE> が指定されているなら、
入力された物は無視されます。
どちらのオプションも指定していない場合、
キーの値が重なっているとエラーを発し、
テキストファイルの残りの部分は無視されます。

<DT><CODE>-s, --silent</CODE>
<DD>
静粛モード。エラーだけ出力します。

<DT><CODE>-S /path/to/socket, --socket=/path/to/socket</CODE>
<DD>
<CODE>localhost</CODE> への接続時に使用するソケットファイルを指定します。

<DT><CODE>-u user_name, --user=user_name</CODE>
<DD>
サーバーの接続に使用する <STRONG>MySQL</STRONG> ユーザー名の指定。
デフォルトは、Unix のログイン名。

<DT><CODE>-v, --verbose</CODE>
<DD>
冗長モード。プログラムがしている事について多く出力します。

<DT><CODE>-V, --version</CODE>
<DD>
バージョンを表示して終了。
</DL>

<P>
Here follows a sample run of using <CODE>mysqlimport</CODE>:

</P>

<PRE>
$ mysql --version
mysql  Ver 9.33 Distrib 3.22.25, for pc-linux-gnu (i686)
$ uname -a
Linux xxx.com 2.2.5-15 #1 Mon Apr 19 22:21:09 EDT 1999 i586 unknown
$ mysql -e 'CREATE TABLE imptest(id INT, n VARCHAR(30))' test
$ ed
a
100     Max Sydow
101     Count Dracula
.
w imptest.txt
32
q
$ od -c imptest.txt
0000000   1   0   0  \t   M   a   x       S   y   d   o   w  \n   1   0
0000020   1  \t   C   o   u   n   t       D   r   a   c   u   l   a  \n
0000040
$ mysqlimport --local test imptest.txt
test.imptest: Records: 2  Deleted: 0  Skipped: 0  Warnings: 0
$ mysql -e 'SELECT * FROM imptest' test
+------+---------------+
| id   | n             |
+------+---------------+
|  100 | Max Sydow     |
|  101 | Count Dracula |
+------+---------------+
</PRE>

<P>
<A NAME="IDX670"></A>
<A NAME="IDX671"></A>


<H2><A NAME="myisampack" HREF="manual.ja_toc.html#myisampack">12.5  <STRONG>MySQL</STRONG> の圧縮された読み込み専用テーブルジェネレータ　( <CODE>myisampack</CODE> ・ <CODE>pack_isam</CODE> )</A></H2>

<P>
<CODE>myisampack</CODE> is used to compress MyISAM tables and <CODE>pack_isam</CODE> 
is used to compress ISAM tables. Since ISAM tables are deprecated we
will only discuss <CODE>myisampack</CODE> here.

</P>
<P>
<CODE>myisampack</CODE> は、
10 ライセンス以上または拡張サポートを注文した時に得
られる特別なユーテリティです。これらはバイナリだけの配布のため、
いくつかのプラットフォーム上でだけに有効です。

</P>
<P>
In the following we only talk about <CODE>myisampack</CODE>, but everything
holds also for <CODE>pack_isam</CODE>.

</P>
<P>
<CODE>myisampack</CODE> はテーブル内の各項目を別々に圧縮するように働きます。展開のため
の情報は、テーブルがオープンされた時にメモリに読まれます。これは、正確に1レコー
ドだけを展開する必要があるような、個々のレコードへのアクセス時にとても良
い性能を与えます。MSDOS 上の Stacker 使用時のように、ディスクブロックは
そんなに大きくありません。
通常、<CODE>myisampack</CODE> はデータファイルを 40〜70% にパックします。

</P>
<P>
<STRONG>MySQL</STRONG> は圧縮されたテーブルでメモリマップ (<CODE>mmap()</CODE>) を使用します。
<CODE>mmap()</CODE> が働かない場合は、通常のファイルの読み書きを使用します。

</P>
<P>
現在 <CODE>myisampack</CODE> には2つの制限があります:

<UL>
<LI>

パック後、テーブルは読み込み専用になります。
<LI>

<CODE>myisampack</CODE> can also pack <CODE>BLOB</CODE> or <CODE>TEXT</CODE> columns. The
older <CODE>pack_isam</CODE> could not do this.
</UL>

<P>
これらの制限の修正は TODO にありますが、優先度は低いです。

</P>
<P>
<CODE>myisampack</CODE> は以下のようにして起動します:

</P>

<PRE>
shell&#62; myisampack [options] filename ...
</PRE>

<P>
それぞれのファイル名はインデックスファイル(<TT>`.MYI'</TT>)の名前です。
もしデータディレクトリにカレントディレクトリを移動していないなら、
ファイルのパスを指定しなくてはなりません。<TT>`.MYI'</TT> 拡張子は
省略することが可能です。

</P>
<P>
<CODE>myisampack</CODE> は以下のオプションをサポートします:

</P>
<DL COMPACT>

<DT><CODE>-b, --backup</CODE>
<DD>
<CODE>tbl_name.OLD</CODE> としてバックアップを作成します.

<DT><CODE>-#, --debug=debug_options</CODE>
<DD>
デバック出力。<CODE>debug_options</CODE> は <CODE>'d:t:o,filename'</CODE>.

<DT><CODE>-f, --force</CODE>
<DD>
一時ファイルが存在していようが、サイズが大きくなろうが、強制的にテーブルを
パックします。
<CODE>myisampack</CODE> はテーブルを圧縮している間、
一時ファイルを <TT>`tbl_name.TMD'</TT> という名前で作成します。
もし <CODE>myisampack</CODE> を途中で kill した場合、 <TT>`.TMD'</TT> ファイルが消されて
いない事があります。通常、<CODE>myisampack</CODE> は <TT>`tbl_name.TMD'</TT> ファイルが
既に存在する場合はエラーで終了します。 <CODE>--force</CODE> を使用すると、
<CODE>myisampack</CODE> はそのような場合でもテーブルをパックします。

<DT><CODE>-?, --help</CODE>
<DD>
ヘルプメッセージを出力して終了。

<DT><CODE>-j big_tbl_name, --join=big_tbl_name</CODE>
<DD>
全てのテーブルをコマンドラインで指定した <CODE>big_tbl_name</CODE> 一つに
まとめます。結合される全てのテーブル定義は同じでなければなりません
(同じ項目名、同じ項目型、同じインデックス、等)

<DT><CODE>-p #, --packlength=#</CODE>
<DD>
Specify the record length storage size, in bytes.  The value should be 1, 2
or 3.  (<CODE>myisampack</CODE> stores all rows with length pointers of 1, 2 or 3
bytes.  In most normal cases, <CODE>myisampack</CODE> can determine the right length
value before it begins packing the file, but it may notice during the packing
process that it could have used a shorter length. In this case,
<CODE>myisampack</CODE> will print a note that the next time you pack the same file,
you could use a shorter record length.)

<DT><CODE>-s, --silent</CODE>
<DD>
Silent mode.  Write output only when errors occur.

<DT><CODE>-t, --test</CODE>
<DD>
Don't pack table, only test packing it.

<DT><CODE>-T dir_name, --tmp_dir=dir_name</CODE>
<DD>
Use the named directory as the location in which to write the temporary table.

<DT><CODE>-v, --verbose</CODE>
<DD>
Verbose mode.  Write info about progress and packing result.

<DT><CODE>-V, --version</CODE>
<DD>
Display version information and exit.

<DT><CODE>-w, --wait</CODE>
<DD>
Wait and retry if table is in use.
If the <CODE>mysqld</CODE> server was invoked with the <CODE>--skip-locking</CODE>
option, it is not a good idea to invoke <CODE>myisampack</CODE> if the table might
be updated during the packing process.
</DL>

<P>
The sequence of commands shown below illustrates a typical table compression
session:

</P>

<PRE>
shell&#62; ls -l station.*
-rw-rw-r--   1 monty    my         994128 Apr 17 19:00 station.ISD
-rw-rw-r--   1 monty    my          53248 Apr 17 19:00 station.ISM
-rw-rw-r--   1 monty    my         994128 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          53248 Apr 17 19:00 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&#62; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-02-02  3:06:43
Data records:              1192  Deleted blocks:              0
Datafile: Parts:           1192  Deleted data:                0
Datafile pointer (bytes):     2  Keyfile pointer (bytes):     2
Max datafile length:   54657023  Max keyfile length:   33554431
Recordlength:               834
Record format: Fixed length

table description:
Key Start Len Index   Type                       Root  Blocksize    Rec/key
1   2     4   unique  unsigned long              1024       1024          1
2   32    30  multip. text                      10240       1024          1

Field Start Length Type
1     1     1
2     2     4
3     6     4
4     10    1
5     11    20
6     31    1
7     32    30
8     62    35
9     97    35
10    132   35
11    167   4
12    171   16
13    187   35
14    222   4
15    226   16
16    242   20
17    262   20
18    282   20
19    302   30
20    332   4
21    336   4
22    340   1
23    341   8
24    349   8
25    357   8
26    365   2
27    367   2
28    369   4
29    373   4
30    377   1
31    378   2
32    380   8
33    388   4
34    392   4
35    396   4
36    400   4
37    404   1
38    405   4
39    409   4
40    413   4
41    417   4
42    421   4
43    425   4
44    429   20
45    449   30
46    479   1
47    480   1
48    481   79
49    560   79
50    639   79
51    718   79
52    797   8
53    805   1
54    806   1
55    807   20
56    827   4
57    831   4

shell&#62; myisampack station.MYI
Compressing station.MYI: (1192 records)
- Calculating statistics

normal:     20  empty-space:      16  empty-zero:        12  empty-fill:  11
pre-space:   0  end-space:        12  table-lookups:      5  zero:         7
Original trees:  57  After join: 17
- Compressing file
87.14%

shell&#62; ls -l station.*
-rw-rw-r--   1 monty    my         127874 Apr 17 19:00 station.ISD
-rw-rw-r--   1 monty    my          55296 Apr 17 19:04 station.ISM
-rw-rw-r--   1 monty    my         127874 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          55296 Apr 17 19:04 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&#62; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-04-17 19:04:26
Data records:              1192  Deleted blocks:              0
Datafile: Parts:           1192  Deleted data:                0
Datafilepointer (bytes):      3  Keyfile pointer (bytes):     1
Max datafile length:   16777215  Max keyfile length:     131071
Recordlength:               834
Record format: Compressed

table description:
Key Start Len Index   Type                       Root  Blocksize    Rec/key
1   2     4   unique  unsigned long             10240       1024          1
2   32    30  multip. text                      54272       1024          1

Field Start Length Type                         Huff tree  Bits
1     1     1      constant                             1     0
2     2     4      zerofill(1)                          2     9
3     6     4      no zeros, zerofill(1)                2     9
4     10    1                                           3     9
5     11    20     table-lookup                         4     0
6     31    1                                           3     9
7     32    30     no endspace, not_always              5     9
8     62    35     no endspace, not_always, no empty    6     9
9     97    35     no empty                             7     9
10    132   35     no endspace, not_always, no empty    6     9
11    167   4      zerofill(1)                          2     9
12    171   16     no endspace, not_always, no empty    5     9
13    187   35     no endspace, not_always, no empty    6     9
14    222   4      zerofill(1)                          2     9
15    226   16     no endspace, not_always, no empty    5     9
16    242   20     no endspace, not_always              8     9
17    262   20     no endspace, no empty                8     9
18    282   20     no endspace, no empty                5     9
19    302   30     no endspace, no empty                6     9
20    332   4      always zero                          2     9
21    336   4      always zero                          2     9
22    340   1                                           3     9
23    341   8      table-lookup                         9     0
24    349   8      table-lookup                        10     0
25    357   8      always zero                          2     9
26    365   2                                           2     9
27    367   2      no zeros, zerofill(1)                2     9
28    369   4      no zeros, zerofill(1)                2     9
29    373   4      table-lookup                        11     0
30    377   1                                           3     9
31    378   2      no zeros, zerofill(1)                2     9
32    380   8      no zeros                             2     9
33    388   4      always zero                          2     9
34    392   4      table-lookup                        12     0
35    396   4      no zeros, zerofill(1)               13     9
36    400   4      no zeros, zerofill(1)                2     9
37    404   1                                           2     9
38    405   4      no zeros                             2     9
39    409   4      always zero                          2     9
40    413   4      no zeros                             2     9
41    417   4      always zero                          2     9
42    421   4      no zeros                             2     9
43    425   4      always zero                          2     9
44    429   20     no empty                             3     9
45    449   30     no empty                             3     9
46    479   1                                          14     4
47    480   1                                          14     4
48    481   79     no endspace, no empty               15     9
49    560   79     no empty                             2     9
50    639   79     no empty                             2     9
51    718   79     no endspace                         16     9
52    797   8      no empty                             2     9
53    805   1                                          17     1
54    806   1                                           3     9
55    807   20     no empty                             3     9
56    827   4      no zeros, zerofill(2)                2     9
57    831   4      no zeros, zerofill(1)                2     9
</PRE>

<P>
The information printed by <CODE>myisampack</CODE> is described below:

</P>
<DL COMPACT>

<DT><CODE>normal</CODE>
<DD>
The number of columns for which no extra packing is used.

<DT><CODE>empty-space</CODE>
<DD>
The number of columns containing
values that are only spaces; these will occupy 1 bit.

<DT><CODE>empty-zero</CODE>
<DD>
The number of columns containing
values that are only binary 0's; these will occupy 1 bit.

<DT><CODE>empty-fill</CODE>
<DD>
The number of integer columns that don't occupy the full byte range of their
type; these are changed to a smaller type (for example, an <CODE>INTEGER</CODE>
column may be changed to <CODE>MEDIUMINT</CODE>).

<DT><CODE>pre-space</CODE>
<DD>
The number of decimal columns that are stored with leading space. In this
case, each value will contain a count for the number of leading spaces.

<DT><CODE>end-space</CODE>
<DD>
The number of columns that have a lot of trailing space.  In this case, each
value will contain a count for the number of trailing spaces.

<DT><CODE>table-lookup</CODE>
<DD>
The column had only a small number of different values, and that were
converted to an <CODE>ENUM</CODE> before Huffman compression.

<DT><CODE>zero</CODE>
<DD>
The number of columns for which all values are zero.

<DT><CODE>Original trees</CODE>
<DD>
The initial number of Huffman trees.

<DT><CODE>After join</CODE>
<DD>
The number of distinct Huffman trees left after joining
trees to save some header space.
</DL>

<P>
After a table has been compressed, <CODE>myisamchk -dvv</CODE> prints additional
information about each field:

</P>
<DL COMPACT>

<DT><CODE>Type</CODE>
<DD>
The field type may contain the following descriptors:

<DL COMPACT>

<DT><CODE>constant</CODE>
<DD>
All rows have the same value.

<DT><CODE>no endspace</CODE>
<DD>
Don't store endspace.

<DT><CODE>no endspace, not_always</CODE>
<DD>
Don't store endspace and don't do end space compression for all values.

<DT><CODE>no endspace, no empty</CODE>
<DD>
Don't store endspace. Don't store empty values.

<DT><CODE>table-lookup</CODE>
<DD>
The column was converted to an <CODE>ENUM</CODE>.

<DT><CODE>zerofill(n)</CODE>
<DD>
The most significant <CODE>n</CODE> bytes in the value are always 0 and are not
stored.

<DT><CODE>no zeros</CODE>
<DD>
Don't store zeros.

<DT><CODE>always zero</CODE>
<DD>
0 values are stored in 1 bit.
</DL>

<DT><CODE>Huff tree</CODE>
<DD>
The Huffman tree associated with the field

<DT><CODE>Bits</CODE>
<DD>
The number of bits used in the Huffman tree.
</DL>

<P><HR><P>
Go to the <A HREF="manual.ja_Introduction.html">first</A>, <A HREF="manual.ja_MySQL_Benchmarks.html">previous</A>, <A HREF="manual.ja_Maintenance.html">next</A>, <A HREF="manual.ja_Concept_Index.html">last</A> section, <A HREF="manual.ja_toc.html">table of contents</A>.
 </BODY>
 </HTML>
