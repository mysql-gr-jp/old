<html><head>
  <!-- This HTML file has been created by texi2html 1.52 (hacked by david@detron.se)
     from manual.ja.texi on 20 July 2001 -->

  <title>MySQL Reference Manual for version 3.23.38. - 15  MySQL ユーティリティ</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body bgcolor="#FFFFFF" text="#000000" link="#101090" vlink="#7030B0">
Go to the <a href="manual.ja_Introduction.html">first</a>, <a href="manual.ja_MySQL_Benchmarks.html">previous</a>, <a href="manual.ja_Maintenance.html">next</a>, <a href="manual.ja_Concept_Index.html">last</a> section, <a href="manual.ja_toc.html">table of contents</a>.
<p></p><hr><p>


</p><h1><a name="Tools" href="manual.ja_toc.html#Tools">15  <strong>MySQL</strong> ユーティリティ</a></h1>

<p>
In this chapter you will learn about the <strong>MySQL</strong> Utilities that
come in a given distribution.  You will learn what each of them does, how
to use it, and what you should use it for.

</p>
<p>
<a name="IDX1245"></a>
<a name="IDX1246"></a>


</p><h2><a name="Programs" href="manual.ja_toc.html#Programs">15.1  様々な <strong>MySQL</strong> プログラムの概要</a></h2>

<p>
サーバと通信する <code>mysqlclient</code> ライブラリを使用している全ての 
<strong>MySQL</strong> クライアントは次の環境変数を使用します:

</p>
<p>
<a name="IDX1247"></a>
<a name="IDX1248"></a>
<a name="IDX1249"></a>
<a name="IDX1250"></a>
<a name="IDX1251"></a>
<a name="IDX1252"></a>
<a name="IDX1253"></a>
<a name="IDX1254"></a>
<table border="" width="100%" nosave="">
<tbody><tr><td><strong>Name</strong> </td><td> <strong>Description</strong>
</td></tr>
<tr><td><code>MYSQL_UNIX_PORT</code> </td><td> デフォルトのソケット; <code>localhost</code> への接続に使用される
</td></tr>
<tr><td><code>MYSQL_TCP_PORT</code> </td><td> デフォルトの TCP/IP ポート
</td></tr>
<tr><td><code>MYSQL_PWD</code> </td><td> デフォルトのパスワード
</td></tr>
<tr><td><code>MYSQL_DEBUG</code> </td><td> デバッグオプション
</td></tr>
<tr><td><code>TMPDIR</code> </td><td> 一時 tables/files が作成されるディレクトリ
</td></tr>
</tbody></table>

</p>
<p>
<code>MYSQL_PWD</code> の使用は安全ではありません。
 「<a href="manual.ja_Privilege_system.html#Connecting">6.6  MySQL サーバーに接続</a>」節参照.

</p>
<p>
<a name="IDX1255"></a>
<a name="IDX1256"></a>
<a name="IDX1257"></a>
<a name="IDX1258"></a>
<a name="IDX1259"></a>
<a name="IDX1260"></a>
<a name="IDX1261"></a>
<tt>`mysql'</tt> クライアントは、<code>MYSQL_HISTFILE</code> 環境変数に
指定されているファイルにコマンドラインの履歴を書き出します。
デフォルトの履歴ファイルは、 <tt>`$HOME/.mysql_history'</tt> で、<code>$HOME</code> は
 <code>HOME</code> 環境変数の値です。  「<a href="manual.ja_Environment_variables.html#Environment_variables">A  Environment Variables</a>」節参照.

</p>
<p>
全ての <strong>MySQL</strong> プログラムは多くの様々なオプションを持ちます。種々
のオプションの完全な説明を得るにはスイッチ <code>--help</code> を使用してください。例
えば<code>mysql --help</code> を試してください。

</p>
<p>
オプションファイルで、全ての標準クライアントのデフォルトのオプションを
変更することが可能です。
 「<a href="manual.ja_Installing.html#Option_files">4.16.5  オプションファイル ( <code>my.cnf</code> )</a>」節.

</p>
<p>
<strong>MySQL</strong> プログラムを以下に示します:

</p>
<dl compact="">

<dt><code>myisamchk</code>
</dt><dd>
<a name="IDX1262"></a>
 
<strong>MySQL</strong> テーブルをチェック, 最適化そして修復します。
<code>myisamchk</code> には多くの機能があるので、一章割り当てて説明しています。
 「<a href="manual.ja_Maintenance.html#Maintenance">16  Maintaining a MySQL Installation</a>」節参照.

<a name="IDX1263"></a>
</dd><dt><code>make_binary_distribution</code>
</dt><dd>
コンパイルされた <strong>MySQL</strong> のバイナリリリースを作成します。これは他
の MySQL ユーザの利便のために、ftp で <code>support.mysql.com</code> の  <tt>`/pub/mysql/Incoming'</tt>
に送ることができます。

<a name="IDX1264"></a>
</dd><dt><code>msql2mysql</code>
</dt><dd>
<code>mSQL</code> プログラムを <strong>MySQL</strong> に変換するシェルスクリプト。全て
のケースで処理できるわけではありませんが、変換時に良いスタートを与えます。

<a name="IDX1265"></a>
<a name="IDX1266"></a>
</dd><dt><code>mysql</code>
</dt><dd>
<code>mysql</code> は簡単な SQL シェル (GNU <code>readline</code> つき) です。これは対話的な使用や
非対話型問い合わせをサポートします。対話的に使用されると、ASCII テーブル
形式で結果が与えられます。フィルタとして使用されると、出力はタブで区切ら
れます（これは起動時のオプションで他のものに変更できます）。
あなたは以下のように簡単にスクリプトを実行できます:


<pre>shell&gt; mysql database &lt; script.sql &gt; output.tab
</pre>

クライアントのメモリが十分でないことによる問題がある場合は、
<code>--quick</code> スイッチを使用してください！ これは結果を取り出すのに 
 <code>mysql_store_result()</code> の代わりに <code>mysql_use_result()</code> を使用
するように <code>mysql</code> に強制させます。

<a name="IDX1267"></a>
</dd><dt><code>mysqlaccess</code>
</dt><dd>
ホスト, ユーザそしてデータベースの組合せで権限をチェックするためのスクリ
プト。

<a name="IDX1268"></a>
</dd><dt><code>mysqladmin</code>
</dt><dd>
管理ユーティリティ。データベースの作成/破棄。reload (新しいユーザの読み
込み) と refresh (ディスクへのテーブルのフラッシュ, ログファイルの再オー
プン)。サーバのバージョンと処理と状態情報も与えます。
 「<a href="manual.ja_Tools.html#mysqladmin">15.6  <strong>MySQL</strong> サーバーの管理　( <code>mysqladmin</code> )</a>」節参照.

<a name="IDX1269"></a>
</dd><dt><code>mysqlbug</code>
</dt><dd>
<strong>MySQL</strong> バグレポートスクリプト。
このスクリプトは <strong>MySQL</strong> メーリングリストにバグレポートを出す際、
常に使用します。

<a name="IDX1270"></a>
</dd><dt><code>mysqld</code>
</dt><dd>
SQL デーモン。これは常に実行されてます。

<a name="IDX1271"></a>
</dd><dt><code>mysqldump</code>
</dt><dd>
<strong>MySQL</strong> データベースの SQL ステートメントまたはタブで区切られたテ
キストのファイルにダンプします。Igor Romanenko によって独創的にエンハン
スされたフリーウェア。
 「<a href="manual.ja_Tools.html#mysqldump">15.7  <strong>MySQL</strong> データベースとテーブルから、構造とデータをダンプ　( <code>mysqldump</code> )</a>」節参照.

<a name="IDX1272"></a>
</dd><dt><code>mysqlimport</code>
</dt><dd>
一つまたは複数のテキストファイルをそれぞれのテーブルに読み込みます。<code>LOAD
DATA INFILE</code> でサポートされる全ての形式を使用できます。  「<a href="manual.ja_Tools.html#mysqlimport">15.9  テキストファイルからデータを取り込む　( <code>mysqlimport</code> )</a>」節参照.

<a name="IDX1273"></a>
</dd><dt><code>mysqlshow</code>
</dt><dd>
データベース, テーブル, 項目そしてインデックスについての情報を表示します。

<a name="IDX1274"></a>
</dd><dt><code>mysql_install_db</code>
</dt><dd>
<strong>MySQL</strong> 承認テーブルをデフォルトの権限で作成します。これは通常、最
初の <strong>MySQL</strong> リリースを新しいシステム上にインストールする時に一回
だけ実行されます。

<a name="IDX1275"></a>
</dd><dt><code>replace</code>
</dt><dd>
<code>msql2mysql</code> で使用されるバイナリ。ファイル内または標準入力上の文字列を変
換するユーティリティプログラム。より長い文字列に最初に適合するため有限状
態マシンを使用します。文字列を交換するために使用できます。例えば、
<code>a</code> と <code>b</code> を与えられたファイル内で交換します:


<pre>shell&gt; replace a b b a -- file1 file2 ...
</pre>

</dd></dl>

<p>
<a name="IDX1276"></a>


</p><h2><a name="mysqld-max" href="manual.ja_toc.html#mysqld-max">15.2  mysqld-max, An extended mysqld server</a></h2>

<p>
<code>mysqld-max</code> is the MySQL server (<code>mysqld</code>) configured with
the following configure options:

</p>
<table border="" width="100%" nosave="">
<tbody><tr><td><strong>Option</strong> </td><td> <strong>Comment</strong>
</td></tr>
<tr><td>--with-server-suffix=-Max </td><td> Add a suffix to the <code>mysqld</code> version string.
</td></tr>
<tr><td>--with-bdb </td><td> Support for Berkeley DB (BDB) tables
</td></tr>
<tr><td>--with-innodb </td><td> Support for InnoDB tables.
</td></tr>
<tr><td>CFLAGS=-DUSE_SYMDIR </td><td> Symbolic links support for Windows.
</td></tr>
</tbody></table>

<p>
Note that as Berkeley DB and InnoDB are not available for all platforms,
some of the <code>Max</code> binaries may not have support for both of these.
You can check which table types are supported by doing the following
query:

</p>

<pre>mysql&gt; show variables like "have_%";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| have_bdb      | YES   |
| have_gemini   | NO    |
| have_innodb   | NO    |
| have_isam     | YES   |
| have_raid     | YES   |
| have_ssl      | NO    |
+---------------+-------+
</pre>

<p>
The meaning of the values are:

</p>
<table border="" width="100%" nosave="">
<tbody><tr><td><strong>Value</strong> </td><td> <strong>Meaning</strong>.
</td></tr>
<tr><td>YES </td><td> The option is activated and usable.
</td></tr>
<tr><td>NO </td><td> <strong>MySQL</strong> is not compiled with support for this option.
</td></tr>
<tr><td>DISABLED </td><td> The xxxx option is disabled because one started <code>mysqld</code> with <code>--skip-xxxx</code> or because one didn't start <code>mysqld</code> with all needed options to enable the option.  In this case the <code>hostname.err</code> file should contain a reason for why the option is disabled.
</td></tr>
</tbody></table>

<p>
<strong>NOTE</strong>:  To be able to create InnoDB tables you <strong>MUST</strong> edit
your startup options to include at least the <code>innodb_data_file_path</code>
option.  「<a href="manual.ja_Table_types.html#InnoDB_start">8.7.2  InnoDB startup options</a>」節参照.

</p>
<p>
To get better performance for BDB tables, you should add some configuration
options for these too.  「<a href="manual.ja_Table_types.html#BDB_start">8.5.3  BDB startup options</a>」節参照.

</p>
<p>
<code>safe_mysqld</code> will automaticly try to start any <code>mysqld</code> binary
with the <code>-max</code> prefix. This makes it very easy to test out a
another <code>mysqld</code> binary in an existing installation.  Just
run <code>configure</code> with the options you want and then install the
new <code>mysqld</code> binary as <code>mysqld-max</code> in the same directory
where your old <code>mysqld</code> binary is.  「<a href="manual.ja_Tools.html#safe_mysqld">15.3  safe_mysqld, the wrapper around mysqld</a>」節参照.

</p>
<p>
The <code>mysqld-max</code> RPM uses the above mentioned <code>safe_mysqld</code>
feature. It just installs the <code>mysqld-max</code> executable and
<code>safe_mysqld</code> will automaticly use this executable when
<code>safe_mysqld</code> is restarted.

</p>
<p>
The following table shows which table types our standard <strong>MySQL-Max</strong>
binaries includes:

</p>
<table border="" width="100%" nosave="">
<tbody><tr><td><strong>System</strong> </td><td> <strong>BDB</strong> </td><td> <strong>InnoDB</strong>
</td></tr>
<tr><td>AIX 4.3 </td><td> N </td><td> Y
</td></tr>
<tr><td>HPUX 11.0 </td><td> N </td><td> Y
</td></tr>
<tr><td>Linux-Alpha </td><td> N </td><td> Y
</td></tr>
<tr><td>Linux-Intel </td><td> Y </td><td> Y
</td></tr>
<tr><td>Linux-Ia64 </td><td> N </td><td> Y
</td></tr>
<tr><td>Solaris-intel </td><td> N </td><td> Y
</td></tr>
<tr><td>Solaris-sparc </td><td> Y </td><td> Y
</td></tr>
<tr><td>SCO OSR5 </td><td> Y </td><td> Y
</td></tr>
<tr><td>UnixWare </td><td> Y </td><td> Y
</td></tr>
</tbody></table>

<p>
<a name="IDX1277"></a>
<a name="IDX1278"></a>
<a name="IDX1279"></a>


</p><h2><a name="safe_mysqld" href="manual.ja_toc.html#safe_mysqld">15.3  safe_mysqld, the wrapper around mysqld</a></h2>
<p>
<code>safe_mysqld</code> is the recommended way to start a <code>mysqld</code>
daemon on UNIX.  <code>safe_mysqld</code> adds some safety features such as
restarting the server when an error occurs and logging runtime
information to a log file.

</p>
<p>
If you don't use <code>--mysqld=#</code> or <code>--mysqld-version=#</code>
<code>safe_mysqld</code> will use an executable named <code>mysqld-max</code> if it
exists. If not, <code>safe_mysqld</code> will start <code>mysqld</code>.
This makes it very easy to test to use <code>mysqld-max</code> instead of
<code>mysqld</code>;  Just copy <code>mysqld-max</code> to where you have
<code>mysqld</code> and it will be used.

</p>
<p>
Normally one should never edit the <code>safe_mysqld</code> script, but
instead put the options to <code>safe_mysqld</code> in the
<code>[safe_mysqld]</code> section in the <code>my.cnf</code>
file. <code>safe_mysqld</code> will read all options from the <code>[mysqld]</code>,
<code>[server]</code> and <code>[safe_mysqld]</code> sections from the option files.
 「<a href="manual.ja_Installing.html#Option_files">4.16.5  オプションファイル ( <code>my.cnf</code> )</a>」節参照.

</p>
<p>
Note that all options on the command line to <code>safe_mysqld</code> are passed
to <code>mysqld</code>.  If you wants to use any options in <code>safe_mysqld</code> that
<code>mysqld</code> doesn't support, you must specify these in the option file.

</p>
<p>
Most of the options to <code>safe_mysqld</code> are the same as the options to
<code>mysqld</code>.  「<a href="manual.ja_Installing.html#Command-line_options">4.16.4  mysqld コマンド行オプション</a>」節参照.

</p>
<p>
<code>safe_mysqld</code> supports the following options:

</p>
<dl compact="">

<dt><code>--basedir=path</code>
</dt><dd>
</dd><dt><code>--core-file-size=#</code>
</dt><dd>
Size of the core file <code>mysqld</code> should be able to create. Passed to <code>ulimit -c</code>.
</dd><dt><code>--datadir=path</code>
</dt><dd>
</dd><dt><code>--defaults-extra-file=path</code>
</dt><dd>
</dd><dt><code>--defaults-file=path</code>
</dt><dd>
</dd><dt><code>--err-log=path</code>
</dt><dd>
</dd><dt><code>--ledir=path</code>
</dt><dd>
Path to <code>mysqld</code>
</dd><dt><code>--log=path</code>
</dt><dd>
</dd><dt><code>--mysqld=mysqld-version</code>
</dt><dd>
Name of the mysqld version in the <code>ledir</code> directory you want to start.
</dd><dt><code>--mysqld-version=version</code>
</dt><dd>
Similar to <code>--mysqld=</code> but here you only give the suffix for mysqld.
For example if you use <code>--mysqld-version=max</code>, <code>safe_mysqld</code> will
start the <code>ledir/mysqld-max</code> version.  If the argument to
<code>--mysqld-version</code> is empty, <code>ledir/mysqld</code> will be used.
</dd><dt><code>--no-defaults</code>
</dt><dd>
</dd><dt><code>--open-files-limit=#</code>
</dt><dd>
Number of files <code>mysqld</code> should be able to open. Passed to <code>ulimit -n</code>. Note that you need to start <code>safe_mysqld</code> as root for this to work properly!
</dd><dt><code>--pid-file=path</code>
</dt><dd>
</dd><dt><code>--port=#</code>
</dt><dd>
</dd><dt><code>--socket=path</code>
</dt><dd>
</dd><dt><code>--timezone=#</code>
</dt><dd>
Set the timezone (the <code>TZ</code>) variable to the value of this parameter.
</dd><dt><code>--user=#</code>
</dt><dd>
</dd></dl>

<p>
The <code>safe_mysqld</code> script is written so that it normally is able to start
a server that was installed from either a source or a binary version of
<strong>MySQL</strong>, even if these install the server in slightly different
locations.  <code>safe_mysqld</code> expects one of these conditions to be true:

</p>

<ul>
<li>

The server and databases can be found relative to the directory from which
<code>safe_mysqld</code> is invoked.  <code>safe_mysqld</code> looks under its working
directory for <tt>`bin'</tt> and <tt>`data'</tt> directories (for binary
distributions) or for <tt>`libexec'</tt> and <tt>`var'</tt> directories (for source
distributions).  This condition should be met if you execute
<code>safe_mysqld</code> from your <strong>MySQL</strong> installation directory (for
example, <tt>`/usr/local/mysql'</tt> for a binary distribution).

</li><li>

If the server and databases cannot be found relative to the working directory,
<code>safe_mysqld</code> attempts to locate them by absolute pathnames.  Typical
locations are <tt>`/usr/local/libexec'</tt> and <tt>`/usr/local/var'</tt>.
The actual locations are determined when the distribution was built from which
<code>safe_mysqld</code> comes.  They should be correct if
<strong>MySQL</strong> was installed in a standard location.
</li></ul>

<p>
Because <code>safe_mysqld</code> will try to find the server and databases relative
to its own working directory, you can install a binary distribution of
<strong>MySQL</strong> anywhere, as long as you start <code>safe_mysqld</code> from the
<strong>MySQL</strong> installation directory:

</p>

<pre>shell&gt; cd mysql_installation_directory
shell&gt; bin/safe_mysqld &amp;
</pre>

<p>
If <code>safe_mysqld</code> fails, even when invoked from the <strong>MySQL</strong>
installation directory, you can modify it to use the path to <code>mysqld</code>
and the pathname options that are correct for your system.  Note that if you
upgrade <strong>MySQL</strong> in the future, your modified version of
<code>safe_mysqld</code> will be overwritten, so you should make a copy of your
edited version that you can reinstall.

</p>
<p>
<a name="IDX1280"></a>
<a name="IDX1281"></a>
<a name="IDX1282"></a>
<a name="IDX1283"></a>


</p><h2><a name="mysqld_multi" href="manual.ja_toc.html#mysqld_multi">15.4  mysqld_multi, program for managing multiple <strong>MySQL</strong> servers</a></h2>

<p>
<code>mysqld_multi</code> is meant for managing several <code>mysqld</code>
processes running in different UNIX sockets and TCP/IP ports.

</p>
<p>
The program will search for group(s) named [mysqld#] from my.cnf (or the
given --config-file=...), where # can be any positive number starting
from 1. These groups should be the same as the usual <code>[mysqld]</code>
group (e.g. options to mysqld, see <strong>MySQL</strong> manual for detailed
information about this group), but with those port, socket etc. options
that are wanted for each separate <code>mysqld</code> processes. The number in
the group name has another function; it can be used for starting,
stopping, or reporting some specific <code>mysqld</code> servers with this
program. See the usage and options below for more information.

</p>

<pre>Usage: mysqld_multi [OPTIONS] {start|stop|report} [GNR,GNR,GNR...]
or     mysqld_multi [OPTIONS] {start|stop|report} [GNR-GNR,GNR,GNR-GNR,...]
</pre>

<p>
The GNR above means the group number. You can start, stop or report
any GNR, or several of them at the same time. (See --example) The GNRs
list can be comma separated, or a dash combined, of which the latter
+ means that all the GNRs between GNR1-GNR2 will be affected. Without
GNR argument all the found groups will be either started, stopped, or
reported. Note that you must not have any white spaces in the GNR
list. Anything after a white space is ignored.

</p>
<p>
<code>mysqld_multi</code> supports the following options:

</p>
<dl compact="">

<dt><code>--config-file=...</code>
</dt><dd>
<a name="IDX1284"></a>
 
Alternative config file. NOTE: This will not affect this program's own
options (group <code>[mysqld_multi]</code>), but only groups
[mysqld#]. Without this option everything will be searched from the
ordinary my.cnf file.
<a name="IDX1285"></a>
</dd><dt><code>--example</code>
</dt><dd>
Give an example of a config file.
<a name="IDX1286"></a>
</dd><dt><code>--help</code>
</dt><dd>
Print this help and exit.
<a name="IDX1287"></a>
</dd><dt><code>--log=...</code>
</dt><dd>
Log file. Full path to and the name for the log file. NOTE: If the file
exists, everything will be appended.
<a name="IDX1288"></a>
</dd><dt><code>--mysqladmin=...</code>
</dt><dd>
<code>mysqladmin</code> binary to be used for a server shutdown.
<a name="IDX1289"></a>
</dd><dt><code>--mysqld=...</code>
</dt><dd>
<code>mysqld</code> binary to be used. Note that you can give
<code>safe_mysqld</code> to this option also. The options are passed to
<code>mysqld</code>. Just make sure you have <code>mysqld</code> in your environment
variable <code>PATH</code> or fix <code>safe_mysqld</code>.
<a name="IDX1290"></a>
</dd><dt><code>--no-log</code>
</dt><dd>
Print to stdout instead of the log file. By default the log file is
turned on.
<a name="IDX1291"></a>
</dd><dt><code>--password=...</code>
</dt><dd>
Password for user for <code>mysqladmin</code>.
<a name="IDX1292"></a>
</dd><dt><code>--tcp-ip</code>
</dt><dd>
Connect to the <strong>MySQL</strong> server(s) via the TCP/IP port instead of
the UNIX socket. This affects stopping and reporting.  If a socket file
is missing, the server may still be running, but can be accessed only
via the TCP/IP port.  By default connecting is done via the UNIX socket.
<a name="IDX1293"></a>
</dd><dt><code>--user=...</code>
</dt><dd>
<strong>MySQL</strong> user for <code>mysqladmin</code>.
<a name="IDX1294"></a>
</dd><dt><code>--version</code>
</dt><dd>
Print the version number and exit.
</dd></dl>

<p>
Some notes about <code>mysqld_multi</code>:

</p>

<ul>
<li>

Make sure that the <strong>MySQL</strong> user, who is stopping the
<code>mysqld</code> services (e.g using the <code>mysqladmin</code>) have the same
password and username for all the data directories accessed (to the
'mysql' database) And make sure that the user has the 'Shutdown_priv'
privilege! If you have many data- directories and many different 'mysql'
databases with different passwords for the <strong>MySQL</strong> 'root' user,
you may want to create a common 'multi_admin' user for each using the
same password (see below). Example how to do it:

<pre>shell&gt; mysql -u root -S /tmp/mysql.sock -proot_password -e
"GRANT SHUTDOWN ON *.* TO multi_admin@localhost IDENTIFIED BY 'multipass'"
 「<a href="manual.ja_Privilege_system.html#Privileges">6.8  特権システムはどのように動くか？</a>」節参照.
</pre>

You will have to do the above for each <code>mysqld</code> running in each
data directory, that you have (just change the socket, -S=...)
</li><li>

<code>pid-file</code> is very important, if you are using <code>safe_mysqld</code>
to start <code>mysqld</code> (e.g. --mysqld=safe_mysqld) Every <code>mysqld</code>
should have its own <code>pid-file</code>. The advantage using
<code>safe_mysqld</code> instead of <code>mysqld</code> directly here is, that
<code>safe_mysqld</code> 'guards' every <code>mysqld</code> process and will restart
it, if a <code>mysqld</code> process fails due to signal kill -9, or
similar. (Like segmentation fault, which <strong>MySQL</strong> should never do,
of course ;) Please note that <code>safe_mysqld</code> script may require that
you start it from a certain place. This means that you may have to CD to
a certain directory, before you start the <code>mysqld_multi</code>. If
you have problems starting, please see the <code>safe_mysqld</code>
script. Check especially the lines:

<pre>--------------------------------------------------------------------------
MY_PWD=`pwd` Check if we are starting this relative (for the binary
release) if test -d /data/mysql -a -f ./share/mysql/english/errmsg.sys
-a -x ./bin/mysqld
--------------------------------------------------------------------------
 「<a href="manual.ja_Tools.html#safe_mysqld">15.3  safe_mysqld, the wrapper around mysqld</a>」節参照.
</pre>

The above test should be successful, or you may encounter problems.
</li><li>

Beware of the dangers starting multiple <code>mysqlds</code> in the same data
directory.  Use separate data directories, unless you <strong>KNOW</strong> what
you are doing!
</li><li>

The socket file and the TCP/IP port must be different for every <code>mysqld</code>.
</li><li>

The first and fifth <code>mysqld</code> group were intentionally left out from
the example.  You may have 'gaps' in the config file. This gives you
more flexibility.  The order in which the <code>mysqlds</code> are started or
stopped depends on the order in which they appear in the config file.
</li><li>

When you want to refer to a certain group using GNR with this program,
just use the number in the end of the group name ( [mysqld# &lt;== ).
</li><li>

You may want to use option '--user' for <code>mysqld</code>, but in order to
do this you need to be root when you start the <code>mysqld_multi</code>
script. Having the option in the config file doesn't matter; you will
just get a warning, if you are not the superuser and the <code>mysqlds</code>
are started under <strong>YOUR</strong> UNIX account. <strong>IMPORTANT</strong>: Make
sure that the <code>pid-file</code> and the data directory are
read+write(+execute for the latter one) accessible for <strong>THAT</strong>
UNIX user, who the specific <code>mysqld</code> process is started
as. <strong>DON'T</strong> use the UNIX root account for this, unless you
<strong>KNOW</strong> what you are doing!
</li><li>

<strong>MOST IMPORTANT</strong>: Make sure that you understand the meanings of
the options that are passed to the <code>mysqlds</code> and why <strong>WOULD
YOU WANT</strong> to have separate <code>mysqld</code> processes. Starting multiple
<code>mysqlds</code> in one data directory <strong>WILL NOT</strong> give you extra
performance in a threaded system!
</li></ul>

<p>
 「<a href="manual.ja_Common_problems.html#Multiple_servers">22.3  同一マシン上に複数の <strong>MySQL</strong> サーバーを走らせる</a>」節参照.

</p>
<p>
This is an example of the config file on behalf of <code>mysqld_multi</code>.

</p>

<pre># This file should probably be in your home dir (~/.my.cnf) or /etc/my.cnf
# Version 2.1 by Jani Tolonen

[mysqld_multi]
mysqld     = /usr/local/bin/safe_mysqld
mysqladmin = /usr/local/bin/mysqladmin
user       = multi_admin
password   = multipass

[mysqld2]
socket     = /tmp/mysql.sock2
port       = 3307
pid-file   = /usr/local/mysql/var2/hostname.pid2
datadir    = /usr/local/mysql/var2
language   = /usr/local/share/mysql/english
user       = john

[mysqld3]
socket     = /tmp/mysql.sock3
port       = 3308
pid-file   = /usr/local/mysql/var3/hostname.pid3
datadir    = /usr/local/mysql/var3
language   = /usr/local/share/mysql/swedish
user       = monty

[mysqld4]
socket     = /tmp/mysql.sock4
port       = 3309
pid-file   = /usr/local/mysql/var4/hostname.pid4
datadir    = /usr/local/mysql/var4
language   = /usr/local/share/mysql/estonia
user       = tonu

[mysqld6]
socket     = /tmp/mysql.sock6
port       = 3311
pid-file   = /usr/local/mysql/var6/hostname.pid6
datadir    = /usr/local/mysql/var6
language   = /usr/local/share/mysql/japanese
user       = jani
</pre>

<p>
 「<a href="manual.ja_Installing.html#Option_files">4.16.5  オプションファイル ( <code>my.cnf</code> )</a>」節参照.

</p>
<p>
<a name="IDX1295"></a>
<a name="IDX1296"></a>
<a name="IDX1297"></a>
<a name="IDX1298"></a>


</p><h2><a name="mysql" href="manual.ja_toc.html#mysql">15.5  コマンドラインツール　（ <code>mysql</code> ）</a></h2>

<p>
<code>mysql</code> はシンプルな SQL shell です(GNU <code>readline</code> を持っています).
これは対話モードと、非対話モードを持っています。 対話モードで使用された場合、
クエリの結果は ASCII テーブルのフォーマットで与えられます。
非対話モードで使用された場合(例えばフィルターとして)、結果はタブ区切りの
フォーマットで返ります。
(出力フォーマットはコマンドラインのオプションで変更できます)
以下のようにしてスクリプトを実行できます：

</p>

<pre>shell&gt; mysql database &lt; script.sql &gt; output.tab
</pre>

<p>
もしクライアントでメモリー不足の問題が出た場合、<code>--quick</code> オプションを
使用します！ これは <code>mysql</code> に、結果セットを取得する際に、
<code>mysql_store_result()</code> ではなく <code>mysql_use_result()</code> を
使用させます。

</p>
<p>
<code>mysql</code> の使用はとても簡単です：
<code>mysql database</code> や <code>mysql --user=user_name --password=your_password d
atabase</code> のようにしてはじめます。
SQL 文を入力し、一文を <samp>`;'</samp>, <samp>`\g'</samp> or <samp>`\G'</samp> で終え、
RETURN/ENTER を押します。

</p>
<p>
<a name="IDX1299"></a>
<a name="IDX1300"></a>
<a name="IDX1301"></a>
<code>mysql</code> は以下のオプションをサポートします：

</p>
<dl compact="">

<dt><code>-?, --help</code>
</dt><dd>
<a name="IDX1302"></a>
 
help を表示して終了
<a name="IDX1303"></a>
</dd><dt><code>-A, --no-auto-rehash</code>
</dt><dd>
自動リハッシュをしない。 テーブルとフィールドの取得には 'rehash' を使用しなくては
なりません。 これは <code>mysql</code> の起動を速くします。
<a name="IDX1304"></a>
</dd><dt><code>-B, --batch</code>
</dt><dd>
結果をタブ区切り、１レコードは１行で出力します。 history ファイルは使用しません。
<a name="IDX1305"></a>
</dd><dt><code>--character-sets-dir=...</code>
</dt><dd>
Directory where character sets are located.
<a name="IDX1306"></a>
</dd><dt><code>-C, --compress</code>
</dt><dd>
サーバー・クライアント間の通信を圧縮します
<a name="IDX1307"></a>
</dd><dt><code>-#, --debug[=...]</code>
</dt><dd>
デバッグログ。 デフォルトは 'd:t:o,/tmp/mysql.trace'
<a name="IDX1308"></a>
</dd><dt><code>-D, --database=..</code>
</dt><dd>
使用するデータベース。 これは <code>my.cnf</code> ファイルが便利です
<a name="IDX1309"></a>
</dd><dt><code>--default-character-set=...</code>
</dt><dd>
Set the default character set.
<a name="IDX1310"></a>
</dd><dt><code>-e, --execute=...</code>
</dt><dd>
コマンドを実行して終了。 (Output like with --batch)
<a name="IDX1311"></a>
</dd><dt><code>-E, --vertical</code>
</dt><dd>
垂直にレコードを出力します。 このオプションを指定していなくても、
SQL 文を <code>\G</code> で終了した場合、同じように垂直に出力します。
<a name="IDX1312"></a>
</dd><dt><code>-f, --force</code>
</dt><dd>
SQL エラーがおきたとしても、処理を続けます
<a name="IDX1313"></a>
</dd><dt><code>-g, --no-named-commands</code>
</dt><dd>
Named commands are disabled. Use \* form only, or use named commands
only in the beginning of a line ending with a semicolon (;). Since
Version 10.9, the client now starts with this option ENABLED by default!
With the -g option, long format commands will still work from the first
line, however.
<a name="IDX1314"></a>
</dd><dt><code>-G, --enable-named-commands</code>
</dt><dd>
Named commands are <strong>enabled</strong>.  Long format commands are allowed as
well as shortened \* commands.
<a name="IDX1315"></a>
</dd><dt><code>-i, --ignore-space</code>
</dt><dd>
関数名の後ろについたスペースを無視します
<a name="IDX1316"></a>
</dd><dt><code>-h, --host=...</code>
</dt><dd>
指定したホストに接続します
<a name="IDX1317"></a>
</dd><dt><code>-H, --html</code>
</dt><dd>
結果を HTML フォーマットで返します
<a name="IDX1318"></a>
</dd><dt><code>-L, --skip-line-numbers</code>
</dt><dd>
エラーの起きた行の番号を書きません。 これはエラーメッセージを含んだ結果を
比較する場合に便利です。
<a name="IDX1319"></a>
</dd><dt><code>--no-pager</code>
</dt><dd>
Disable pager and print to stdout. See interactive help (\h) also.
<a name="IDX1320"></a>
</dd><dt><code>--no-tee</code>
</dt><dd>
Disable outfile. See interactive help (\h) also.
<a name="IDX1321"></a>
</dd><dt><code>-n, --unbuffered</code>
</dt><dd>
それぞれのクエリ毎にバッファをフラッシュします
<a name="IDX1322"></a>
</dd><dt><code>-N, --skip-column-names</code>
</dt><dd>
結果に、フィールド名を書き出しません。
<a name="IDX1323"></a>
</dd><dt><code>-O, --set-variable var=option</code>
</dt><dd>
変数に値をセットします。 <code>--help</code> lists variables
<a name="IDX1324"></a>
</dd><dt><code>-o, --one-database</code>
</dt><dd>
デフォルトのデータベースのみ更新します。 これは update ログファイルを
使用して更新する場合、他のデータベースの更新を避けたい時に便利です。
<a name="IDX1325"></a>
</dd><dt><code><code>--pager[=...]</code></code>
</dt><dd>
Output type. Default is your <code>ENV</code> variable <code>PAGER</code>. Valid
pagers are less, more, cat [&gt; filename], etc.  See interactive help (\h)
also. This option does not work in batch mode. Pager works only in UNIX.
<a name="IDX1326"></a>
</dd><dt><code>-p[password], --password[=...]</code>
</dt><dd>
サーバーに接続する際のパスワード。 もしパスワードがコマンドラインに
指定されていなかった場合、tty 上でパスワードが問い合わされます。
<code>-p</code> を使用する場合、このオプションとパスワードの間には
スペースが不要だということに注意してください。
</dd><dt><code>-P  --port=...</code>
</dt><dd>
接続に使用する TCP/IP ポート番号
<a name="IDX1327"></a>
</dd><dt><code>-q, --quick</code>
</dt><dd>
結果をキャッシュせず、一レコードづつ出力します。
これはもし出力を中止した場合、サーバーを遅くします。
ヒストリファイルは使用しません。
<a name="IDX1328"></a>
</dd><dt><code>-r, --raw</code>
</dt><dd>
エスケープ処理をしないで値を書き出します。 <code>--batch</code> とともに使用されます
<a name="IDX1329"></a>
</dd><dt><code>-s, --silent</code>
</dt><dd>
静粛モード
</dd><dt><code>-S  --socket=...</code>
</dt><dd>
接続に使用する ソケットファイル
<a name="IDX1330"></a>
</dd><dt><code>-t  --table</code>
</dt><dd>
表の形式で出力します。 これは batch モード以外でのデフォルトです。
</dd><dt><code>-T, --debug-info</code>
</dt><dd>
Print some debug information at exit.
<a name="IDX1331"></a>
</dd><dt><code>--tee=...</code>
</dt><dd>
Append everything into outfile. See interactive help (\h) also. Does not
work in batch mode.
<a name="IDX1332"></a>
</dd><dt><code>-u, --user=#</code>
</dt><dd>
ログインユーザー名
<a name="IDX1333"></a>
</dd><dt><code>-U, --safe-updates[=#], --i-am-a-dummy[=#]</code>
</dt><dd>
キーを使用する <code>UPDATE</code> and <code>DELETE</code> のみを行います。
これは後述します。 このオプションをもし <code>my.cnf</code> に書いている場合は、
<code>--safe-updates=0</code> でこのオプションをリセットできます。
<a name="IDX1334"></a>
</dd><dt><code>-v, --verbose</code>
</dt><dd>
冗長出力。 (-v -v -v は表形式の出力を与える)
<a name="IDX1335"></a>
</dd><dt><code>-V, --version</code>
</dt><dd>
バージョンを表示して終了
<a name="IDX1336"></a>
</dd><dt><code>-w, --wait</code>
</dt><dd>
もし接続が落ちた場合、中断しないで、待って、再試行します。
</dd></dl>

<p>
You can also set the following variables with <code>-O</code> or
<code>--set-variable</code>:

</p>
<p>
<a name="IDX1337"></a>
<table border="" width="100%" nosave="">
<tbody><tr><td>Variablename </td><td> Default </td><td> Description
</td></tr>
<tr><td>connect_timeout </td><td> 0 </td><td> Number of seconds before timeout connection.
</td></tr>
<tr><td>max_allowed_packet </td><td> 16777216 </td><td> Max packetlength to send/receive from to server
</td></tr>
<tr><td>net_buffer_length </td><td> 16384 </td><td> Buffer for TCP/IP and socket communication
</td></tr>
<tr><td>select_limit </td><td> 1000 </td><td> Automatic limit for SELECT when using --i-am-a-dummy
</td></tr>
<tr><td>max_join_size </td><td> 1000000 </td><td> Automatic limit for rows in a join when using --i-am-a-dummy.
</td></tr>
</tbody></table>

</p>
<p>
もしコマンドラインで 'help' と打った場合、<code>mysql</code> はサポートする
コマンドを表示します：

</p>
<p>
<a name="IDX1338"></a>

</p><pre>mysql&gt; help

MySQL commands:
help    (\h)    Display this text.
?       (\h)    Synonym for `help'.
clear   (\c)    Clear command.
connect (\r)    Reconnect to the server. Optional arguments are db and host.
edit    (\e)    Edit command with $EDITOR.
ego     (\G)    Send command to mysql server, display result vertically.
exit    (\q)    Exit mysql. Same as quit.
go      (\g)    Send command to mysql server.
nopager (\n)    Disable pager, print to stdout.
notee   (\t)    Don't write into outfile.
pager   (\P)    Set PAGER [to_pager]. Print the query results via PAGER.
print   (\p)    Print current command.
quit    (\q)    Quit mysql.
rehash  (\#)    Rebuild completion hash.
source  (\.)    Execute a SQL script file. Takes a file name as an argument.
status  (\s)    Get status information from the server.
tee     (\T)    Set outfile [to_outfile]. Append everything into given outfile.
use     (\u)    Use another database. Takes database name as argument.
</pre>

<p>
From the above, pager only works in UNIX.

</p>
<p>
<a name="IDX1339"></a>
<code>status</code> コマンドは、今使用している
接続とサーバーについての情報をいくつか表示します。
もし <code>--safe-updates</code> モードで使用している場合、 <code>status</code> は
あなたのクエリに影響する <code>mysql</code> 変数の値を表示します。

</p>
<p>
<a name="IDX1340"></a>
初心者に便利な起動オプション(<strong>MySQL</strong> バージョン 3.23.11 で導入されました)は、
<code>--safe-updates</code> あるいは <code>--i-am-a-dummy</code> です。
( これは <code>DELETE FROM table_name</code> を <code>WHERE</code> 節を忘れて
実行しようとした場合のためにあります。)
このオプションが使用されると、 <code>mysql</code> は接続時に <strong>MySQL</strong> サーバーに
以下のようなコマンドを送ります：

</p>

<pre>SET SQL_SAFE_UPDATES=1,SQL_SELECT_LIMIT=#select_limit#,
    SQL_MAX_JOIN_SIZE=#max_join_size#"
</pre>

<p>
ここで <code>#select_limit#</code> と <code>#max_join_size#</code> は変数で
これらは <code>mysql</code> コマンドからセット可能です。
 「<a href="manual.ja_Reference.html#SET_OPTION">7.33  <code>SET</code> 構文</a>」節参照.

</p>
<p>
この効果は：

</p>

<ul>
<li>

もし <code>WHERE</code> 節でキーを使用していなければ、<code>UPDATE</code> や <code>DELETE</code>
は許可されません。 しかし、 <code>LIMIT</code> を使用すれば <code>UPDATE/DELETE</code> を
強制実行できます：

<pre>UPDATE table_name SET not_key_column=# WHERE not_key_column=# LIMIT 1;
</pre>

</li><li>

全ての多きな結果は自動的に <code>#select_limit#</code> レコードまでに抑えられます。
</li><li>

評価に <code>#max_join_size</code> 以上の行を必要とするであろう <code>SELECT</code> は
中断されます。
</li></ul>

<p>
Some useful hints about the <code>mysql</code> client:

</p>
<p>
Some data is much more readable when displayed vertically, instead of
the usual horizontal box type output. For example longer text, which
includes new lines, is often much easier to be read with vertical
output.

</p>

<pre>mysql&gt; select * from mails where length(txt) &lt; 300 limit 300,1\G
*************************** 1. row ***************************
  msg_nro: 3068
     date: 2000-03-01 23:29:50
time_zone: +0200
mail_from: Monty
    reply: monty@no.spam.com
  mail_to: "Thimble Smith" &lt;tim@no.spam.com&gt;
      sbj: UTF-8
      txt: &gt;&gt;&gt;&gt;&gt; "Thimble" == Thimble Smith writes:

Thimble&gt; Hi.  I think this is a good idea.  Is anyone familiar with UTF-8
Thimble&gt; or Unicode?  Otherwise I'll put this on my TODO list and see what
Thimble&gt; happens.

Yes, please do that.

Regards,
Monty
     file: inbox-jani-1
     hash: 190402944
1 row in set (0.09 sec)
</pre>


<ul>
<li>

For logging, you can use the <code>tee</code> option. The <code>tee</code> can be
started with option <code>--tee=...</code>, or from the command line
interactively with command <code>tee</code>. All the data displayed on the
screen will also be appended into a given file. This can be very useful
for debugging purposes also. The <code>tee</code> can be disabled from the
command line with command <code>notee</code>. Executing <code>tee</code> again
starts logging again. Without a parameter the previous file will be
used. Note that <code>tee</code> will flush the results into the file after
each command, just before the command line appears again waiting for the
next command.
</li><li>

Browsing, or searching the results in the interactive mode in UNIX less,
more, or any other similar program, is now possible with option
<code>--pager[=...]</code>. Without argument, <code>mysql</code> client will look
for environment variable PAGER and set <code>pager</code> to that.
<code>pager</code> can be started from the interactive command line with
command <code>pager</code> and disabled with command <code>nopager</code>.  The
command takes an argument optionally and the <code>pager</code> will be set to
that. Command <code>pager</code> can be called without an argument, but this
requires that the option <code>--pager</code> was used, or the <code>pager</code>
will default to stdout. <code>pager</code> works only in UNIX, since it uses
the popen() function, which doesn't exist in Windows. In Windows, the
<code>tee</code> option can be used instead, although it may not be as handy
 <code>pager</code> can be in some situations.
</li><li>

A few tips about <code>pager</code>: You can use it to write to a file:

<pre>mysql&gt; pager cat &gt; /tmp/log.txt
</pre>

and the results will only go to a file. You can also pass any options
for the programs that you want to use with the <code>pager</code>:

<pre>mysql&gt; pager less -n -i -S
</pre>

From the above do note the option '-S'. You may find it very useful when
browsing the results; try the option with horizontal output (end
commands with '\g', or ';') and with vertical output (end commands with
'\G'). Sometimes a very wide result set is hard to be read from the screen,
with option -S to less you can browse the results within the interactive
less from left to right, preventing lines longer than your screen from
being continued to the next line. This can make the result set much more
readable. You can swith the mode between on and off within the interactive
less with '-S'. See the 'h' for more help about less.
</li><li>

Last (unless you already understood this from the above examples ;) you
can combine very complex ways to handle the results, for example the
following would send the results to two files in two different
directories, on two different hard-disks mounted on /dr1 and /dr2, yet
let the results still be seen on the screen via less:

<pre>mysql&gt; pager cat | tee /dr1/tmp/res.txt | tee /dr2/tmp/res2.txt | less -n -i -S
</pre>

</li><li>

You can also combine the two functions above; have the <code>tee</code>
enabled, <code>pager</code> set to 'less' and you will be able to browse the
results in unix 'less' and still have everything appended into a file
the same time. The difference between <code>UNIX tee</code> used with the
<code>pager</code> and the <code>mysql</code> client in-built <code>tee</code>, is that
the in-built <code>tee</code> works even if you don't have the <code>UNIX tee</code>
available. The in-built <code>tee</code> also logs everything that is printed
on the screen, where the <code>UNIX tee</code> used with <code>pager</code> doesn't
log quite that much. Last, but not least, the interactive <code>tee</code> is
more handy to switch on and off, when you want to log something into a
file, but want to be able to turn the feature off sometimes.
</li></ul>

<p>
<a name="IDX1341"></a>
<a name="IDX1342"></a>
<a name="IDX1343"></a>


</p><h2><a name="mysqladmin" href="manual.ja_toc.html#mysqladmin">15.6  <strong>MySQL</strong> サーバーの管理　( <code>mysqladmin</code> )</a></h2>

<p>
管理オペレーションを実行するためのユーティリティ。シンタックスは: 

</p>

<pre>shell&gt; mysqladmin [OPTIONS] command [command-option] command ...
</pre>

<p>
<code>mysqladmin --help</code> によって、オプションの一覧を手にいれることができます。

</p>
<p>
現在の <code>mysqladmin</code> は以下のコマンドをサポートします：

</p>
<table border="" width="100%" nosave="">
<tbody><tr><td>create databasename </td><td> データベースの作成
</td></tr>
<tr><td>drop databasename </td><td> データベースとテーブルの全削除。
</td></tr>
<tr><td>extended-status </td><td> サーバーから拡張ステータスを取得。
</td></tr>
<tr><td>flush-hosts </td><td> キャッシュされている全ホストをフラッシュ。
</td></tr>
<tr><td>flush-logs </td><td> 全てのログをフラッシュ
</td></tr>
<tr><td>flush-tables </td><td> 全てのテーブルをフラッシュ
</td></tr>
<tr><td>flush-privileges </td><td> 許可テーブルの再読み込み (reload と同じ)
</td></tr>
<tr><td>kill id,id,... </td><td> mysql スレッドの kill.
</td></tr>
<tr><td>password New-password </td><td> 古いパスワードを New-password に変更
</td></tr>
<tr><td>ping </td><td> mysqld が生きているかチェック
</td></tr>
<tr><td>processlist </td><td> 現在活動中の mysql スレッドを表示
</td></tr>
<tr><td>reload </td><td> 許可テーブルの再読み込み
</td></tr>
<tr><td>refresh </td><td> 全テーブルをフラッシュし、ログファイルを一度閉じて開きます。
</td></tr>
<tr><td>shutdown </td><td> サーバーをダウンさせます。
</td></tr>
<tr><td>slave-start </td><td> Start slave replication thread
</td></tr>
<tr><td>slave-stop </td><td> Stop slave replication thread
</td></tr>
<tr><td>status </td><td> サーバーから短いステータスを得ます。
</td></tr>
<tr><td>variables </td><td> 変数の表示
</td></tr>
<tr><td>version </td><td> サーバーからバージョンを得ます。
</td></tr>
</tbody></table>

<p>
全てのコマンドは、ユニークなプレフィックスで省略可能です。
例えば：

</p>

<pre>shell&gt; mysqladmin proc stat
+----+-------+-----------+----+-------------+------+-------+------+
| Id | User  | Host      | db | Command     | Time | State | Info |
+----+-------+-----------+----+-------------+------+-------+------+
| 6  | monty | localhost |    | Processlist | 0    |       |      |
+----+-------+-----------+----+-------------+------+-------+------+
Uptime: 10077  Threads: 1  Questions: 9  Slow queries: 0  Opens: 6  Flush tables: 1  Open tables: 2  Memory in use: 1092K  Max memory used: 1116K
</pre>

<p>
<a name="IDX1344"></a>
<code>mysqladmin status</code> コマンドの結果は、以下の項目を持ちます:

</p>
<p>
<a name="IDX1345"></a>
<table border="" width="100%" nosave="">
<tbody><tr><td>Uptime </td><td> <strong>MySQL</strong> サーバーの起動秒数
</td></tr>
<tr><td>Threads </td><td> 稼働中のスレッド数 (clients)
<a name="IDX1346"></a>
 
</td></tr>
<tr><td>Questions </td><td> <code>mysqld</code> が開始してからのクライアントからのクエリ数
<a name="IDX1347"></a>
 
</td></tr>
<tr><td>Slow queries </td><td> <code>long_query_time</code> 秒より時間のかかったクエリの数  「<a href="manual.ja_Log_files.html#Slow_query_log">23.5  The Slow Query Log</a>」節参照.
<a name="IDX1348"></a>
 
</td></tr>
<tr><td>Opens </td><td> <code>mysqld</code> が開いたテーブル数
<a name="IDX1349"></a>
 
</td></tr>
<tr><td>Flush tables </td><td> <code>flush ...</code>, <code>refresh</code>, and <code>reload</code> コマンドの実行回数
<a name="IDX1350"></a>
 <a name="IDX1351"></a>
 
</td></tr>
<tr><td>Open tables </td><td> 現在開かれているテーブルの数
<a name="IDX1352"></a>
 
</td></tr>
<tr><td>Memory in use </td><td> mysqld のコードによって直接割り当てられたメモリ (only available when <strong>MySQL</strong> is compiled with --with-debug=full)
<a name="IDX1353"></a>
 
</td></tr>
<tr><td>Max memory used </td><td> mysqld のコードによって直接割り当てられる最大メモリー量 (only available when <strong>MySQL</strong> is compiled with --with-debug=full)
<a name="IDX1354"></a>
 
</td></tr>
</tbody></table>

</p>
<p>
If you do <code>myslqadmin shutdown</code> on a socket (in other words, on a
the computer where <code>mysqld</code> is running), <code>mysqladmin</code> will
wait until the <strong>MySQL</strong> <code>pid-file</code> is removed to ensure that
the <code>mysqld</code> server has stopped properly.

</p>
<p>
<a name="IDX1355"></a>
<a name="IDX1356"></a>
<a name="IDX1357"></a>
<a name="IDX1358"></a>


</p><h2><a name="mysqldump" href="manual.ja_toc.html#mysqldump">15.7  <strong>MySQL</strong> データベースとテーブルから、構造とデータをダンプ　( <code>mysqldump</code> )</a></h2>

<p>
<a name="IDX1359"></a>
データベース、あるいは、バックアップ、他のSQLサーバー(<strong>MySQL</strong> サーバである必
要はない)へのデータを移動を目的としたデータのまとまり、これらをダンプする
ためのユーティリティ。ダンプは、テーブルの作成のための SQL 文を含みます。

</p>
<p>
サーバでバックアップを行なう場合、<code>mysqlhotcopy</code> を代わりに使用するこ
とを考慮すべきです。 「<a href="manual.ja_Tools.html#mysqlhotcopy">15.8  Copying MySQL Databases and Tables</a>」節参照。

</p>

<pre>shell&gt; mysqldump [OPTIONS] database [tables]
OR     mysqldump [OPTIONS] --databases [OPTIONS] DB1 [DB2 DB3...]
OR     mysqldump [OPTIONS] --all-databases [OPTIONS]
</pre>

<p>
もしテーブルを指定せず、<code>--databases</code> や <code>--all-databases</code> を
使用しなかったなら、データベースの全てのテーブルがダンプされます。

</p>
<p>
<code>mysqldump --help</code> によって、オプションの一覧を手にいれることができます。

</p>
<p>
もし <code>mysqldump</code> を <code>--quick</code> や <code>--opt</code> なしで実行するならば、
<code>mysqldump</code> は結果を表示する前に、結果をメモリに全てロードすることに
注意してください。
これは大きなデータベースをダンプする際に問題になるでしょう。

</p>
<p>
Note that if you are using a new copy of the <code>mysqldump</code> program
and you are going to do a dump that will be read into a very old <strong>MySQL</strong>
server, you should not use the <code>--opt</code> or <code>-e</code> options.

</p>
<p>
<code>mysqldump</code> は以下のオプションをサポートします：

</p>
<dl compact="">

<dt><code>--add-locks</code>
</dt><dd>
テーブルのダンプの前に <code>LOCK TABLES</code> 文を追加し、
テーブルのダンプ後に <code>UNLOCK TABLE</code> 文を追加します。
( あとで <strong>MySQL</strong> に挿入するときにこれは速くなります ).
</dd><dt><code>--add-drop-table</code>
</dt><dd>
テーブルの create 文の前に、<code>drop table</code> 文を追加します。
</dd><dt><code>-A, --all-databases</code>
</dt><dd>
Dump all the databases. This will be same as <code>--databases</code> with all
databases selected.
</dd><dt><code>-a, --all</code>
</dt><dd>
Include all <strong>MySQL</strong> specific create options.
</dd><dt><code>--allow-keywords</code>
</dt><dd>
キーワード(予約語) と同じ名前をもつフィールドの作成を許します。
これは、それぞれのフィールドの前に、テーブル名を付け足します。
</dd><dt><code>-c, --complete-insert</code>
</dt><dd>
完全な INSERT 文(フィールド名を書いた文) を使用します。

</dd><dt><code>-C, --compress</code>
</dt><dd>
もしサーバーとクライアントの双方が圧縮をサポートしているならば、
両者の間で行われる通信を全て圧縮します。
</dd><dt><code>-B, --databases</code>
</dt><dd>
To dump several databases. Note the difference in usage. In this case
no tables are given. All name arguments are regarded as database names.
<code>USE db_name;</code> will be included in the output before each new database.
</dd><dt><code>--delayed</code>
</dt><dd>
<code>INSERT DELAYED</code> コマンドを使用してレコードを INSERT します。
</dd><dt><code>-e, --extended-insert</code>
</dt><dd>
新しいマルチライン <code>INSERT</code> 構文を使用します。(これはあとで挿入する際、
よりコンパクトかつ速くなります。)
</dd><dt><code>-#, --debug[=option_string]</code>
</dt><dd>
Trace usage of the program (for debugging).
</dd><dt><code>--help</code>
</dt><dd>
Display a help message and exit.
</dd><dt><code>--fields-terminated-by=...</code>
</dt><dd>
</dd><dt><code>--fields-enclosed-by=...</code>
</dt><dd>
</dd><dt><code>--fields-optionally-enclosed-by=...</code>
</dt><dd>
</dd><dt><code>--fields-escaped-by=...</code>
</dt><dd>
</dd><dt><code>--lines-terminated-by=...</code>
</dt><dd>
これらのオプションは <code>-T</code> とともに使用され、
<code>LOAD DATA INFILE</code> と同様の意味をなします。
 「<a href="manual.ja_Reference.html#LOAD_DATA">7.23  <code>LOAD DATA INFILE</code>構文</a>」節参照.
</dd><dt><code>-F, --flush-logs</code>
</dt><dd>
ダンプする前に、 <strong>MySQL</strong> サーバーのログファイルをフラッシュします。
</dd><dt><code>-f, --force,</code>
</dt><dd>
ダンプの途中で SQL エラーが発生しても、ダンプを続けます。
</dd><dt><code>-h, --host=..</code>
</dt><dd>
指定されたホストの <strong>MySQL</strong> サーバーからダンプします。
デフォルトのホストは <code>localhost</code>.
</dd><dt><code>-l, --lock-tables.</code>
</dt><dd>
ダンプを開始するとき全てのテーブルをロックします。 The tables are locked with
<code>READ LOCAL</code> to allow concurrent inserts in the case of <code>MyISAM</code>
tables.
</dd><dt><code>-n, --no-create-db</code>
</dt><dd>
'CREATE DATABASE /*!32312 IF NOT EXISTS*/ db_name;' will not be put in the
output. The above line will be added otherwise, if --databases or
--all-databases option was given.
</dd><dt><code>-t, --no-create-info</code>
</dt><dd>
テーブルの作成情報( <code>CREATE TABLE</code> 文) を書き出しません。
</dd><dt><code>-d, --no-data</code>
</dt><dd>
テーブル内のレコードを書き出しません。
これはテーブルの構造だけを取り出したいときにとても便利です！
</dd><dt><code>--opt</code>
</dt><dd>
<code>--quick --add-drop-table --add-locks --extended-insert --lock-tables</code> と同じ.
<strong>MySQL</strong> サーバーから読み出す時間を最短にしてくれます。
</dd><dt><code>-pyour_pass, --password[=your_pass]</code>
</dt><dd>
サーバーに接続する際のパスワードを与えます。
もし <samp>`=your_pass'</samp> 部分を与えなかった場合は、
<code>mysqldump</code> はパスワードのプロンプトをだします。
</dd><dt><code>-P port_num, --port=port_num</code>
</dt><dd>
サーバーに接続する際に使用する TCP/IP ポート番号。
 (これは <code>localhost</code> 以外のホストへの接続に使用されます。
 <code>localhost</code> の場合は、UNIX ソケットが使用されます。)
</dd><dt><code>-q, --quick</code>
</dt><dd>
クエリをバッファにため込みません。stdout に直接出します。
<code>mysql_use_result()</code> をこれに使用しています。
</dd><dt><code>-r, --result-file=...</code>
</dt><dd>
Direct output to a given file. This option should be used in MSDOS,
because it prevents new line '\n' from being converted to '\n\r' (new
line + carriage return).
</dd><dt><code>-S /path/to/socket, --socket=/path/to/socket</code>
</dt><dd>
<code>localhost</code> に接続する際のソケットファイルの指定 (デフォルトは /tmp/mysql.sock )
</dd><dt><code>--tables</code>
</dt><dd>
Overrides option --databases (-B).
</dd><dt><code>-T, --tab=path-to-some-directory</code>
</dt><dd>
与えられたテーブル毎に、
SQL CREATE 文を含む <code>table_name.sql</code> ファイル、
データを含む <code>table_name.txt</code> ファイルを作成します。
<strong>NOTE</strong>: 
これは <code>mysqld</code> デーモンが走っているマシン上で <code>mysqldump</code> を
実行する場合にだけ、動作します。
 <code>.txt</code> ファイルのフォーマットは、
 <code>--fields-xxx</code> と <code>--lines--xxx</code> オプションに従います。
</dd><dt><code>-u user_name, --user=user_name</code>
</dt><dd>
サーバーに接続する際の <strong>MySQL</strong> ユーザー名。
デフォルトでは、UNIX のログイン名になります。
</dd><dt><code>-O var=option, --set-variable var=option</code>
</dt><dd>
変数の値をセット。 可能な変数は後で示しします。
</dd><dt><code>-v, --verbose</code>
</dt><dd>
冗長モード。 プログラムが何を行っているかより表示します。
</dd><dt><code>-V, --version</code>
</dt><dd>
バージョンを示して終了。
</dd><dt><code>-w, --where='where-condition'</code>
</dt><dd>
選択されたレコードのみをダンプ： クオートは必須です！


<pre>"--where=user='jimf'" "-wuserid&gt;1" "-wuserid&lt;1"
</pre>

</dd><dt><code>-O net_buffer_length=#, where # &lt; 16M</code>
</dt><dd>
When creating multi-row-insert statements (as with option
<code>--extended-insert</code> or <code>--opt</code>), <code>mysqldump</code> will create
rows up to <code>net_buffer_length</code> length. If you increase this
variable, you should also ensure that the <code>max_allowed_packet</code>
variable in the <strong>MySQL</strong> server is bigger than the
<code>net_buffer_length</code>.
</dd></dl>

<p>
<code>mysqldump</code> の普通の使用はデータベースのバックアップでしょう。  「<a href="manual.ja_Common_problems.html#Backup">22.2  データベースのバックアップ</a>」節参照.

</p>

<pre>mysqldump --opt database &gt; backup-file.sql
</pre>

<p>
You can read this back into <strong>MySQL</strong> with:

</p>

<pre>mysql database &lt; backup-file.sql
</pre>

<p>
or

</p>

<pre>mysql -e "source /patch-to-backup/backup-file.sql" database
</pre>

<p>
他の <strong>MySQL</strong> サーバーへデータベースをコピーする場合にも便利です：

</p>

<pre>mysqldump --opt database | mysql --host=remote-host -C database
</pre>

<p>
It is possible to dump several databases with one command:

</p>

<pre>mysqldump --databases database1 [database2 database3...] &gt; my_databases.sql
</pre>

<p>
If all the databases are wanted, one can use:

</p>

<pre>mysqldump --all-databases &gt; all_databases.sql
</pre>

<p>
<a name="IDX1360"></a>
<a name="IDX1361"></a>
<a name="IDX1362"></a>
<a name="IDX1363"></a>


</p><h2><a name="mysqlhotcopy" href="manual.ja_toc.html#mysqlhotcopy">15.8  Copying MySQL Databases and Tables</a></h2>

<p>
<code>mysqlhotcopy</code> is a perl script that uses <code>LOCK TABLES</code>,
<code>FLUSH TABLES</code> and <code>cp</code> or <code>scp</code> to quickly make a backup
of a database.  It's the fastest way to make a backup of the database,
of single tables but it can only be run on the same machine where the
database directories are.

</p>

<pre>mysqlhotcopy db_name [/path/to/new_directory]

mysqlhotcopy db_name_1 ... db_name_n /path/to/new_directory

mysqlhotcopy db_name./regex/
</pre>

<p>
<code>mysqlhotcopy</code> supports the following options:

</p>
<dl compact="">

<dt><code>-?, --help</code>
</dt><dd>
Display a help screen and exit
</dd><dt><code>-u, --user=#</code>
</dt><dd>
User for database login
</dd><dt><code>-p, --password=#</code>
</dt><dd>
Password to use when connecting to server
</dd><dt><code>-P, --port=#</code>
</dt><dd>
Port to use when connecting to local server
</dd><dt><code>-S, --socket=#</code>
</dt><dd>
Socket to use when connecting to local server
</dd><dt><code>--allowold</code>
</dt><dd>
Don't abort if target already exists (rename it _old)
</dd><dt><code>--keepold</code>
</dt><dd>
Don't delete previous (now renamed) target when done
</dd><dt><code>--noindices</code>
</dt><dd>
Don't include full index files in copy to make the backup smaller and faster
The indexes can later be reconstructed with <code>myisamchk -rq.</code>.
</dd><dt><code>--method=#</code>
</dt><dd>
Method for copy (<code>cp</code> or <code>scp</code>).
</dd><dt><code>-q, --quiet</code>
</dt><dd>
Be silent except for errors
</dd><dt><code>--debug</code>
</dt><dd>
Enable debug
</dd><dt><code>-n, --dryrun</code>
</dt><dd>
Report actions without doing them
</dd><dt><code>--regexp=#</code>
</dt><dd>
Copy all databases with names matching regexp
</dd><dt><code>--suffix=#</code>
</dt><dd>
Suffix for names of copied databases
</dd><dt><code>--checkpoint=#</code>
</dt><dd>
Insert checkpoint entry into specified db.table
</dd><dt><code>--flushlog</code>
</dt><dd>
Flush logs once all tables are locked.
</dd><dt><code>--tmpdir=#</code>
</dt><dd>
Temporary directory (instead of /tmp).
</dd></dl>

<p>
You can use 'perldoc mysqlhotcopy' to get a more complete documentation for
<code>mysqlhotcopy</code>.

</p>
<p>
<code>mysqlhotcopy</code> reads the group <code>[mysqlhotcopy]</code> from the option
files.

</p>
<p>
<a name="IDX1364"></a>
<a name="IDX1365"></a>
<a name="IDX1366"></a>
<a name="IDX1367"></a>
<a name="IDX1368"></a>


</p><h2><a name="mysqlimport" href="manual.ja_toc.html#mysqlimport">15.9  テキストファイルからデータを取り込む　( <code>mysqlimport</code> )</a></h2>

<p>
<code>mysqlimport</code> は、<code>LOAD DATA INFILE</code> SQL 構文を、
コマンドラインインターフェースで提供します。
<code>mysqlimport</code> のオプションのほとんどが、
 <code>LOAD DATA INFILE</code> への同じオプションに対応します。
 「<a href="manual.ja_Reference.html#LOAD_DATA">7.23  <code>LOAD DATA INFILE</code>構文</a>」節参照.

</p>
<p>
<code>mysqlimport</code> の実行は以下のようにします:

</p>

<pre>shell&gt; mysqlimport [options] database textfile1 [textfile2....]
</pre>

<p>
<code>mysqlimport</code> は、コマンドラインの引数に与えられたファイル名の拡張子を取り、
拡張子を取った後の名前を、ファイルの内容を取り込むテーブルの名前とします。
例えば、<tt>`patient.txt'</tt>, <tt>`patient.text'</tt>, <tt>`patient'</tt> という
ファイルは全て、<code>patient</code> とという名前のテーブルに取り込まれます。

</p>
<p>
<code>mysqlimport</code> は以下のオプションをサポートします:

</p>
<dl compact="">

<dt><code>-c, --columns=...</code>
</dt><dd>
This option takes a comma-separated list of field names as an argument.
The field list is used to create a proper <code>LOAD DATA INFILE</code> command,
which is then passed to <strong>MySQL</strong>.  「<a href="manual.ja_Reference.html#LOAD_DATA">7.23  <code>LOAD DATA INFILE</code>構文</a>」節参照.

</dd><dt><code>-C, --compress</code>
</dt><dd>
クライアントとサーバーの両方が圧縮をサポートしているなら、
クライアント・サーバー間でやり取りされる全ての情報を圧縮します。

</dd><dt><code>-#, --debug[=option_string]</code>
</dt><dd>
プログラムのトレース(デバッグ)

</dd><dt><code>-d, --delete</code>
</dt><dd>
テキストファイルを取り込む前にテーブルを空にします。

</dd><dt><code>--fields-terminated-by=...</code>
</dt><dd>
</dd><dt><code>--fields-enclosed-by=...</code>
</dt><dd>
</dd><dt><code>--fields-optionally-enclosed-by=...</code>
</dt><dd>
</dd><dt><code>--fields-escaped-by=...</code>
</dt><dd>
</dd><dt><code>--lines-terminated-by=...</code>
</dt><dd>
これらのオプションは、<code>LOAD DATA INFILE</code> の対応する文節と同じ意味になります。
 「<a href="manual.ja_Reference.html#LOAD_DATA">7.23  <code>LOAD DATA INFILE</code>構文</a>」節参照.

</dd><dt><code>-f, --force</code>
</dt><dd>
エラーを無視します。例えば、テキストファイルを取り込むテーブルがない場合、
残りのファイルの処理に移ります。 <code>--force</code> がなければ、
テーブルがなければ <code>mysqlimport</code> は終了します。

</dd><dt><code>--help</code>
</dt><dd>
ヘルプを表示して終了。

</dd><dt><code>-h host_name, --host=host_name</code>
</dt><dd>
名前を指定された <strong>MySQL</strong> サーバーにデータを取り入れます。
デフォルトでは <code>localhost</code>.

</dd><dt><code>-i, --ignore</code>
</dt><dd>
<code>--replace</code> オプションの説明を見てください。

</dd><dt><code>-l, --lock-tables</code>
</dt><dd>
それぞれのテキストファイルを処理する前に、書き込まれる
<strong>全ての</strong>テーブルをロックします。
これは確実に、すべてのテーブルをサーバ上で同期させます。

</dd><dt><code>-L, --local</code>
</dt><dd>
クライアントからの入力ファイルを読みます。
デフォルトでは、<code>localhost</code> に接続した場合、テキストファイルは
サーバー上にあると仮定されます。(<code>localhost</code> はデフォルト値)

</dd><dt><code>-pyour_pass, --password[=your_pass]</code>
</dt><dd>
サーバーに接続するときに使用するパスワード。
もし <samp>`=your_pass'</samp> のところにパスワードを書かなければ、
<code>mysqlimport</code> はパスワードのためのプロンプトをだします。

</dd><dt><code>-P port_num, --port=port_num</code>
</dt><dd>
ホストに接続するための TCP/IP ポート番号。
(これは <code>localhost</code> を除くホストへの接続に使用します。
<code>localhost</code> へは、UNIX ソケットを使用します。)

</dd><dt><code>-r, --replace</code>
</dt><dd>
<code>--replace</code> と <code>--ignore</code> オプションは、
入力されているレコードのユニークキーの値が、
既に存在しているレコードのユニークキーの値と同じ場合、
その入力されているデータの取り扱いを決定します。
もし <code>--replace</code> が指定されているなら、
既にあるレコードは新しく読まれたレコードに置き換えられます。
もし <code>--ignore</code> が指定されているなら、
入力された物は無視されます。
どちらのオプションも指定していない場合、
キーの値が重なっているとエラーを発し、
テキストファイルの残りの部分は無視されます。

</dd><dt><code>-s, --silent</code>
</dt><dd>
静粛モード。エラーだけ出力します。

</dd><dt><code>-S /path/to/socket, --socket=/path/to/socket</code>
</dt><dd>
<code>localhost</code> への接続時に使用するソケットファイルを指定します。

</dd><dt><code>-u user_name, --user=user_name</code>
</dt><dd>
サーバーの接続に使用する <strong>MySQL</strong> ユーザー名の指定。
デフォルトは、Unix のログイン名。

</dd><dt><code>-v, --verbose</code>
</dt><dd>
冗長モード。プログラムがしている事について多く出力します。

</dd><dt><code>-V, --version</code>
</dt><dd>
バージョンを表示して終了。
</dd></dl>

<p>
Here is a sample run using <code>mysqlimport</code>:

</p>

<pre>$ mysql --version
mysql  Ver 9.33 Distrib 3.22.25, for pc-linux-gnu (i686)
$ uname -a
Linux xxx.com 2.2.5-15 #1 Mon Apr 19 22:21:09 EDT 1999 i586 unknown
$ mysql -e 'CREATE TABLE imptest(id INT, n VARCHAR(30))' test
$ ed
a
100     Max Sydow
101     Count Dracula
.
w imptest.txt
32
q
$ od -c imptest.txt
0000000   1   0   0  \t   M   a   x       S   y   d   o   w  \n   1   0
0000020   1  \t   C   o   u   n   t       D   r   a   c   u   l   a  \n
0000040
$ mysqlimport --local test imptest.txt
test.imptest: Records: 2  Deleted: 0  Skipped: 0  Warnings: 0
$ mysql -e 'SELECT * FROM imptest' test
+------+---------------+
| id   | n             |
+------+---------------+
|  100 | Max Sydow     |
|  101 | Count Dracula |
+------+---------------+
</pre>

<p>
<a name="IDX1369"></a>
<a name="IDX1370"></a>


</p><h2><a name="perror" href="manual.ja_toc.html#perror">15.10  Converting an error code to the corresponding error message</a></h2>

<p>
<code>perror</code> can be used to print error message(s). <code>perror</code> can
be invoked like this:

</p>

<pre>shell&gt; perror [OPTIONS] [ERRORCODE [ERRORCODE...]]

For example:

shell&gt; perror 64 79
Error code  64:  Machine is not on the network
Error code  79:  Can not access a needed shared library
</pre>

<p>
<code>perror</code> can be used to display a description for a system error
code, or an MyISAM/ISAM table handler error code. The error messages
are mostly system dependent.

</p>

<p>
<a name="IDX1371"></a>
<a name="IDX1372"></a>
<a name="IDX1373"></a>
<a name="IDX1374"></a>
<a name="IDX1375"></a>


</p><h2><a name="mysqlshow" href="manual.ja_toc.html#mysqlshow">15.11  Showing Databases, Tables, and Columns</a></h2>

<p>
<code>mysqlshow</code> can be used to quickly look at which databases exist,
their tables, and the table's columns.

</p>
<p>
With the <code>mysql</code> program you can get the same information with the
<code>SHOW</code> commands.   「<a href="manual.ja_Reference.html#SHOW">7.28  <code>SHOW</code> 構文</a>」節参照.

</p>
<p>
<code>mysqlshow</code> is invoked like this:

</p>

<pre>shell&gt; mysqlshow [OPTIONS] [database [table [column]]]
</pre>


<ul>
<li>

If no database is given, all matching databases are shown.
</li><li>

If no table is given, all matching tables in the database are shown.
</li><li>

If no column is given, all matching columns and column types in the table
are shown.
</li></ul>

<p>
Note that in newer <strong>MySQL</strong> versions, you only see those
database/tables/columns for which you have some privileges.

</p>
<p>
If the last argument contains a shell or SQL wild-card (<code>*</code>, <code>?</code>,
<code>%</code> or <code>_</code>) then only what's matched by the wild card is shown.
This may cause some confusion when you try to display the columns for a
table with a <code>_</code> as in this case <code>mysqlshow</code> only shows you
the table names that match the pattern.  This is easily fixed by
adding an extra <code>%</code> last on the command line (as a separate
argument).

</p>
<p>
<a name="IDX1376"></a>
<a name="IDX1377"></a>
<a name="IDX1378"></a>
<a name="IDX1379"></a>
<a name="IDX1380"></a>


</p><h2><a name="myisampack" href="manual.ja_toc.html#myisampack">15.12  <strong>MySQL</strong> の圧縮された読み込み専用テーブルジェネレータ　( <code>myisampack</code> ・ <code>pack_isam</code> )</a></h2>

<p>
<code>myisampack</code> is used to compress MyISAM tables, and <code>pack_isam</code>
is used to compress ISAM tables. Because ISAM tables are deprecated, we
will only discuss <code>myisampack</code> here, but everything said about
<code>myisampack</code> should also be true for <code>pack_isam</code>.

</p>
<p>
<code>myisampack</code> はテーブル内の各項目を別々に圧縮するように働きます。展開のため
の情報は、テーブルがオープンされた時にメモリに読まれます。これは、正確に1レコー
ドだけを展開する必要があるような、個々のレコードへのアクセス時にとても良
い性能を与えます。MSDOS 上の Stacker 使用時のように、ディスクブロックは
そんなに大きくありません。
通常、<code>myisampack</code> はデータファイルを 40～70% にパックします。

</p>
<p>
<strong>MySQL</strong> は圧縮されたテーブルでメモリマップ (<code>mmap()</code>) を使用します。
<code>mmap()</code> が働かない場合は、通常のファイルの読み書きを使用します。

</p>
<p>
現在 <code>myisampack</code> には2つの制限があります:

</p><ul>
<li>

パック後、テーブルは読み込み専用になります。
</li><li>

<code>myisampack</code> can also pack <code>BLOB</code> or <code>TEXT</code> columns. The
older <code>pack_isam</code> could not do this.
</li></ul>

<p>
これらの制限の修正は TODO にありますが、優先度は低いです。

</p>
<p>
<code>myisampack</code> は以下のようにして起動します:

</p>

<pre>shell&gt; myisampack [options] filename ...
</pre>

<p>
それぞれのファイル名はインデックスファイル(<tt>`.MYI'</tt>)の名前です。
もしデータディレクトリにカレントディレクトリを移動していないなら、
ファイルのパスを指定しなくてはなりません。<tt>`.MYI'</tt> 拡張子は
省略することが可能です。

</p>
<p>
<code>myisampack</code> は以下のオプションをサポートします:

</p>
<dl compact="">

<dt><code>-b, --backup</code>
</dt><dd>
<code>tbl_name.OLD</code> としてバックアップを作成します.

</dd><dt><code>-#, --debug=debug_options</code>
</dt><dd>
デバック出力。<code>debug_options</code> は <code>'d:t:o,filename'</code>.

</dd><dt><code>-f, --force</code>
</dt><dd>
一時ファイルが存在していようが、サイズが大きくなろうが、強制的にテーブルを
パックします。
<code>myisampack</code> はテーブルを圧縮している間、
一時ファイルを <tt>`tbl_name.TMD'</tt> という名前で作成します。
もし <code>myisampack</code> を途中で kill した場合、 <tt>`.TMD'</tt> ファイルが消されて
いない事があります。通常、<code>myisampack</code> は <tt>`tbl_name.TMD'</tt> ファイルが
既に存在する場合はエラーで終了します。 <code>--force</code> を使用すると、
<code>myisampack</code> はそのような場合でもテーブルをパックします。

</dd><dt><code>-?, --help</code>
</dt><dd>
ヘルプメッセージを出力して終了。

</dd><dt><code>-j big_tbl_name, --join=big_tbl_name</code>
</dt><dd>
全てのテーブルをコマンドラインで指定した <code>big_tbl_name</code> 一つに
まとめます。結合される全てのテーブル定義は同じでなければなりません
(同じ項目名、同じ項目型、同じインデックス、等)

</dd><dt><code>-p #, --packlength=#</code>
</dt><dd>
Specify the record length storage size, in bytes.  The value should be 1, 2,
or 3.  (<code>myisampack</code> stores all rows with length pointers of 1, 2, or 3
bytes.  In most normal cases, <code>myisampack</code> can determine the right length
value before it begins packing the file, but it may notice during the packing
process that it could have used a shorter length. In this case,
<code>myisampack</code> will print a note that the next time you pack the same file,
you could use a shorter record length.)

</dd><dt><code>-s, --silent</code>
</dt><dd>
Silent mode.  Write output only when errors occur.

</dd><dt><code>-t, --test</code>
</dt><dd>
Don't actually pack table, just test packing it.

</dd><dt><code>-T dir_name, --tmp_dir=dir_name</code>
</dt><dd>
Use the named directory as the location in which to write the temporary table.

</dd><dt><code>-v, --verbose</code>
</dt><dd>
Verbose mode.  Write information about progress and packing result.

</dd><dt><code>-V, --version</code>
</dt><dd>
Display version information and exit.

</dd><dt><code>-w, --wait</code>
</dt><dd>
Wait and retry if table is in use.
If the <code>mysqld</code> server was invoked with the <code>--skip-locking</code>
option, it is not a good idea to invoke <code>myisampack</code> if the table might
be updated during the packing process.
</dd></dl>

<p>
<a name="IDX1381"></a>
The sequence of commands shown below illustrates a typical table compression
session:

</p>

<pre>shell&gt; ls -l station.*
-rw-rw-r--   1 monty    my         994128 Apr 17 19:00 station.ISD
-rw-rw-r--   1 monty    my          53248 Apr 17 19:00 station.ISM
-rw-rw-r--   1 monty    my         994128 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          53248 Apr 17 19:00 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&gt; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-02-02  3:06:43
Data records:              1192  Deleted blocks:              0
Datafile: Parts:           1192  Deleted data:                0
Datafile pointer (bytes):     2  Keyfile pointer (bytes):     2
Max datafile length:   54657023  Max keyfile length:   33554431
Recordlength:               834
Record format: Fixed length

table description:
Key Start Len Index   Type                       Root  Blocksize    Rec/key
1   2     4   unique  unsigned long              1024       1024          1
2   32    30  multip. text                      10240       1024          1

Field Start Length Type
1     1     1
2     2     4
3     6     4
4     10    1
5     11    20
6     31    1
7     32    30
8     62    35
9     97    35
10    132   35
11    167   4
12    171   16
13    187   35
14    222   4
15    226   16
16    242   20
17    262   20
18    282   20
19    302   30
20    332   4
21    336   4
22    340   1
23    341   8
24    349   8
25    357   8
26    365   2
27    367   2
28    369   4
29    373   4
30    377   1
31    378   2
32    380   8
33    388   4
34    392   4
35    396   4
36    400   4
37    404   1
38    405   4
39    409   4
40    413   4
41    417   4
42    421   4
43    425   4
44    429   20
45    449   30
46    479   1
47    480   1
48    481   79
49    560   79
50    639   79
51    718   79
52    797   8
53    805   1
54    806   1
55    807   20
56    827   4
57    831   4

shell&gt; myisampack station.MYI
Compressing station.MYI: (1192 records)
- Calculating statistics

normal:     20  empty-space:      16  empty-zero:        12  empty-fill:  11
pre-space:   0  end-space:        12  table-lookups:      5  zero:         7
Original trees:  57  After join: 17
- Compressing file
87.14%

shell&gt; ls -l station.*
-rw-rw-r--   1 monty    my         127874 Apr 17 19:00 station.ISD
-rw-rw-r--   1 monty    my          55296 Apr 17 19:04 station.ISM
-rw-rw-r--   1 monty    my         127874 Apr 17 19:00 station.MYD
-rw-rw-r--   1 monty    my          55296 Apr 17 19:04 station.MYI
-rw-rw-r--   1 monty    my           5767 Apr 17 19:00 station.frm

shell&gt; myisamchk -dvv station

MyISAM file:     station
Isam-version:  2
Creation time: 1996-03-13 10:08:58
Recover time:  1997-04-17 19:04:26
Data records:              1192  Deleted blocks:              0
Datafile: Parts:           1192  Deleted data:                0
Datafilepointer (bytes):      3  Keyfile pointer (bytes):     1
Max datafile length:   16777215  Max keyfile length:     131071
Recordlength:               834
Record format: Compressed

table description:
Key Start Len Index   Type                       Root  Blocksize    Rec/key
1   2     4   unique  unsigned long             10240       1024          1
2   32    30  multip. text                      54272       1024          1

Field Start Length Type                         Huff tree  Bits
1     1     1      constant                             1     0
2     2     4      zerofill(1)                          2     9
3     6     4      no zeros, zerofill(1)                2     9
4     10    1                                           3     9
5     11    20     table-lookup                         4     0
6     31    1                                           3     9
7     32    30     no endspace, not_always              5     9
8     62    35     no endspace, not_always, no empty    6     9
9     97    35     no empty                             7     9
10    132   35     no endspace, not_always, no empty    6     9
11    167   4      zerofill(1)                          2     9
12    171   16     no endspace, not_always, no empty    5     9
13    187   35     no endspace, not_always, no empty    6     9
14    222   4      zerofill(1)                          2     9
15    226   16     no endspace, not_always, no empty    5     9
16    242   20     no endspace, not_always              8     9
17    262   20     no endspace, no empty                8     9
18    282   20     no endspace, no empty                5     9
19    302   30     no endspace, no empty                6     9
20    332   4      always zero                          2     9
21    336   4      always zero                          2     9
22    340   1                                           3     9
23    341   8      table-lookup                         9     0
24    349   8      table-lookup                        10     0
25    357   8      always zero                          2     9
26    365   2                                           2     9
27    367   2      no zeros, zerofill(1)                2     9
28    369   4      no zeros, zerofill(1)                2     9
29    373   4      table-lookup                        11     0
30    377   1                                           3     9
31    378   2      no zeros, zerofill(1)                2     9
32    380   8      no zeros                             2     9
33    388   4      always zero                          2     9
34    392   4      table-lookup                        12     0
35    396   4      no zeros, zerofill(1)               13     9
36    400   4      no zeros, zerofill(1)                2     9
37    404   1                                           2     9
38    405   4      no zeros                             2     9
39    409   4      always zero                          2     9
40    413   4      no zeros                             2     9
41    417   4      always zero                          2     9
42    421   4      no zeros                             2     9
43    425   4      always zero                          2     9
44    429   20     no empty                             3     9
45    449   30     no empty                             3     9
46    479   1                                          14     4
47    480   1                                          14     4
48    481   79     no endspace, no empty               15     9
49    560   79     no empty                             2     9
50    639   79     no empty                             2     9
51    718   79     no endspace                         16     9
52    797   8      no empty                             2     9
53    805   1                                          17     1
54    806   1                                           3     9
55    807   20     no empty                             3     9
56    827   4      no zeros, zerofill(2)                2     9
57    831   4      no zeros, zerofill(1)                2     9
</pre>

<p>
The information printed by <code>myisampack</code> is described below:

</p>
<dl compact="">

<dt><code>normal</code>
</dt><dd>
The number of columns for which no extra packing is used.

</dd><dt><code>empty-space</code>
</dt><dd>
The number of columns containing
values that are only spaces; these will occupy 1 bit.

</dd><dt><code>empty-zero</code>
</dt><dd>
The number of columns containing
values that are only binary 0's; these will occupy 1 bit.

</dd><dt><code>empty-fill</code>
</dt><dd>
The number of integer columns that don't occupy the full byte range of their
type; these are changed to a smaller type (for example, an <code>INTEGER</code>
column may be changed to <code>MEDIUMINT</code>).

</dd><dt><code>pre-space</code>
</dt><dd>
The number of decimal columns that are stored with leading spaces. In this
case, each value will contain a count for the number of leading spaces.

</dd><dt><code>end-space</code>
</dt><dd>
The number of columns that have a lot of trailing spaces.  In this case, each
value will contain a count for the number of trailing spaces.

</dd><dt><code>table-lookup</code>
</dt><dd>
The column had only a small number of different values, which were
converted to an <code>ENUM</code> before Huffman compression.

</dd><dt><code>zero</code>
</dt><dd>
The number of columns for which all values are zero.

</dd><dt><code>Original trees</code>
</dt><dd>
The initial number of Huffman trees.

</dd><dt><code>After join</code>
</dt><dd>
The number of distinct Huffman trees left after joining
trees to save some header space.
</dd></dl>

<p>
After a table has been compressed, <code>myisamchk -dvv</code> prints additional
information about each field:

</p>
<dl compact="">

<dt><code>Type</code>
</dt><dd>
The field type may contain the following descriptors:

<dl compact="">

<dt><code>constant</code>
</dt><dd>
All rows have the same value.

</dd><dt><code>no endspace</code>
</dt><dd>
Don't store endspace.

</dd><dt><code>no endspace, not_always</code>
</dt><dd>
Don't store endspace and don't do end space compression for all values.

</dd><dt><code>no endspace, no empty</code>
</dt><dd>
Don't store endspace. Don't store empty values.

</dd><dt><code>table-lookup</code>
</dt><dd>
The column was converted to an <code>ENUM</code>.

</dd><dt><code>zerofill(n)</code>
</dt><dd>
The most significant <code>n</code> bytes in the value are always 0 and are not
stored.

</dd><dt><code>no zeros</code>
</dt><dd>
Don't store zeros.

</dd><dt><code>always zero</code>
</dt><dd>
0 values are stored in 1 bit.
</dd></dl>

</dd><dt><code>Huff tree</code>
</dt><dd>
The Huffman tree associated with the field.

</dd><dt><code>Bits</code>
</dt><dd>
The number of bits used in the Huffman tree.
</dd></dl>

<p>
After you have run <code>pack_isam</code>/<code>myisampack</code> you must run
<code>isamchk</code>/<code>myisamchk</code> to re-create the index.  At this time you
can also sort the index blocks and create statistics needed for
the <strong>MySQL</strong> optimizer to work more efficiently:

</p>

<pre>myisamchk -rq --analyze --sort-index table_name.MYI
isamchk   -rq --analyze --sort-index table_name.ISM
</pre>

<p>
After you have installed the packed table into the <strong>MySQL</strong> database
directory you should do <code>mysqladmin flush-tables</code> to force <code>mysqld</code>
to start using the new table.

</p>

<p>
<a name="IDX1382"></a>
<a name="IDX1383"></a>
<a name="IDX1384"></a>
<a name="IDX1385"></a>
<a name="IDX1386"></a>
<a name="IDX1387"></a>
<a name="IDX1388"></a>
</p><p></p><hr><p>
Go to the <a href="manual.ja_Introduction.html">first</a>, <a href="manual.ja_MySQL_Benchmarks.html">previous</a>, <a href="manual.ja_Maintenance.html">next</a>, <a href="manual.ja_Concept_Index.html">last</a> section, <a href="manual.ja_toc.html">table of contents</a>.
 
 
</p></body></html>