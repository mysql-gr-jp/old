<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:14849</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="14848.html">[前]</a><a href="14850.html">[次]</a><a href="../list/14801-14900.html">[番号順一覧]</a><a href="../thread/14801-14900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:14849
</p>
<div class="header">
<p>
From: 加藤　昌幸 &lt;加藤　昌幸 &lt;m-kato@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 14 May 2009 12:35:02 +0900<br>
Subject: [mysql 14849] vb.netにて<br>

</p>
</div>
<div class="body">
<pre>
加藤といいます。いつもお世話になっております。
現在 MySQL5.0.22と、connecter.net5.0.7を使用して
Visual Basic.net 2005にてアプリケーションを作り
使用しています。

最近問題がありまして、該当するアプリケーションを
使用していると、User connectionsのconnection threads
に接続がSleepのままどんどん増えていきます。
アプリケーションを終了させると消えるのですが、
使用を続ける限り、接続するつどconnection threads
が増えていきます。
コードは下記のような感じです。よろしくお願いいたします。

モジュールにて
--------------------------------------------------------------------------
Public connMySQL As MySqlConnection

　　Public Function MySQL_Open() As Byte
        Try
            connMySQL = New MySqlConnection

            connMySQL.ConnectionString = &quot;接続内容&quot;
            connMySQL.Open()
            Return 1
        Catch ex As Exception
            MessageBox.Show(&quot;接続エラー&quot;)

            Return 0
        End Try

    End Function

    Public Sub MySQL_Close()
        connMySQL.Close()
        connMySQL.Dispose()
    End Sub
--------------------------------------------------------------------------
フォームにて
--------------------------------------------------------------------------
       If MySQL_Open() = 1 Then
            Try
                MySQLcmd = New MySqlCommand _
                    (&quot;select aaa from bbb where ccc='dd'&quot;, connMySQL)
                    rdMySQL = MySQLcmd.ExecuteReader
                    rdMySQL.Read()
                    txt1.text=rdMySQL(0)
                    rdMySQL.Close()
                End If
            Catch ex As Exception
                MessageBox.Show(&quot;エラー&quot;)
            Finally
                MySQL_Close()
            End Try
        End If
----------------------------------------------------------------------------








</pre>
</div>
<p class="button"><a href="14848.html">[前]</a><a href="14850.html">[次]</a><a href="../list/14801-14900.html">[番号順一覧]</a><a href="../thread/14801-14900.html">[スレッド一覧]</a></p>
</body>
</html>
