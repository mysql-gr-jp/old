<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:2335</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="2334">[前]</a><a href="2336">[次]</a><a href="../list/2301-2400">[番号順一覧]</a><a href="../thread/2301-2400">[スレッド一覧]</a></p>
<p class="id">
mysql:2335
</p>
<div class="header">
<p>
From: 滝沢 純 &lt;滝沢 純 &lt;takizawa@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 1 Aug 2000 22:22:26 +0900 <br>
Subject: [mysql 02335] Re: PHP からのテーブルロック !!!<br>

</p>
</div>
<div class="body">
<pre>
早瀬様レスありがとうございます。

おっしゃる通り、すべて表示しきった状態で、セッションが閉じられているようで
す。
実際には、ロックは正常に作動しているのでしょうね。ありがとうございます。

ところが、実はmysql_pconnect()で繋いでしまい、ロックが今度は解除されなくなっ
てしまいました！
Mysql上でunlockしてもどうにもこうにも反応してくれません。。。。
mysql_pconnect()はMysql_close()でも閉じられないとマニュアルにありましたが、
ブラウザを閉じてもテーブルが反応してくれなくなってしまいました！
現在、復旧の手段を探しているのですが、なにぶんMysql自体ここ1週間くらいしか
触ってないもので、
どなたかこの状況を抜け出すすべを教えて頂けないでしょうか？
お願いします。


<span class="quote1">&gt; -----Original Message-----</span>
<span class="quote1">&gt; From:	Yasuhiro Hayase [SMTP:hayase@xxxxxxxxxx]</span>
<span class="quote1">&gt; Sent:	Tuesday, August 01, 2000 9:56 PM</span>
<span class="quote1">&gt; To:	mysql@xxxxxxxxxx</span>
<span class="quote1">&gt; Subject:	<a href="02334">[mysql 02334]</a> Re: PHP からのテーブルロック</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 早瀬@阪大といいます。</span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt; &gt; 　　　&lt;?</span>
<span class="quote2">&gt; &gt; 　　　　$tlock=mysql_ruery(&quot;lock tables testtable write&quot;,$conn); </span>
<span class="quote2">&gt; &gt; 　　　　$result=mysql_ruery(select文,$conn); </span>
<span class="quote2">&gt; &gt; 　　　　$res_test=mysql_result($result,0,&quot;test&quot;);</span>
<span class="quote2">&gt; &gt; 　　　?&gt;</span>
<span class="quote2">&gt; &gt; と書いたコードを実行してみました。</span>
<span class="quote2">&gt; &gt; ここでは、$tlockにはtrueがきちんと帰っているのです。</span>
<span class="quote2">&gt; &gt; その状態で、もうひとつブラウザを立ち上げ、そのにテーブルアクセスすると</span>
<span class="quote2">&gt; &gt; きちんと要求が帰ってきてしましました。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; これはテーブルロックされていないということなんですよね。</span>
<span class="quote2">&gt; &gt; 通常はこれで表示まちになるのでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; えーと、PHPのコードですから、ページが表示された段階ですでにmysqlの</span>
<span class="quote1">&gt; セッションが閉じられてるのではないでしょうか。セッションが閉じられ</span>
<span class="quote1">&gt; れば、ロックは自動的に解除されます。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; PHPは知らないのですが、lock tablesの後に、sleepの様な関数をいれて実</span>
<span class="quote1">&gt; 験してはいかがでしょうか。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ---</span>
<span class="quote1">&gt; 早瀬@大阪大学基礎工学部情報科学科 3年次</span>
<span class="quote1">&gt; mail: hayase@xxxxxxxxxx</span>

</pre>
</div>
<p class="button"><a href="2334">[前]</a><a href="2336">[次]</a><a href="../list/2301-2400">[番号順一覧]</a><a href="../thread/2301-2400">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="2335">   2335 2000-08-01 22:22 [滝沢 純 &lt;takizawa@xx] Re: PHP からのテーブルロック !!!        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2337">   2337 2000-08-01 22:36 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
</pre>
</body>
</html>
