<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:14055</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="14054.html">[前]</a><a href="14056.html">[次]</a><a href="../list/14001-14100.html">[番号順一覧]</a><a href="../thread/14001-14100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:14055
</p>
<div class="header">
<p>
From: "小川安弘" &lt;"小川安弘" &lt;randy.ogawa@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 13 Jun 2007 17:29:36 +0900<br>
Subject: [mysql 14055] MySqlDataReaderオブジェクトのclose メソッドの応答がなくなる<br>

</p>
</div>
<div class="body">
<pre>はじめまして、小川と申します。

Mysql のConnector/Net を使用して、Windowsアプリケーションから
自ＰＣのMySql のデータを、MySqlDataReader　で読み出しています。

MySqlDataReader　のオブジェクトが、False を返すまで読み出すと
正常に、クローズできるのですが、途中で、MySqlDataReaderオブジェクト
のclose メソッドを呼び出すと、ハングアップしてしまい、強制終了しないと
いけなくなります。

以下のソースで言うと、
DataReader を閉じます　は出力されますが、
DataReader を閉じました　は出力されません

このあたりの情報をお持ちのかた、いらっしゃいますか。

以下にソースコードを示します。

        Dim con As New MySqlConnection
        Dim cmd As MySqlCommand
        Dim drd As MySqlDataReader
        Dim strSql As String = "SELECT * FROM tablename;"

        con.ConnectionString = "Database=xx;Data Source=localhost;User
Id=xx;Password=xx"
        con.Open()

        cmd = New MySqlCommand(strSql, con)
        drd = cmd.ExecuteReader
        Do While (drd.Read)
            Debug.Print("field0=" &amp; drd.Item(0).ToString )
            Exit Do
        Loop
        Debug.Print("DataReader を閉じます。")
        drd.Close()
        Debug.Print("DataReader を閉じました。")
        cmd.Dispose()
        con.Close()


開発環境
microsoft Windows XP Proffesional Edition SP2
mysql  Ver 14.12 Distrib 5.0.22, for Win32 (ia32)
mysql.data 5.0.7.0 ( Connector/Net )
Microsoft Visual Studio 2005　Professional　Edition
Version 8.0.50727.762  (SP.050727-7600)
Microsoft .NET Framework
Version 2.0.50727

</pre>
</div>
<p class="button"><a href="14054.html">[前]</a><a href="14056.html">[次]</a><a href="../list/14001-14100.html">[番号順一覧]</a><a href="../thread/14001-14100.html">[スレッド一覧]</a></p>


</body></html>