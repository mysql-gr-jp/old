<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15837</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="15836.html">[前]</a><a href="15838.html">[次]</a><a href="../list/15801-15900.html">[番号順一覧]</a><a href="../thread/15801-15900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15837
</p>
<div class="header">
<p>
From: Thuyoshi Nukii &lt;Thuyoshi Nukii &lt;nukii@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 04 Sep 2012 17:53:55 +0900<br>
Subject: [mysql 15837] スレーブサーバがアボートしてしまう現象について<br>

</p>
</div>
<div class="body">
<pre>
貫井（ぬきい）と申します。

複数のデータベースサーバをレプリケーション環境で運用していますが、
スレーブサーバがアボートしてしまう事象が発生し困っており、皆様に
アドバイスがいただければと思い投稿させていただきました。

環境
  マスタサーバ
    OS   ：RHEL 6.2 (x86_64)
    MySQL：MySQL 5.5.19( 64 Bit版)

  スレーブサーバ
    OS   ：RHEL 6.2 (x86_64)
    MySQL：MySQL 5.5.19( 64 Bit版)

  ・レプリケーションは、行 ベース レプリケーションで行っています。
  ・各サーバ間は、専用のGBitネットワークです。



現象としては、
１．スレーブサーバが応答しなくなります。

２．DBサーバに稼働状況をか確認しに行くと、mysqldがプロセスとして
    存在していない状況になっています。

３．mysqld_safeがmysqldを起動しようとする
    起動することもありますが、以下のエラーで起動できないことが多
    いです。

４．エラーログ上に残っている内容
ibuf0ibuf.c line 4124
InnoDB: Failing assertion: page_get_n_recs(page) &gt; 1
InnoDB: We intentionally generate a memory trap.
InnoDB: Submit a detailed bug report to <a href="http://bugs.mysql.com.">http://bugs.mysql.com.</a>
InnoDB: If you get repeated assertion failures or crashes, even
InnoDB: immediately after the mysqld startup, there may be
InnoDB: corruption in the InnoDB tablespace. Please refer to
InnoDB: <a href="http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html">http://dev.mysql.com/doc/refman/5.5/en/forcing-innodb-recovery.html</a>
InnoDB: about forcing recovery.

５．mysqldがアボートしていることに関してはエラーの出力はなく起動
    に関するエラーしか残っていません。

以降は、innodb_force_recovery=4では起動できるので、データを抜き出
して、削除してインポートするとレプリケーションも再開でき問題なく
稼働できます。

ここ2ヶ月で複数台のスレーブサーバがアボートしていますが、同じサー
バでの発生はないです。
各サーバのマスターサーバは別のものですので書き込みデータも違うも
のです。

マスター側は問題なく稼働しており、データ問題があるとも思えず原因が
つかめない状況です。


以上、よろしくお願いいたします。



</pre>
</div>
<p class="button"><a href="15836.html">[前]</a><a href="15838.html">[次]</a><a href="../list/15801-15900.html">[番号順一覧]</a><a href="../thread/15801-15900.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="15837.html">  15837 2012-09-04 17:53 [Thuyoshi Nukii &lt;nuki] スレーブサーバがアボートしてしまう現象について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15838.html">  15838 2012-09-04 18:44 ┗[yoku ts &lt;yoku0825@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15839.html">  15839 2012-09-05 09:28 　┗[Thuyoshi Nukii &lt;nuki]                                     </a></span>
</pre>
</body>
</html>
