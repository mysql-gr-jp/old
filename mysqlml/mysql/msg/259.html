<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:259</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="258.html">[前]</a><a href="260.html">[次]</a><a href="../list/201-300.html">[番号順一覧]</a><a href="../thread/201-300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:259
</p>
<div class="header">
<p>
From: &quot;民斗 &quot; &lt;&quot;民斗 &quot; &lt;tommy@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 21 Sep 1998 13:44:02 +0900<br>
Subject: [mysql 259] Re: ruby.. unresolv moddi3<br>

</p>
</div>
<div class="body">
<pre>

[Subject: <a href="258.html">[mysql 258]</a> ruby.. unresolv moddi3]
[Date: Mon, 21 Sep 1998 12:48:51 +0900  From:takeshi@xxxxxxxxxx]

<span class="quote1">&gt; ちょっと民斗さんの ruby を使って、 ruby の勉強でもしようとおもって、</span>

おお〜 ruby-mysql の初ユーザかも… (^^)


<span class="quote1">&gt; コンパイルしたのですが、</span>
<span class="quote1">&gt; require &quot;mysql&quot;</span>
<span class="quote1">&gt; で</span>
<span class="quote1">&gt; ruby: can't resolve symbol '__moddi3'</span>
<span class="quote1">&gt; ruby: can't resolve symbol '__divdi3'</span>
<span class="quote1">&gt; となってしまいました。</span>
<span class="quote1">&gt; ( gcc-2.7.2, mysql-3.22.4a-beta, Linux libc5 )</span>

あ、なりました。そういえば。なんかコンパイル環境によって発生したり
なかったりするような感じだったので、どうしようかと思いつつ特に
ドキュメントにも書きませんでした。


<span class="quote1">&gt; どうも、libmysqlclient が呼び出している関数の一部が、</span>
<span class="quote1">&gt; gcc がリンク時に使う自分の libgcc.a 内にある moddi3 , divdi3 を</span>
<span class="quote1">&gt; 呼び出しており、これが ruby , mysql.so , libmysqlclient.so|.a</span>
<span class="quote1">&gt; のすべてで unedf となっているため、おきているようです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; で、しょうがないので、ruby の main.c に、moddi3 を使うように、</span>
<span class="quote1">&gt; 全く使わない関数を入れて gcc をだまして回避したわけですが、</span>
<span class="quote1">&gt; もっとうまく回避できないものでしょうか?</span>

現象としては、MySQL のマニュアルの「Perl installation comments」に
書かれてるのと同じなんで、同じように対処できます。

具体的には extconf.rb の $libs に &quot;/usr/local/gcc-lib/〜〜/libgcc.a&quot;
を追加すればうまくいくと思います。


<span class="quote1">&gt; # ruby 本体を -lmysqlclient でコンパイルすると多分行くかな？</span>
<span class="quote1">&gt; # ruby 本体が libmysqlclient に依存するのもいやだなぁ...</span>

そうですね。それはいまいちだと思います (^^;


<span class="quote1">&gt; これって、Linux の gcc-2.7.2 だけで起こってます？</span>
<span class="quote1">&gt; 他の環境ではどうなんでしょう？</span>

確か SPARC の gcc-2.7.2.2 でも発生したと思います。gcc-2.8.1 でも
起こったかもしれません。もしかすると発生しない環境というのは私の
勘違いで全ての環境で発生するのかもしれません…(^^;;

--
民斗 &lt;tommy@xxxxxxxxxx&gt;

</pre>
</div>
<p class="button"><a href="258.html">[前]</a><a href="260.html">[次]</a><a href="../list/201-300.html">[番号順一覧]</a><a href="../thread/201-300.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="259.html">    259 1998-09-21 13:44 [&quot;民斗 &quot; &lt;tommy@xxxxx] Re: ruby.. unresolv moddi3              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="260.html">    260 1998-09-21 14:46 ┣[民斗 &lt;tommy@xxxxxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="261.html">    261 1998-09-21 15:02 ┗[&lt;takeshi@xxxxxxxxxx&gt;]                                       </a></span>
</pre>
</body>
</html>
