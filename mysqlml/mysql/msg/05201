<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5201</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5200">[前]</a><a href="5202">[次]</a><a href="../list/5201-5300">[番号順一覧]</a><a href="../thread/5201-5300">[スレッド一覧]</a></p>
<p class="id">
mysql:5201
</p>
<div class="header">
<p>
From: &quot;fuji&quot; &lt;&quot;fuji&quot; &lt;fujita_n@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 26 Feb 2002 22:22:11 +0900<br>
Subject: [mysql 05201] 全件検索の時間<br>

</p>
</div>
<div class="body">
<pre>
はじめまして。ふじといいます。
MySQL初心者です。（データベース自体初心者）

見よう見真似で、Apache + Perl + MySQL で
ＤＢを作成しました。

WEBブラウザからPerlを使って検索してみたのですが、
９万件ぐらいで、５秒ぐらいかかります。
５千件ぐらいの時は一瞬でした。
件数が増えるとこういうものなのでしょうか？
もしくは設定が全然ダメなんでしょうか？

検索は、３個のフォームに何も入力せずに検索です。
検索条件を入れた時はある程度早く検索します。
何も入力せずに、検索ボタンを押した時に早く結果を得たいと
思ってます。
？考え方がおかしい可能性も含めて
どなたか、教えていただけると助かります。

環境は、
--------------------------------------------
サーバー
Windows2000Server
Apache 1.3.23-win32-x86-no_src.exe
ActivePerl-5.6.1.631-MSWin32-x86.msi（DBI DBD-Mysql使用）
mysql-3.23.47-win.zip
　＊サーバーは他に Lotus Notes が起動してます。
--------------------------------------------
クライアント（検索実行ＰＣ）
Windows2000Professional
検索は、サーバー上のWEBより。
（<a href="http://192.168.1.1">http://192.168.1.1</a> とアクセス）
--------------------------------------------
MySQLのテーブル

   create table test (
   test1 char(6) not null,
   test2 char(2) not null,
   test3 char(1) not null,
   test4 char(1) not null,
   test5 char(8) not null,
   index  (test1,test2,test3,test4,test5)
   );

件数は９万件ほど。
--------------------------------------------
Perl 記述

 $db = DBI-&gt;connect('DBI:mysql:abc:localhost','root','love');
 $sth = $db-&gt;prepare(&quot;SELECT * FROM test where test1 LIKE '$kw1%' and test2
LIKE '$kw2%' and test3 LIKE '$kw3%'&quot;);
 $sth-&gt;execute;
 $hit_num = $sth-&gt;rows;
 print &quot;Content-type: text/html\n\n&quot;;
 print &quot;&lt;HTML&gt;&lt;BODY&gt;\n&quot;;
 print &quot;$hit_num 件見つかりました&lt;BR&gt;\n&quot;;
 for ($i=0; $i&lt;$hit_num; $i++) {
  @str = $sth-&gt;fetchrow_array;

   $insert_dt = $str[0].&quot;,&quot;.$str[1].&quot;,&quot;.$str[2];
   if ($befcmp_dt eq $insert_dt){$same__chk = 1;}
   else {$same__chk = 0;
    $befcmp_dt = $insert_dt;
   }
   if ($same__chk eq 0){
    push(@HIT,&quot;$str[0],$str[1],$str[2],$str[3],$str[4]&quot;);    #検索結果を
@HIT へ！！
   }
  print &quot;$str[0],$str[1],$str[2],$str[3],$str[4]&lt;br&gt;\n&quot;;
 }
 print &quot;&lt;/BODY&gt;&lt;/HTML&gt;\n&quot;;
 $sth-&gt;finish;
 $db-&gt;disconnect;
 $kensaku_cnt = @HIT;










</pre>
</div>
<p class="button"><a href="5200">[前]</a><a href="5202">[次]</a><a href="../list/5201-5300">[番号順一覧]</a><a href="../thread/5201-5300">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="5201">   5201 2002-02-26 22:22 [&quot;fuji&quot; &lt;fujita_n@xxx] 全件検索の時間                          </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5202">   5202 2002-02-26 23:01 ┣[tateyan &lt;tateyan@xxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5203">   5203 2002-02-26 23:09 ┣[&quot;KAWAI,Takanori&quot; &lt;GC]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5204">   5204 2002-02-26 23:09 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5205">   5205 2002-02-27 00:11 　┗[tateyan &lt;tateyan@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5206">   5206 2002-02-27 03:34 　　┗[&quot;Takuji Hidaka&quot; &lt;tak]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5207">   5207 2002-02-27 10:29 　　　┗[&quot;fuji&quot; &lt;fujita_n@xxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5208">   5208 2002-02-27 11:51 　　　　┗[&quot;KAWAI,Takanori&quot; &lt;GC]                               </a></span>
</pre>
</body>
</html>
