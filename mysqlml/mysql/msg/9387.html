<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:9387</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="9386.html">[前]</a><a href="9388.html">[次]</a><a href="../list/9301-9400.html">[番号順一覧]</a><a href="../thread/9301-9400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:9387
</p>
<div class="header">
<p>
From: &quot;久松大輔&quot; &lt;&quot;久松大輔&quot; &lt;CQN04630@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 19 May 2004 15:52:43 +0900<br>
Subject: [mysql 09387] 巨大テーブルの高速操作<br>

</p>
</div>
<div class="body">
<pre>
久松と申します。
いつも大変参考にさせてもらっています。

あるシステムのトレンドデータを管理するために、MySQL(Windows)を利用しているのです
が、SELECT 実行中の INSERT が実行されないので困っています。

トレンドデータは、日時と実数のカラムが約３００あるテーブルで、１秒間隔でデータを
保存しています。一ヶ月分のデータを保持しているので、約７ＧＢのテーブルです。件数
は…約２７０万件になります。古いデータは毎日、DELETE されます。
このデータを表示するために、SELECT を実行するのですが、この時指定した抽出期間に
よって、かなり長いＳＱＬ実行時間になり、その間、別プロセスで INSERT しているはず
のデータが見当たりません。（グラフ表示しているので一目瞭然）

SELECT 実行中にそのテーブルがロックされ、 INSERTが拒否されているように思えるので
すが、これを回避する方法はないでしょうか？

一応、現在発行しているＳＱＬを書いておきます。

SELECT SQL_SMALL_RESULT DISTINCT PTIME, XXX, XXX, XXX, XXX
 FROM TRNDLOG
 WHERE (PTIME &gt; XXXX) AND (PTIME &lt;= XXXX)
 GROUP BY XXXXX
 ORDER BY PTIME LIMIT XXX;

PTIMEは日時で、これを MINUTE とか SECOND とかを使って GROUP BY の条件にしていま
す。
取得するデータは PTIME を含めて３００点中の８点です。
ちなみに、Delphi から ODBC 経由でのアクセスです。

よろしくお願いします。




</pre>
</div>
<p class="button"><a href="9386.html">[前]</a><a href="9388.html">[次]</a><a href="../list/9301-9400.html">[番号順一覧]</a><a href="../thread/9301-9400.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="9387.html">   9387 2004-05-19 15:52 [&quot;久松大輔&quot; &lt;CQN04630] 巨大テーブルの高速操作                  </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9390.html">   9390 2004-05-19 22:45 ┗[SUGAWARA Hajime &lt;sug]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9392.html">   9392 2004-05-20 09:02 　┗[&quot;久松大輔&quot; &lt;CQN04630]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9395.html">   9395 2004-05-20 11:30 　　┣[SUGAWARA Hajime &lt;sug]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9397.html">   9397 2004-05-20 11:56 　　┃┗[SUGAWARA Hajime &lt;sug]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9398.html">   9398 2004-05-20 12:48 　　┃　┗[&quot;久松大輔&quot; &lt;CQN04630]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9396.html">   9396 2004-05-20 11:46 　　┗[SUGAWARA Hajime &lt;sug]                                   </a></span>
</pre>
</body>
</html>
