<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:979</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="978.html">[前]</a><a href="980.html">[次]</a><a href="../list/901-1000.html">[番号順一覧]</a><a href="../thread/901-1000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:979
</p>
<div class="header">
<p>
From: 奥田  典子 &lt;奥田  典子 &lt;okud_no@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 21 Jun 1999 13:43:23 +0900<br>
Subject: [mysql 00979] MYODBC.DLL のエラー<br>

</p>
</div>
<div class="body">
<pre>以前、DBI でお世話になった奥田です。

PerlのWin32::ODBC.pm を使用し、MySQL データベースの更新を行うプログラムを
開発していますが、今回は、原因不明のエラーで、困っております。

・ODBCのconnect/Close 等の前に、system()やバッククォートによるDOSコマンド
  の呼出しを行うと、MYODBC.DLL(?) のエラーが発生する。

というものです。


簡単ですが、以下のようなテストスクリプトでも発生します。

    use Win32::ODBC;
    $dsn  ="DSN=sadb";                                  # MySQL

    $date  = `cdate +%y%m%d`;
    chop ($date);
    print ("Today is $date\n");

    system ("PATH");

    $dbh  = new Win32::ODBC($dsn) || die "connect err : $dsn";
    print ("DB:$dsn connect OK\n");
    $dbh-&gt;Close();


表示されるエラーメッセージと詳細情報は、以下のとおりです。

「このプログラムは不正な処理を行ったので強制終了されます」

JPERL のヘ゜ーシ゛違反です。
モシ゛ュール : MYODBC.DLL、アト゛レス : 0157:018fdc66
Registers:
EAX=00000000 CS=0157 EIP=018fdc66 EFLGS=00010246
EBX=00000000 SS=015f ESP=018dfbe8 EBP=018dfbec
ECX=018dfc1c DS=015f ESI=816afe8c FS=46ef
EDX=00000000 ES=015f EDI=018f0000 GS=0000
Bytes at CS:EIP:
8b 42 08 89 01 8b 4d 18 8b 55 fc 8b 42 0c 89 01 
Stack dump:
00000000 018dfc24 018ff002 0193753c 01937440 000000f8 018dfc1c 018dfc20
018dfc14 018dfc10 00000000 0000003c 00000000 bff7419b bffc2470 018dfc40


なお、以下の事象を確認しております。
・データベースをSQL-Serverにして試したところ、エラーは発生しない。
・Windows-NTでは、エラーは発生しない。


実行環境は、以下のとおりです。
Windows95
myodbc.dll  2.50.2100  TCX DataKonsult AB
Jperl       5.003 Build316
MySQL       3.21.30

何か情報がありましたら教えていただきたいと思います。
よろしくお願いします。
-----------------------------------------------------------------
奥田  典子 &lt;okud_no@xxxxxxxxxx&gt;


</pre>
</div>
<p class="button"><a href="978.html">[前]</a><a href="980.html">[次]</a><a href="../list/901-1000.html">[番号順一覧]</a><a href="../thread/901-1000.html">[スレッド一覧]</a></p>
<pre class="list"><span class="current">-&gt;&nbsp;<a href="979.html">    979 1999-06-21 13:43 [奥田  典子 &lt;okud_no@] MYODBC.DLL のエラー                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="983.html">    983 1999-06-25 10:34 ┗["Shoku Yanagawa" &lt;ya] MYODBC.DLL $B$,$*$+$7$$!!(B?        </a></span>
</pre>


</body></html>