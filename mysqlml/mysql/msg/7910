<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:7910</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="7909">[前]</a><a href="7911">[次]</a><a href="../list/7901-8000">[番号順一覧]</a><a href="../thread/7901-8000">[スレッド一覧]</a></p>
<p class="id">
mysql:7910
</p>
<div class="header">
<p>
From: A.K.I. &lt;A.K.I. &lt;aki@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 17 Jun 2003 12:35:02 +0900<br>
Subject: [mysql 07910] Re: バッチファイルからの起動<br>

</p>
</div>
<div class="body">
<pre>
A.K.I.と申します。

単純にVB実行時のカレントディレクトリの問題に見えるんですが・・・
test.phpをフルパスで指定したらどうなりますか？

#ここからMySQLとは関係ない話

たぶんperlの起動そのものは成功するので、test.php以外の(存在
しない)ファイル名を指定してもShellの戻り値は0以外が返ってく
るんじゃないかと。Shellは非同期で起動だけして後は知らない、
という関数なので、実行されたプログラムが正常終了かエラー終了
かは取れないですしね。

#まともにやるならAPIだけど、そもそもADOあたりでSQL発行した方
が楽な気が。。。

<span class="quote1">&gt;佐藤と申します。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;初めての投稿です。</span>
<span class="quote1">&gt;MYSQLの問題ではないかも知れませんが、御教授頂ければと思い投稿しました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;MYSQL実行環境は下記の通りです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;クライアント</span>
<span class="quote1">&gt;OS:WIN2000SP2</span>
<span class="quote1">&gt;ツール：VB6.0SP5</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;サーバー</span>
<span class="quote1">&gt;NT4.0SP6.0</span>
<span class="quote1">&gt;MYSQL VER4.0.12</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;ここで、PERLのDB更新用ファイル（クライアント側に存在）を、</span>
<span class="quote1">&gt;クライアントのＶＢプログラムからSHELL関数を使用して、起動すると</span>
<span class="quote1">&gt;うまくDBの更新ができません。実行前後でDB側は何もかわらず、</span>
<span class="quote1">&gt;エラーメッセージも表示されません。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;ＤＯＳ環境からこのPERLファイルを実行すると当然うまく更新のですが、</span>
<span class="quote1">&gt;プログラム側からは実行できないのでしょうか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;-------- PERLファイル TEST.PL</span>
<span class="quote1">&gt;use DBI;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$db = DBI-&gt;connect('DBI:mysql:temp:172.16.86.87','root','12345');</span>
<span class="quote1">&gt;$sth = $db-&gt;prepare(&quot;INSERT INTO MOI VALUES ('NULL','2003/05/23','19891','ASI3','RH7-</span>
<span class="quote1">&gt;1472-000000','RH7-1472 12345','2003/03/20','2400','2');&quot;);</span>
<span class="quote1">&gt;$sth-&gt;execute;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$sth = $db-&gt;prepare(&quot;SELECT * FROM MOI&quot;);</span>
<span class="quote1">&gt;$sth-&gt;execute;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$num_rows = $sth-&gt;rows;</span>
<span class="quote1">&gt;print &quot;$num_rows 件見つかりました。\n&quot;;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$sth-&gt;finish;</span>
<span class="quote1">&gt;$db-&gt;disconnect;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;--------- ＶＢ６．０ファイル</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;Private Sub Command1_Click()</span>
<span class="quote1">&gt;    Dim I As Integer</span>
<span class="quote1">&gt;    </span>
<span class="quote1">&gt;    I = Shell(&quot;c:\perl\bin\perl test.pl&quot;, 3)</span>
<span class="quote1">&gt;    MsgBox &quot;実行結果=&quot; &amp; I</span>
<span class="quote1">&gt;End Sub</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;※Ｉはプログラムのタスクコードで、きちんとエラー以外（０以外）の</span>
<span class="quote1">&gt;実行結果が代入されて返ってきます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;-------------</span>
<span class="quote1">&gt;Sato Hiroyuki</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>



</pre>
</div>
<p class="button"><a href="7909">[前]</a><a href="7911">[次]</a><a href="../list/7901-8000">[番号順一覧]</a><a href="../thread/7901-8000">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="7908">   7908 2003-06-17 12:19 [Sato Hiroyuki &lt;sato.] バッチファイルからの起動                </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7909">   7909 2003-06-17 12:25 ┣[&quot;TOYOSHIMA,Masayuki&quot;]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="7910">   7910 2003-06-17 12:35 ┗[A.K.I. &lt;aki@xxxxxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7911">   7911 2003-06-17 13:32 　┗[Sato Hiroyuki &lt;sato.]                                     </a></span>
</pre>
</body>
</html>
