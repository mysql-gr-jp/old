<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5835</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5834">[前]</a><a href="5836">[次]</a><a href="../list/5801-5900">[番号順一覧]</a><a href="../thread/5801-5900">[スレッド一覧]</a></p>
<p class="id">
mysql:5835
</p>
<div class="header">
<p>
From: Daiju Azuma &lt;Daiju Azuma &lt;daiju_azuma@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 22 Jul 2002 16:53:29 +0900<br>
Subject: [mysql 05835] Re: INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方<br>

</p>
</div>
<div class="body">
<pre>

On Mon, 22 Jul 2002 15:53:19 +0900
Sugiyama &lt;sugiyama@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; 　今の処理は、東さんが示したような処理をしているんですよ。</span>
<span class="quote1">&gt; 　やっぱり、一発じゃ無理そうですね。</span>
<span class="quote1">&gt; 　もう少し考えてみます。最悪は、テーブル構造を見直す必要が</span>
<span class="quote1">&gt; 　ありそうです。</span>

　では，データの挿入の前に bbsno の最大値に１を足した数字を
用意しておくというのはだめでしょうか？これなら，データ挿入に
関しては，１回で終了しますが。（SQLは２回実行していますが。）

　タイムラグがシビアなのか，SQLを簡潔に納めたいのか，良くわ
からないので，僕レベルではこれが限界。


&lt;%
	sql = &quot;select bbsno from BBS order by bbsno desc limit 1&quot;
	set rs = server.createobject(&quot;adodb.recordset&quot;)
	rs.open sql, conn


Dim Next_bbsno

Next_bbsno	= CInt(rs.fields(&quot;bbsno&quot;)) + 1

	sql = &quot;insert into BBS (######,refno) values(####,'&quot;&amp; Next_bbsno &amp;&quot;')&quot;
	set rs = server.createobject(&quot;adodb.recordset&quot;)
	rs.open sql, conn

%&gt;
 

-- 
神戸市教育委員会庶務課　情報企画係
　東　大樹　tel:078-322-5761 fax:078-322-6145
　Daiju Azuma &lt;daiju_azuma@xxxxxxxxxx&gt;
＞電子メールを使って電話代を節約しましょう。


</pre>
</div>
<p class="button"><a href="5834">[前]</a><a href="5836">[次]</a><a href="../list/5801-5900">[番号順一覧]</a><a href="../thread/5801-5900">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5807">   5807 2002-07-18 10:42 [Sugiyama &lt;sugiyama@x] INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方法</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5826">   5826 2002-07-22 13:58 ┗[Daiju Azuma &lt;daiju_a]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5831">   5831 2002-07-22 15:53 　┗[Sugiyama &lt;sugiyama@x] Re: INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方</a></span>
<span class="current">-&gt;&nbsp;<a href="5835">   5835 2002-07-22 16:53 　　┗[Daiju Azuma &lt;daiju_a]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5836">   5836 2002-07-22 19:50 　　　┣[小西恒紀 &lt;tkonishi@x]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5837">   5837 2002-07-22 20:26 　　　┃┣[&quot;K.Ono&quot; &lt;k-ono@xxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5838">   5838 2002-07-23 01:06 　　　┃┃┣[&quot;T.Konishi&quot; &lt;tkonish]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5842">   5842 2002-07-23 10:08 　　　┃┃┃┗[Sugiyama &lt;sugiyama@x]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5841">   5841 2002-07-23 10:07 　　　┃┃┗[Sugiyama &lt;sugiyama@x]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5840">   5840 2002-07-23 10:01 　　　┃┗[Sugiyama &lt;sugiyama@x]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5839">   5839 2002-07-23 09:59 　　　┗[Sugiyama &lt;sugiyama@x]                                 </a></span>
</pre>
</body>
</html>
