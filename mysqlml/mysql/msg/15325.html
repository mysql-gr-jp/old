<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15325</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15324.html">[前]</a><a href="15326.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15325
</p>
<div class="header">
<p>
From: Masuda &lt;Masuda &lt;masuken@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 3 Jun 2010 13:06:13 +0900<br>
Subject: [mysql 15325] Re: [mysql 15322] Re: フィールド数とレコード数のパフォーマンス差について<br>

</p>
</div>
<div class="body">
<pre>
ミヤタ 様,

返信が遅くなり申し訳ありません。増田です。

2010年6月2日12:35 Miyata Masaki &lt;catlover@xxxxxxxxxx&gt;:

<span class="quote1">&gt; いきなりざっくりと私なりの結論を申し上げますと、「分からない」となりますが、</span>
<span class="quote1">&gt; 仮の状況として設定されたユーザ10名の例で言えば、「大差ないでしょう」となります。</span>
<span class="quote1">&gt; ユーザ10名程度で業務系の処理を想定されていると思いますが、そうであれば</span>
<span class="quote1">&gt; パフォーマンス（※）は大した問題にはならないと思います。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ※パフォーマンスと一言で言われているのでそのまま使っていますが、</span>
<span class="quote1">&gt; 　パフォーマンスといっても、さまざまな要素があります。</span>
<span class="quote1">&gt;</span>
話を分かりやすくしようと思い、ユーザ10名等たとえをあげたのですが、
あくまでユーザは万単位を想定していて、
一か月単位で参加できるユーザが10名という意味でした。

というか、一か月というのも分かりづらく、これも本当に申し訳ないのですが、

本来は、一試合に参加できる人数が10~20名程度で、
一試合のなかで、5~10日ほど日にちが立つというものを作っております。

最初からこちらで説明すればよかったですよね。申し訳ないです。


<span class="quote1">&gt; ですが、テーブルの正規化という意味ではtable2の方が望ましく柔軟性も高いため、</span>
<span class="quote1">&gt; 問題なければtable2にしておく方が良いと思います。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ただ、処理が多少複雑になるとは思いますので、table1でも柔軟性やパフォーマンスに</span>
<span class="quote1">&gt; などに問題がないと分かっている場合には、別にtable1でも構いません。</span>
<span class="quote1">&gt; table1でパフォーマンス上不利になるのは、カラム数が増えるため、同時更新による</span>
<span class="quote1">&gt; ロックなどで更新性能などが落ちることなどです。</span>
<span class="quote1">&gt;</span>
一試合のうちに、5~10日ほどありますが、その日替わりで同時更新が入る程度で、
ユーザが何度もUPDATEできるようなテーブルではないので、今のところ性能的には問題ないように感じます。
（カラム数が多いと同時更新に気をつけたほうがよいのですね。勉強になります。）


<span class="quote2">&gt;&gt; ただし、アクションを2つ行えるのは3名しかいないため、残り7名にとっては無駄なフィールドがあって、</span>
<span class="quote2">&gt;&gt; あまり効率よくない感じがします。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 使用しないカラムはNULLにしておけば問題ないと思います。</span>
<span class="quote1">&gt;</span>
NULLでも特に問題ないんですね。NULLってなんかあると悪いような気もしていたのですが、
そうでもないんですかね。


<span class="quote2">&gt;&gt; ただし、フィールドに無駄はありませんし、WHERE句を使えばデータは取ってこれるので、</span>
<span class="quote2">&gt;&gt; 1レコードとしては見にくいですが、データを素早く取ってこれることが大事なので、</span>
<span class="quote2">&gt;&gt; こちらのほうがよいのかなと思っています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 厳密に言えば、データを素早く取ってくるという意味では、1行だけ取得すれば良いため、</span>
<span class="quote1">&gt; table1の方が優れています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; 一ヶ月目で、130ぐらいレコード数が増えます。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; これを1000ヶ月とか10000ヶ月になった場合、膨大なレコード数になり、パフォーマンスが落ちないか心配な面があります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; それ位の行数であれば、全く問題ないと思います。</span>
<span class="quote1">&gt; 想定されているコンピューターに相応のデータを入れて試される事をオススメ致します。</span>
<span class="quote1">&gt; MySQLやApacheのパフォーマンスに関する設定項目も多数ありますから、それらの設定でも</span>
<span class="quote1">&gt; パフォーマンスは大きく変わりますし、コンピューターのCPUやメモリなどによっても、</span>
<span class="quote1">&gt; パフォーマンスは大きく変わります。</span>
<span class="quote1">&gt;</span>
パフォーマンスに関してはおっしゃる通りですね。
my.confの設定でも変わってきますし、CPUやメモリによっても変わってくるというのは分かりますが、
同環境で、できるだけCPUに負荷をかけず、時間を短縮できるという我儘な願いをもっております。
ただ、I/O負荷になって、サーバ止まっても困るので、より綺麗なテーブル設計ということでもよいのかもしれません。

一か月のたとえが悪く申し訳ないです。
正確には試合単位なので、10000試合とか、もしかしたら50000試合ぐらいにもなるかもしれませんが、
いずれにしてもそれぐらいであればそこまで気にする行数ではないのですね。

万単位の行数で考えることなど今までなかったため、今回心配しておりました。



<span class="quote2">&gt;&gt; table1だと、</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; key | month | user_id | 1day_action1 | 2day_action1 .... 10day_action1</span>
<span class="quote3">&gt;&gt; | 1day_action2 | .... 10day_action2</span>
<span class="quote2">&gt;&gt;                  target</span>
<span class="quote2">&gt;&gt; として、アクションフィールドのデータにその行為のターゲットを入れればデータは取れるので、</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; すみません。上記の意味がよく分かりませんでした。</span>
<span class="quote1">&gt;</span>
1day_action1 | 2day_action2 |
target_id        | target_id

ということでした。分かりづらく申し訳ありません。



増田
-- 
mailto:masuken@xxxxxxxxxx

</pre>
</div>
<p class="button"><a href="15324.html">[前]</a><a href="15326.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15321.html">  15321 2010-06-02 10:17 [Masuda &lt;masuken@xxxx] フィールド数とレコード数のパフォーマンス差について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15322.html">  15322 2010-06-02 12:35 ┣[Miyata Masaki &lt;catlo]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="15325.html">  15325 2010-06-03 13:06 ┃┗[Masuda &lt;masuken@xxxx] Re: [mysql 15322] Re: フィールド数とレコード数のパフォーマンス差について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15323.html">@ 15323 2010-06-02 16:31 ┗[らっちょ らっちょ &lt;z]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15324.html">  15324 2010-06-02 18:57 　┣[岩崎　誠司 &lt;iwasaki_]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15327.html">  15327 2010-06-03 13:37 　┃┗[Masuda &lt;masuken@xxxx] Re: [mysql 15324] Re: フィールド数とレコード数のパフォーマンス差について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15326.html">  15326 2010-06-03 13:29 　┗[Masuda &lt;masuken@xxxx] Re: [mysql 15323] Re: フィールド数とレコード数のパフォーマンス差について</a></span>
</pre>
</body>
</html>
