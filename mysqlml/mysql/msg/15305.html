<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15305</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15304.html">[前]</a><a href="15306.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15305
</p>
<div class="header">
<p>
From: "Michiyoshi Buniu\(DreamLink\)" &lt;"Michiyoshi Buniu\(DreamLink\)" &lt;buniu@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 27 Apr 2010 12:44:11 +0900<br>
Subject: [mysql 15305] Re: 同じはずの環境で片方だけ文字化け<br>

</p>
</div>
<div class="body">
<pre>豊丹生と申します。

違ってたらすみません。
＆既にお試しであればすみません。

以下の内容だとBの環境でsql実行前に
set names utf8;
を実行すれば良いのではないでしょうか？

Michiyoshi Buniu

----- Original Message ----- 
From: "TAKENAKA, Akikazu" &lt;akikazu@xxxxxxxxxx&gt;
To: "ml" &lt;ml@xxxxxxxxxx&gt;
Sent: Monday, April 26, 2010 6:16 PM
Subject: <a href="15296.html">[mysql 15296]</a> 同じはずの環境で片方だけ文字化け


<span class="quote1">&gt; 神奈川の竹中と申します。お世話になります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ML #15248 とも一部重なるかと思い恐縮なのですが、どうしても解決できず困っています。</span>
<span class="quote1">&gt; また、もしかしたらPHPユーザ会MLで聞いた方が適切かもしれないのですが、問題の切り分けができていません。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 同一のPHPコード、同一のMySQLテーブルを使用して、2つの環境でテストを行っているのですが、片方だけ文字化けするという現象に困っています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 環境は下記の2ヶ所です。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 【A】レンタルサーバheteml。</span>
<span class="quote1">&gt; MySQLサーバ 5.0.82-community-log</span>
<span class="quote1">&gt; MySQLクライアント 4.0.25</span>
<span class="quote1">&gt; phpMyAdmin 2.11.2.2</span>
<span class="quote1">&gt; PHP 5.2.8</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 【B】手元のMacBook（Mac OS X 10.5.8）。</span>
<span class="quote1">&gt; MySQLサーバ 5.1.45</span>
<span class="quote1">&gt; MySQLクライアント 5.0.82</span>
<span class="quote1">&gt; phpMyAdmin 3.3.2</span>
<span class="quote1">&gt; PHP 5.2.12</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 上記のそれぞれの環境で、下記のテーブルをphpMyAdmin上で作成しました。</span>
<span class="quote1">&gt; 下記のコードは、テーブル作成後に SHOW CREATE TABLE を発行した結果で、環境Aと環境Bでまったく同一でした。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; CREATE TABLE `test` (</span>
<span class="quote1">&gt; `user_id` int(4) unsigned NOT NULL,</span>
<span class="quote1">&gt; `user_name` varchar(20) collate utf8_unicode_ci DEFAULT NULL,</span>
<span class="quote1">&gt; PRIMARY KEY  (`user_id`)</span>
<span class="quote1">&gt; ) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 続いて、それぞれの環境で、phpMyAdmin上でデータを挿入しました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; INSERT INTO test (`user_id`, `user_name`) VALUES (1, '竹中彰一');</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; phpMyAdmin上、およびターミナル上でデータを確認したところ、どちらの環境でも正常に登録されていることがわかりました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 次に、下記のPHPコードで接続テストを行いました。</span>
<span class="quote1">&gt; （シフトタブを全角スペースに置換しています）</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"</span>
<span class="quote1">&gt; "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>"&gt;</span>
<span class="quote1">&gt; &lt;html xmlns="<a href="http://www.w3.org/1999/xhtml">http://www.w3.org/1999/xhtml</a>" xml:lang="ja" lang="ja"&gt;</span>
<span class="quote1">&gt; &lt;head&gt;</span>
<span class="quote1">&gt; &lt;meta http-equiv="content-type" content="text/html; charset=utf-8" /&gt;</span>
<span class="quote1">&gt; &lt;title&gt;テスト&lt;/title&gt;</span>
<span class="quote1">&gt; &lt;/head&gt;</span>
<span class="quote1">&gt; &lt;body&gt;</span>
<span class="quote1">&gt; &lt;table&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;th&gt;ユーザID&lt;/th&gt;&lt;th&gt;名前&lt;/th&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;?php</span>
<span class="quote1">&gt; $con = mysql_connect($hostname, $userid, $passwd);</span>
<span class="quote1">&gt; if (!$con) {</span>
<span class="quote1">&gt; 　die('MySQLへ接続できませんでした' . mysql_error());</span>
<span class="quote1">&gt; }</span>
<span class="quote1">&gt; mysql_select_db($dbname);</span>
<span class="quote1">&gt; $ret = mysql_query("SELECT * FROM test");</span>
<span class="quote1">&gt; while ($val = mysql_fetch_array($ret)) {</span>
<span class="quote1">&gt; 　$user_id = (string)$val['user_id'];</span>
<span class="quote1">&gt; 　$user_name = $val['user_name'];</span>
<span class="quote1">&gt; 　print '&lt;tr&gt;&lt;td&gt;' . $user_id . '&lt;/td&gt;&lt;td&gt;' . $user_name . '&lt;/td&gt;&lt;/tr&gt;';</span>
<span class="quote1">&gt; }</span>
<span class="quote1">&gt; mysql_close($con);</span>
<span class="quote1">&gt; ?&gt;</span>
<span class="quote1">&gt; &lt;/table&gt;</span>
<span class="quote1">&gt; &lt;/body&gt;</span>
<span class="quote1">&gt; &lt;/html&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; このコードをFirefox 3.5.9で表示したところ、環境Aでは期待通り、下記の結果が返りました。</span>
<span class="quote1">&gt; （抜粋）</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; &lt;table&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;th&gt;ユーザID&lt;/th&gt;&lt;th&gt;名前&lt;/th&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;竹中彰一&lt;/td&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;/table&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; しかし、環境Bでは文字化けしてしまいました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; &lt;table&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;th&gt;ユーザID&lt;/th&gt;&lt;th&gt;名前&lt;/th&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;????&lt;/td&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;/table&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 問題がMySQL側とPHP側のどちらにあるのかわからず、糸口がつかめない状態で困っております。</span>
<span class="quote1">&gt; MacへのMySQLのインストールなどよくわからないままやったので、どこを調べればいいのかすらわからないのですが…</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 解決へのヒントや疑うべきポイントなど、ご教授いただければ幸いです。</span>
<span class="quote1">&gt; よろしくお願いいたします。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; -- </span>
<span class="quote1">&gt; equal1</span>
<span class="quote1">&gt; 竹中 彰一 (TAKENAKA, Akikazu)</span>
<span class="quote1">&gt; akikazu@xxxxxxxxxx | www.equal1.net</span>
<span class="quote1">&gt; Skype: equal1.at | iPhone: +81-90-8477-3901</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; </span>


</pre>
</div>
<p class="button"><a href="15304.html">[前]</a><a href="15306.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="15296.html">  15296 2010-04-26 18:16 ["TAKENAKA, Akikazu" ] 同じはずの環境で片方だけ文字化け        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15298.html">  15298 2010-04-26 21:31 ┣[Masaaki Matsuyama &lt;m]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15301.html">  15301 2010-04-27 10:27 ┃┗["TAKENAKA, Akikazu" ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15303.html">  15303 2010-04-27 10:37 ┃　┗[Masaaki Matsuyama &lt;m]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15304.html">  15304 2010-04-27 11:56 ┃　　┗["TAKENAKA, Akikazu" ]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15299.html">  15299 2010-04-26 21:42 ┣[Yuya Takeyama &lt;sign.]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15302.html">  15302 2010-04-27 10:32 ┃┗["TAKENAKA, Akikazu" ]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="15305.html">  15305 2010-04-27 12:44 ┗["Michiyoshi Buniu\(D]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15306.html">  15306 2010-04-27 13:19 　┗["TAKENAKA, Akikazu" ]                                     </a></span>
</pre>


</body></html>