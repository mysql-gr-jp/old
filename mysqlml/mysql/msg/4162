<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:4162</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="4161">[前]</a><a href="4163">[次]</a><a href="../list/4101-4200">[番号順一覧]</a><a href="../thread/4101-4200">[スレッド一覧]</a></p>
<p class="id">
mysql:4162
</p>
<div class="header">
<p>
From: &quot;tamuzin2&quot; &lt;&quot;tamuzin2&quot; &lt;tamuzin@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 9 Aug 2001 18:39:22 +0900<br>
Subject: [mysql 04162] 最新日時のデータのファイルを表示<br>

</p>
</div>
<div class="body">
<pre>
田中です

前にも似たような質問をしたのですが、結局まだ完璧に解決できなかったので申し訳
ございませんが質問させて下さい。

+------+------------+-------------------+
<span class="quote1">| bagou   | gazou　　        | time　                         |</span>
+------+------------+-------------------+
<span class="quote1">|          1|dezikame.jpg     |2001-08-04 02:17:00   |</span>
+------+------------+-------------------+
<span class="quote1">|          2|pasocon.jpg      |2001-08-05 15:30:00   |</span>
+------+------------+-------------------+
<span class="quote1">|          3|purintaa.jpg      |2001-08-08 12:50:00    |</span>
+------+------------+-------------------+
上記のようなデータベースがあって、その中から最新の日付のフィールド(gazou)の
データを表示させたい時はPerlでの記述はどのようにすればよいのでしょうか？
どなたかよろしければお教え下さい宜しくお願いします。

ちなみに下記の様にPerlで記述しましたがフィールド(gazou)に入っている画像デー
タが全て表示されてしまい、自分がやろうと思っている条件を絞り込んでの表示は成
功しませんでした。

#!perl

use DBI;
use Cwd;

my($dns) = &quot;DBI:mysql:database:localhost&quot;;
my($username) = &quot;root&quot;;
my($password) = &quot;aaaa&quot;;
my($dbh,$sth);
my(@ary);

$dbh = DBI -&gt; connect ($dns,$username,$password) or &amp;Error(&quot;データベースへア
クセスできません。&quot;);

$sth = $dbh-&gt;prepare(&quot;select gazou from table where time &lt; now()&quot;);

$sth -&gt; execute() or &amp;Error(&quot;select gazou from table where time &lt; now()を実
行できません。&quot;);

print &quot;content-type: text/html\; charset=shift_jis\n\n&quot;;
print&lt;&lt;&quot;__HTML__&quot;;
&lt;html&gt;&lt;head&gt;&lt;title&gt;gazou&lt;/title&gt;&lt;/head&gt;
&lt;body text=&quot;#44444&quot; bgcolor=&quot;#ffffff&quot;&gt;
__HTML__

while(@ary = $sth -&gt; fetchrow_array()){
print &quot;&lt;img src=\&quot;../tmp/$ary[0]\&quot;&gt;&quot;;
}

print&lt;&lt;&quot;__HTML__&quot;;
&lt;/body&gt;
&lt;/html&gt;
__HTML__

$sth -&gt; finish();
$dbh -&gt; disconnect();
exit;

sub Error{
#print &quot;content-type: text/html\n\n&quot;;
print $_[0];
print qq(&lt;br&gt;&lt;a href=&quot;javascript:history.back(1)&quot;&gt;戻る&lt;/a&gt;);
exit;
}


</pre>
</div>
<p class="button"><a href="4161">[前]</a><a href="4163">[次]</a><a href="../list/4101-4200">[番号順一覧]</a><a href="../thread/4101-4200">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="4143">   4143 2001-08-05 18:48 [&quot;tamuzin2&quot; &lt;tamuzin@] datetime を使用しての比較               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4144">   4144 2001-08-05 19:29 ┣[Okamoto RYO &lt;ryo@xxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4145">   4145 2001-08-05 21:02 ┃┣[&lt;endo_t@xxxxxxxxxx&gt; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4146">   4146 2001-08-05 22:10 ┃┗[&quot;tamuzin2&quot; &lt;tamuzin@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4147">   4147 2001-08-05 22:13 ┃　┗[Tatsuhiko Miyagawa &lt;]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4148">   4148 2001-08-05 22:27 ┃　　┗[&quot;tamuzin2&quot; &lt;tamuzin@] Re: datetime を使用しての比較【解決】</a></span>
<span class="current">-&gt;&nbsp;<a href="4162">   4162 2001-08-09 18:39 ┗[&quot;tamuzin2&quot; &lt;tamuzin@] 最新日時のデータのファイルを表示      </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4163">   4163 2001-08-10 07:41 　┗[とみたまさひろ &lt;tomm]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4164">   4164 2001-08-10 10:46 　　┗[&quot;tamuzin2&quot; &lt;tamuzin@] Re: 最新日時のデータのファイルを表示【解決】</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4165">   4165 2001-08-10 11:22 　　　┗[&lt;endo_t@xxxxxxxxxx&gt; ]                                 </a></span>
</pre>
</body>
</html>
