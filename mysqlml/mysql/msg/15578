<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15578</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15577">[前]</a><a href="15579">[次]</a><a href="../list/15501-15600">[番号順一覧]</a><a href="../thread/15501-15600">[スレッド一覧]</a></p>
<p class="id">
mysql:15578
</p>
<div class="header">
<p>
From: 岩崎　誠司 &lt;岩崎　誠司 &lt;iwasaki_ryuqseed_6130@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 28 Apr 2011 14:34:26 +0900 (JST)<br>
Subject: [mysql 15578] 最新 10 件の内でベスト 5 の合計を取りたい<br>

</p>
</div>
<div class="body">
<pre>
岩崎と申します。
  いつも皆様MLを参考にさせていただいてます。
   
  ちょっと皆様のお知恵を拝借したいと思い投稿しました。
   
  表題にもありますが、該当する「num」の一定期間の最新のデータ
  10件のうち、diffのベスト5の合計を取りたいので以下のようなクエリで
取得しましたが、SELECTを何回も重ねるので
スッキリせずに分かりにくいクエリになっています。
他に方法はないでしょうか、よろしくお願いします。
   
  ちなみにベスト5のデータを取るのでしたら、「AS d」の()内の
クエリで取れます。
   
  SELECT SUM(di) 
FROM
(SELECT di FROM 
 (SELECT diff AS di 
  FROM hd  
  WHERE num = 1
   AND day BETWEEN '2010-04-01' AND '2011-03-31'
  ORDER BY day DESC  LIMIT 10 
 ) AS s 
 ORDER BY di 
 LIMIT 5
) AS d
  
テーブル作成文
CREATE TABLE `hd` (
    `id` int(11) NOT NULL AUTO_INCREMENT,
    `num` int(11) NOT NULL,
    `day` date DEFAULT NULL,
    `diff` int(11) NOT NULL,
    PRIMARY KEY (`id`)
  ) ENGINE=MyISAM 
   
  環境
OS Windows7 professional SP1
MySQL Version 5.1.16

 


</pre>
</div>
<div class="attach">
<h3 class="attachtitle">添付ファイル</h3>
<ul>
<li><a href="http://www.mysql.gr.jp/mysqlml/mysql/msg/15578/0/"> [text/html]</a>
</ul>
</div>
<p class="button"><a href="15577">[前]</a><a href="15579">[次]</a><a href="../list/15501-15600">[番号順一覧]</a><a href="../thread/15501-15600">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="15578">@ 15578 2011-04-28 14:34 [岩崎　誠司 &lt;iwasaki_] 最新 10 件の内でベスト 5 の合計を取りたい</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15579">  15579 2011-04-28 15:27 ┗[Mikiya Okuno &lt;mikiya]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15580">  15580 2011-04-28 16:58 　┗[岩崎　誠司 &lt;iwasaki_]                                     </a></span>
</pre>
</body>
</html>
