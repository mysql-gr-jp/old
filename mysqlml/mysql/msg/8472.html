<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8472</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="8471.html">[前]</a><a href="8473.html">[次]</a><a href="../list/8401-8500.html">[番号順一覧]</a><a href="../thread/8401-8500.html">[スレッド一覧]</a></p>
<p class="id">
mysql:8472
</p>
<div class="header">
<p>
From: &quot;HIROSE, Masaaki&quot; &lt;&quot;HIROSE, Masaaki&quot; &lt;hirose31@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 10 Dec 2003 19:22:22 +0900<br>
Subject: [mysql 08472] Re: innoDB の行排他ロックについて<br>

</p>
</div>
<div class="body">
<pre>
ひろせです

on &quot;<a href="08469.html">[mysql 08469]</a> Re: innoDB の行排他ロックについて&quot;
   &lt;yf1wu95dlyc.wl%hirose31@xxxxxxxxxx&gt;
at Wed, 10 Dec 2003 19:08:27 +0900
   ひ＠RIM wrote:

<span class="quote3">&gt; &gt; &gt; MySQLで大量データを持つ表に対しある処理で一部レコードを更新</span>
<span class="quote3">&gt; &gt; &gt; しながら別の処理で他のレコードを更新することが実現可能か</span>
<span class="quote3">&gt; &gt; &gt; どうかの調査を行っており、Oracleでの開発を行った経験から</span>
<span class="quote3">&gt; &gt; &gt; 双方の処理で行の排他ロックを掛ける必要があると思っています。</span>
<span class="quote3">&gt; &gt; &gt; </span>
<span class="quote3">&gt; &gt; &gt; しかし、以下の図の様に選択した行以外の行排他ロックを行おう</span>
<span class="quote3">&gt; &gt; &gt; としてもロック待ちが発生してしまいます。</span>
<span class="quote3">&gt; &gt; &gt; テーブルロックがかかっているかの様です。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; テーブルはどのようにして作成したのでしょうか。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; 手元の環境(Linux + MySQL 4.0.15)では、次のように作成したテーブルで期待</span>
<span class="quote2">&gt; &gt; 通りに動きました。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; create table a (keyno int, dat1 int, dat2 int, unique (keyno)) type=innodb;</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; RHL7.3 に MySQL AB 提供の rpm をインストールした</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; mysql&gt; select version();</span>
<span class="quote1">&gt; +---------------------+</span>
<span class="quote2">&gt; | version()           |</span>
<span class="quote1">&gt; +---------------------+</span>
<span class="quote2">&gt; | 4.0.16-standard-log |</span>
<span class="quote1">&gt; +---------------------+</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; なマシンで</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; mysql&gt; show create table a\G</span>
<span class="quote1">&gt; *************************** 1. row ***************************</span>
<span class="quote1">&gt;        Table: a</span>
<span class="quote1">&gt; Create Table: CREATE TABLE `a` (</span>
<span class="quote1">&gt;   `keyno` int(11) default NULL,</span>
<span class="quote1">&gt;   `dat1` int(11) default NULL,</span>
<span class="quote1">&gt;   `dat2` int(11) default NULL</span>
<span class="quote1">&gt; ) TYPE=InnoDB</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; なテーブルで試してみましたが、私もとみたさんと同様、期待通りに動きまし</span>
<span class="quote1">&gt; た。</span>
(snip)

すみません、ウソでした。m(_ _)m
keyno を primary key にしないと期待した動作をしませんでした。

-- 
ひろせ

</pre>
</div>
<p class="button"><a href="8471.html">[前]</a><a href="8473.html">[次]</a><a href="../list/8401-8500.html">[番号順一覧]</a><a href="../thread/8401-8500.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="8466.html">   8466 2003-12-10 14:40 [&quot;江口&quot; &lt;eguchi@xxxxx] innoDB の行排他ロックについて           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8467.html">   8467 2003-12-10 18:28 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8468.html">   8468 2003-12-10 18:58 　┣[&quot;江口&quot; &lt;eguchi@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8471.html">   8471 2003-12-10 19:10 　┃┗[&quot;江口&quot; &lt;eguchi@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8469.html">   8469 2003-12-10 19:08 　┗[&quot;HIROSE, Masaaki&quot; &lt;h]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="8472.html">   8472 2003-12-10 19:22 　　┣[&quot;HIROSE, Masaaki&quot; &lt;h]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8483.html">   8483 2003-12-11 15:28 　　┗[&quot;江口&quot; &lt;eguchi@xxxxx]                                   </a></span>
</pre>
</body>
</html>
