<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:9255</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="9254.html">[前]</a><a href="9256.html">[次]</a><a href="../list/9201-9300.html">[番号順一覧]</a><a href="../thread/9201-9300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:9255
</p>
<div class="header">
<p>
From: ML account &lt;ML account &lt;ml@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 22 Apr 2004 01:42:00 +0900<br>
Subject: [mysql 09255] Re: auto_increment  で次番号を確認したい。<br>

</p>
</div>
<div class="body">
<pre>
　こんにちは。

&quot;KATAYOSE hakuo&quot; &lt;katayose@xxxxxxxxxx&gt;さんの
&lt;005c01c427b4$01fb4ee0$937ba8c0@hideko&gt;
&quot;<a href="09254.html">[mysql 09254]</a> Re: auto_increment で次番号を確認したい。&quot;


　引用の順番を入れ替えます。

<span class="quote1">&gt; 「エラーが戻って来なければよし」とできる時もあるとは思います。</span>
<span class="quote1">&gt; しかし、“alter table auto_increment=”を実行したかどうか不確かな</span>
<span class="quote1">&gt; 場合が往々にしてありますよね。こんな場合、次に発生するシーケ</span>
<span class="quote1">&gt; ンスをみれば、alterコマンドを発行したかを確認できます。</span>

<span class="quote1">&gt; 松枝さんのおっしゃる通り、“alter table auto_increment=”を実行したあと</span>
<span class="quote1">&gt; 年度替りだけを確認するのだったら、エラーなしでOKとしてよいと思います。</span>

　今回はモロにこのケースなので、“alter table auto_increment=”の確認に
意味は全く無い、と思いますね。

　“alter table auto_increment=”をやったかどうか分からないケースはまた
話は別でしょう。ですがが、「alterコマンドを発行したかを確認する事」は、
理論的にはあり得ても、実際にあったら「何かなぁ」な事柄だと思いますよ。

　“alter table auto_increment=”の実行は年次処理の一部ですよね。年次処理
が行われたかどうかは、確実に、直接的に、把握されて然るべきものだと思いま
す。それが人的か機構的かは別にしても、です。それが定かでないとは、ちょっ
と困りものでしょう。

　更に、テーブルにレコードを挿入した時のauto_incrementな値を取得する、こ
れが年次処理が行われたかどうかを『確実に直接的に』把握する方法とは、ボク
なら言わないと思います。確実で直接的なやり方が別にあるでしょう。


<span class="quote1">&gt; 実は伝票入力のプログラムをCOBOLで作った時、これと同様なことをしています。</span>
<span class="quote1">&gt; 次に発生するシーケンスを常に入力画面に表示して欲しいと要求されたのです。</span>
<span class="quote1">&gt; これって意外と伝票入力する人には役立つ機能です。</span>

　シングルユーザ、シングルタスクのシステムならそれでも良いでしょう。です
が、今回のケースはPHPを使っているシステムですよね。つまり、Webベースのシ
ステムと類推出来ます。

　Webベースのシステムは、基本的にマルチユーザ、マルチタスクなシステムで
す。マルチユーザ、マルチタスクなシステムでは、テーブルをロックするとか、
トランザクションを使うとか、連番に関しては Oracle等のシーケンスや MySQL
でも可能なそれ類似の仕組みを使うとかの保護措置を取らない限り、 DBから取
って来た値を書き戻すなんて事は禁じ手、非常に危険ではないでしょうか。一般
論としては、ですが。

　当世流のWebベースシステム、あるいは大型を使ってのマルチユーザベースの
システムでの伝票入力で伝票番号を出力するなら、何らかの方法を使ってシング
ルユーザ、シングルタスク化するか、仮発番の機構を使うか等の方策で、てマル
チユーザ、マルチタスク環境でも破綻しない環境を整えるがオーソドックスな手
法でしょう。そう単純では無いと思います。


<span class="quote1">&gt; 余計なコメントでした。</span>

　MySQLを使おうがOracleその他を使おうが、システムの設計はこういう点をク
リアにして行く作業は必須と思いますよ。その意味ではこの様な意見交換は有意
義だとボクは思いますけれど。受け入れられるかどうかは別問題ですね。



　　　　松枝知直　　　　&lt;tomom@xxxxxxxxxx&gt;
　　　　　　　　　　　　<a href="http://www.argus.ne.jp/~tomom/">http://www.argus.ne.jp/~tomom/</a>



</pre>
</div>
<p class="button"><a href="9254.html">[前]</a><a href="9256.html">[次]</a><a href="../list/9201-9300.html">[番号順一覧]</a><a href="../thread/9201-9300.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="9239.html">   9239 2004-04-20 18:45 [高橋政利 &lt;takahashi@] auto_incrementで次番号を確認したい。    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9240.html">   9240 2004-04-20 23:29 ┣[Shinya Kawaji &lt;kawaj]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9245.html">   9245 2004-04-21 09:00 ┃┗[高橋政利 &lt;takahashi@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9248.html">   9248 2004-04-21 10:12 ┃　┗[Shinya Kawaji &lt;kawaj]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9250.html">   9250 2004-04-21 11:20 ┃　　┗[ML account &lt;ml@xxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9246.html">   9246 2004-04-21 09:15 ┣[&quot;片寄白王&quot; &lt;katayose]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9251.html">   9251 2004-04-21 17:39 ┃┗[川合孝典 &lt;gcd00051@x]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9252.html">   9252 2004-04-21 18:02 ┃　┣[&quot;山本　瑞己&quot; &lt;mizuki]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9253.html">   9253 2004-04-21 18:53 ┃　┗[ML account &lt;ml@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9254.html">   9254 2004-04-22 00:19 ┃　　┗[&quot;KATAYOSE hakuo&quot; &lt;ka]                                 </a></span>
<span class="current">-&gt;&nbsp;<a href="9255.html">   9255 2004-04-22 01:42 ┃　　　┗[ML account &lt;ml@xxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9256.html">   9256 2004-04-22 09:02 ┃　　　　┗[&quot;片寄白王&quot; &lt;katayose]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9258.html">   9258 2004-04-22 09:36 ┃　　　　　┗[高橋政利 &lt;takahashi@]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9265.html">   9265 2004-04-22 11:44 ┃　　　　　　┗[ML account &lt;ml@xxxxx]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9249.html">   9249 2004-04-21 10:56 ┣[Seiji Tateyama &lt;tate]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9257.html">   9257 2004-04-22 09:07 ┣[高橋政利 &lt;takahashi@]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9264.html">   9264 2004-04-22 11:44 ┃┗[ML account &lt;ml@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9277.html">   9277 2004-04-23 00:29 ┗[Kenji Irie &lt;kenji@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9279.html">   9279 2004-04-23 08:01 　┗[高橋政利 &lt;takahashi@]                                     </a></span>
</pre>
</body>
</html>
