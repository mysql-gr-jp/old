<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13374</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13373.html">[前]</a><a href="13375.html">[次]</a><a href="../list/13301-13400.html">[番号順一覧]</a><a href="../thread/13301-13400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13374
</p>
<div class="header">
<p>
From: &quot;Yoshio Kawano&quot; &lt;&quot;Yoshio Kawano&quot; &lt;kawano@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 21 Sep 2006 11:21:13 +0900<br>
Subject: [mysql 13374] Re: mysqlが起動しない（4.0.26⇒5.0.24a）<br>

</p>
</div>
<div class="body">
<pre>
お世話になっております。
ｙｋａｗａです。

かなりハマッている今日この頃です。

結局のところ、4.0.26でＤＢのバックアップを取得し、それを5.0.24aにインポート
する事にしました。

しかし、インポートした時に下記のエラーが出てしまい、途中で止まってしまいま
す。
何か良い方法は無いでしょうか？

◆バックアップを取った時のコマンド
    $mysqldump -d --no-data db_name &gt; db_name.schema
    $mysqldump -t db_name &gt; db_name.insert

◆インポートした時のコマンド
    $mysql -u xxx db_name　&lt; db_name.schema　←これは成功
    $mysql -u xxx db_name　&lt; db_name.insert　←失敗
    エラー内容は、
        ERROR 1062(23000) at line 367：Duplicate entry 'ｘｘｘｘｘ'　fro key
1

◎キーに対して同じ値を登録しようとしているので失敗していると思われる。
（mysqldumpの素のデータなのに、何故？）
    そこで、二重登録が発生したら無視する様な指定で実行すれば良いかと思ったの
ですが
    mysqlコマンドに、ignoreオプションが無い。『-i』は、あるが、これは少し意
味合いが違うみたい。

    しょうがないので、mysqlimportを使ってみた。　←これを使う事が有っている
のか解らず。
    しかし、結果はダメでした。
        mysqlimport：Error:Table　'db_name.db_name' doesn't　exist when
using table：　db_name


すませんが、皆様のお力を貸してください。

以上、宜しくお願い致します。
  ----- Original Message ----- 
  From: Yoshio Kawano
  To: ml@xxxxxxxxxx
  Sent: Wednesday, September 20, 2006 6:28 PM
  Subject: <a href="13371.html">[mysql 13371]</a> mysqlが起動しない（4.0.26⇒5.0.24a）


  お世話になっております。
  ykawaです。（OS=Linux）

  mySQLを4.0.26⇒5.0.24aにUPして、ｍｙSQLを起動しているのですが
  失敗に終わってしまいます。

  お忙しいところ誠に申し訳けありませんが、ご教示をお願い致します。

  -&lt;/var/localhost.localdomain.errのログ&gt;-------------------------------
  060920 17:39:08  mysqld started
  060920 17:39:09  InnoDB: Started; log sequence number 8 534940131
  060920 17:39:09 [Note] Recovering after a crash using mysql-bin
  060920 17:39:09 [Note] Starting crash recovery...
  060920 17:39:09 [Note] Crash recovery finished.
  060920 17:39:09 [Warning] './mysql/host' had no or invalid character set,
and default character set is multi-byte, so character column sizes may have
changed
  060920 17:39:09 [Warning] './mysql/user' had no or invalid character set,
and default character set is multi-byte, so character column sizes may have
changed
  060920 17:39:09 [Warning] './mysql/db' had no or invalid character set,
and default character set is multi-byte, so character column sizes may have
changed
  060920 17:39:09 [ERROR] Fatal error: mysql.user table is damaged or in
unsupported 3.20 format.
  060920 17:39:09  mysqld ended
  -------------------------------------------------------------

  ※：自分なりに調べた結果、「下記のサイトに書かれている事を実行すれば宜しい
のかな」と、思いましたが、英語が苦手であり、実行するのに躊躇しています。
      <a href="http://grebowiec.net/2006/08/10/131/">http://grebowiec.net/2006/08/10/131/</a>
      ここでは、下記のコマンドを実行しろと、言っているようですが、
      一時的な対処なのか（毎回、ｍｙSQLを起動する度に、下記のコマンドを実施
する必要があるのか？）
      恒久的な対処なのか不明です。
  -&lt;サイトに掲載されているコマンドを抜粋&gt;------------------------------
  mysqld_safe --skip-grant-tables --user=root &amp;
  mysql_fix_privilege_tables
  pkill mysqld
  /etc/init.d/mysqld restart
  -------------------------------------------------------------





</pre>
</div>
<div class="attach">
<h3 class="attachtitle">添付ファイル</h3>
<ul>
<li><a href="13374/0/index.html"> [text/html]</a>
</ul>
</div>
<p class="button"><a href="13373.html">[前]</a><a href="13375.html">[次]</a><a href="../list/13301-13400.html">[番号順一覧]</a><a href="../thread/13301-13400.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="13371.html">@ 13371 2006-09-20 18:28 [&quot;Yoshio Kawano&quot; &lt;kaw] mysqlが起動しない（4.0.26⇒5.0.24a）    </a></span>
<span class="current">-&gt;&nbsp;<a href="13374.html">@ 13374 2006-09-21 11:21 ┗[&quot;Yoshio Kawano&quot; &lt;kaw]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13375.html">  13375 2006-09-21 12:00 　┗[早間 &lt;hayama@xxxxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13382.html">  13382 2006-09-28 23:09 　　┗[&quot;Yoshio Kawano&quot; &lt;kaw]                                   </a></span>
</pre>
</body>
</html>
