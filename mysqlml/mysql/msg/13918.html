<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13918</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13917.html">[前]</a><a href="13919.html">[次]</a><a href="../list/13901-14000.html">[番号順一覧]</a><a href="../thread/13901-14000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13918
</p>
<div class="header">
<p>
From: mailist &lt;mailist &lt;mailist@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 25 Apr 2007 22:37:19 +0900<br>
Subject: [mysql 13918] Re: TRUNCATEで掛け算<br>

</p>
</div>
<div class="body">
<pre>
立松さん、
お教え戴いたリンクで調べたところ、次のような説明がありました。
まさにこのことが起きているようです。↓
<span class="quote1">&gt;注意: 小数は通常、正確な数値としてではなく、倍精度の値としてコンピュー</span>
<span class="quote1">&gt;タに格納されるため、次のようなおかしな結果が出ることがある。 </span>

<span class="quote1">&gt;SELECT TRUNCATE(10.28*100,0);</span>
       -&gt; 1027
<span class="quote1">&gt;これは、10.28 が実際には 10.2799999999999999 のような値として格納される</span>
<span class="quote1">&gt;ことによって発生する。</span>


KEN公さん、
<span class="quote1">&gt;tdiscountのデータ型は、float等にしていませんか？</span>
MySQL 4.1で、priceをint、tdiscountをdec(3,2)でやって4160.999と誤差が生じ
ました。どうしてだかわかりません。NUMERIC型にするなどテストしてみます。

------------------------------------------------------------
<span class="quote2">&gt;&gt;鈴木健です。</span>
<span class="quote2">&gt;&gt;MySQLで在庫管理をしていますが、TRUNCATEを使うと掛け算が正しくなりません。</span>
<span class="quote2">&gt;&gt;どうしてでしょうか？</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;たとえば、priceが4380、tdiscountが0.95であるとして、</span>
<span class="quote2">&gt;&gt;SELECT (price * tdiscount)</span>
<span class="quote2">&gt;&gt;とすると、値は4161と正しいのですが、</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;SELECT TRUNCATE((price * tdiscount),3)</span>
<span class="quote2">&gt;&gt;とすると、4160.999となります。</span>

</pre>
</div>
<p class="button"><a href="13917.html">[前]</a><a href="13919.html">[次]</a><a href="../list/13901-14000.html">[番号順一覧]</a><a href="../thread/13901-14000.html">[スレッド一覧]</a></p>
</body>
</html>
