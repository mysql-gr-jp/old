<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:7680</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="7679">[前]</a><a href="7681">[次]</a><a href="../list/7601-7700">[番号順一覧]</a><a href="../thread/7601-7700">[スレッド一覧]</a></p>
<p class="id">
mysql:7680
</p>
<div class="header">
<p>
From: とみたまさひろ &lt;とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;&gt;<br>
Date: Sat, 10 May 2003 12:14:02 +0900<br>
Subject: [mysql 07680] Re: 4 つのテーブルを left join するには（長文）<br>

</p>
</div>
<div class="body">
<pre>
とみたです。

On Fri, 09 May 2003 19:46:06 +0900
yuji koga &lt;koga-y@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; ここで、伝言板の管理者の名前も出そうとして苦しんでいます。</span>
<span class="quote1">&gt; 期待している結果は次です。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; thrd_id thrd_ttl usr_lgnm アクセス数 書込人数 最終更新日時</span>
<span class="quote1">&gt; ------+-------+---------+--------+------+--------</span>
<span class="quote1">&gt; 2          車BBS     hoge           3             2           （日時・略）</span>
<span class="quote1">&gt; 1          風景BBS  koga           0             0           ----</span>
<span class="quote1">&gt; 　　　　　　・</span>
<span class="quote1">&gt; 　　　　　　・</span>
<span class="quote1">&gt; 　　　　　　・</span>
<span class="quote1">&gt; 　　　（最終更新日時順）</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ここで次のようなSQLを打ちました。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; select </span>
<span class="quote1">&gt; thrd_tbl.thrd_id,</span>
<span class="quote1">&gt; thrd_tbl.thrd_ttl,</span>
<span class="quote1">&gt; usr_tbl.usr_lgnm,</span>
<span class="quote1">&gt; count(distinct acc_tbl.acc_id),</span>
<span class="quote1">&gt; count(distinct file_tbl.usr_id),</span>
<span class="quote1">&gt; max(file_tbl.file_datetime)</span>
<span class="quote1">&gt; from thrd_tbl </span>
<span class="quote1">&gt; left join acc_tbl using(thrd_id)</span>
<span class="quote1">&gt; left join file_tbl using(thrd_id)</span>
<span class="quote1">&gt; left join usr_tbl using(usr_id)</span>
<span class="quote1">&gt; group by thrd_tbl.thrd_id</span>
<span class="quote1">&gt; order by 'max(file_tbl.file_datetime)' desc</span>

using じゃなくて on を使ってみてはいかがでしょうか。

select 
thrd_tbl.thrd_id,
thrd_tbl.thrd_ttl,
usr_tbl.usr_lgnm,
count(distinct acc_tbl.acc_id),
count(distinct file_tbl.usr_id),
max(file_tbl.file_datetime)
from thrd_tbl 
left join acc_tbl using(thrd_id)
left join file_tbl using(thrd_id)
left join usr_tbl on thrd_tbl.usr_id=usr_tbl.usr_id
group by thrd_tbl.thrd_id
order by 'max(file_tbl.file_datetime)' desc

-- 
とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;
日本MySQLユーザ会 <a href="../../../index.html">http://www.mysql.gr.jp</a>

</pre>
</div>
<p class="button"><a href="7679">[前]</a><a href="7681">[次]</a><a href="../list/7601-7700">[番号順一覧]</a><a href="../thread/7601-7700">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="7677">   7677 2003-05-09 19:46 [yuji koga &lt;koga-y@xx] 4 つのテーブルを left join するには（長文）</a></span>
<span class="current">-&gt;&nbsp;<a href="7680">   7680 2003-05-10 12:14 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7681">   7681 2003-05-10 16:16 　┗[yuji koga &lt;koga-y@xx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7682">   7682 2003-05-10 17:48 　　┗[とみたまさひろ &lt;tomm]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7683">   7683 2003-05-10 20:41 　　　┗[yuji koga &lt;koga-y@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7685">   7685 2003-05-12 17:35 　　　　┗[Hiroshi Honda &lt;honda] MySQL で多言語使用            </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7692">   7692 2003-05-13 15:36 　　　　　┗[Joel Rees &lt;joel@xxxx]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7698">   7698 2003-05-13 21:50 　　　　　　┗[tateyan &lt;tateyan@xxx]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7699">   7699 2003-05-14 08:31 　　　　　　　┣[Hiroshi Honda &lt;honda]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7719">   7719 2003-05-14 23:18 　　　　　　　┃┗[tateyan &lt;tateyan@xxx]                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7712">   7712 2003-05-14 19:11 　　　　　　　┗[Joel Rees &lt;joel@xxxx]                         </a></span>
</pre>
</body>
</html>
