<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15566</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15565">[前]</a><a href="15567">[次]</a><a href="../list/15501-15600">[番号順一覧]</a><a href="../thread/15501-15600">[スレッド一覧]</a></p>
<p class="id">
mysql:15566
</p>
<div class="header">
<p>
From: &lt;mysql@xxxxxxxxxx&gt;<br>
Date: Thu, 07 Apr 2011 13:01:19 +0900<br>
Subject: [mysql 15566] Re: MySQLエラーコード「159」について<br>

</p>
</div>
<div class="body">
<pre>
hayaseさん、
ご連絡ありがとうございます。

＞ちなみに、Version情報やPlatform等が書いてあると
＞答えやすくなるのは古今東西共通していると思います。
＞また、該当テーブルを作成したcreate文もあったら良いですね。
失礼しました。環境情報は以下のとおりです。

■環境
CentOS:5.5 + MySQL:5.1.50

■テーブル作成クエリ
CREATE TABLE schema01.table01 (
  col01 int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '******',
  col02 int(10) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col03 tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col04 smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col05 tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col06 int(10) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col07 smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col08 int(10) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col09 smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col10 smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col11 smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col12 tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col13 tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col14 tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '******',
  col15 datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '******',
  col16 timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '******',
  PRIMARY KEY (col01),
  UNIQUE KEY key1 (col02,col03),
  KEY key2 (col05),
) ENGINE=InnoDB AUTO_INCREMENT=****** DEFAULT CHARSET=utf8 COMMENT='******'
;

■実行クエリ
ALTER TABLE table ADD INDEX key3 (col05, col12, col14, col16);


＞問題無いというのは、
＞?　エラーは出たが正常に実行された（INDEXが正しく作られた）
＞?　作成しなくてもよいINDEXだった
エラーは出ましたが、正常に実行されてINDEXが作成されました。


＞なんとなく環境の問題のような気がしますが・・・
＞お役に立てなくて申し訳ありません。
確かに再現性はないので、環境もしくは何かしらのタイミングのような気がしています。

お気づきの点がありましたら、ご連絡お願いします。

以上、宜しくお願いします。


On Thu, 07 Apr 2011 12:38:33 +0900
Takeshi Hayase &lt;linus@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; 初めまして。</span>
<span class="quote1">&gt; hayaseと申します。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 初めて見るエラーなので調べてみましたが、わかりませんでした。</span>
<span class="quote1">&gt; なお、私の方で実行した際には、エラーは出ませんでした。</span>
<span class="quote1">&gt; 当方の環境　⇒　CentOS5.5+MySQL5.1.53</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ちなみに、Version情報やPlatform等が書いてあると</span>
<span class="quote1">&gt; 答えやすくなるのは古今東西共通していると思います。</span>
<span class="quote1">&gt; また、該当テーブルを作成したcreate文もあったら良いですね。</span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt; &gt; 動作確認をしたところ、特に問題はないのですが、</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 問題無いというのは、</span>
<span class="quote1">&gt; ?　エラーは出たが正常に実行された（INDEXが正しく作られた）</span>
<span class="quote1">&gt; ?　作成しなくてもよいINDEXだった</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; どちらでしょう？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; なんとなく環境の問題のような気がしますが・・・</span>
<span class="quote1">&gt; お役に立てなくて申し訳ありません。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; (2011/04/07 11:54), mysql@xxxxxxxxxx wrote:</span>
<span class="quote2">&gt; &gt; カワバタと申します。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; Innodbのテーブルに対してインデックスを追加したら、</span>
<span class="quote2">&gt; &gt; 以下のエラーが出力されました。</span>
<span class="quote2">&gt; &gt; 動作確認をしたところ、特に問題はないのですが、</span>
<span class="quote2">&gt; &gt; どのような原因で以下のエラーが出力されるのか</span>
<span class="quote2">&gt; &gt; ご存じの方がいらっしゃいましたらご教授お願いします。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; ■実行クエリ</span>
<span class="quote2">&gt; &gt; ALTER TABLE table ADD INDEX key1 (col1, col2, col3, col4);</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; ■エラーメッセージ</span>
<span class="quote2">&gt; &gt; [ERROR] Got error 159 when reading table './schema/table'</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; ■perror</span>
<span class="quote2">&gt; &gt; MySQL error code 159: The table changed in storage engine</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; 以上、宜しくお願いします。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; </span>
<span class="quote1">&gt; </span>

</pre>
</div>
<p class="button"><a href="15565">[前]</a><a href="15567">[次]</a><a href="../list/15501-15600">[番号順一覧]</a><a href="../thread/15501-15600">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15564">  15564 2011-04-07 11:54 [&lt;mysql@xxxxxxxxxx&gt;  ] MySQLエラーコード「159」について        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15565">  15565 2011-04-07 12:38 ┗[Takeshi Hayase &lt;linu]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="15566">  15566 2011-04-07 13:01 　┗[&lt;mysql@xxxxxxxxxx&gt;  ]                                     </a></span>
</pre>
</body>
</html>
