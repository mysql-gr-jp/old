<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:1444</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="1443.html">[前]</a><a href="1445.html">[次]</a><a href="../list/1401-1500.html">[番号順一覧]</a><a href="../thread/1401-1500.html">[スレッド一覧]</a></p>
<p class="id">
mysql:1444
</p>
<div class="header">
<p>
From: とみたまさひろ &lt;とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 04 Jan 2000 17:32:43 +0900<br>
Subject: [mysql 01444] Re: LEFT JOIN は実用に耐えるか<br>

</p>
</div>
<div class="body">
<pre>
とみたです。

At Tue, 04 Jan 2000 17:31:21 +0900,
akon &lt;akon@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; mysql&gt; explain select count(*) from TableA left join TableBe using(key1);</span>
<span class="quote1">&gt; +-----------+------+---------------+------+---------+------+--------+-------+</span>
<span class="quote2">&gt; | table     | type | possible_keys | key  | key_len | ref  | rows   | Extra |</span>
<span class="quote1">&gt; +-----------+------+---------------+------+---------+------+--------+-------+</span>
<span class="quote2">&gt; | TableA    | ALL  | NULL          | NULL |    NULL | NULL | 252790 |       |</span>
<span class="quote2">&gt; | TableB    | ALL  | PRIMARY       | NULL |    NULL | NULL | 134750 |       |</span>
<span class="quote1">&gt; +-----------+------+---------------+------+---------+------+--------+-------+</span>
<span class="quote1">&gt; 2 rows in set (0.00 sec)</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; です。よく分かりません。</span>

マニュアル 7.21 によると

<span class="quote1">| それぞれのテーブルで、type が ALL になっています。これは MySQL が全てのテー</span>
<span class="quote1">| ブルを全結合することを示します！それぞれのテーブル内の行数分から作った物が</span>
<span class="quote1">| 調べられるので、とても長い時間がかかります！この場合、74 * 2135 * 74 * 3872</span>
<span class="quote1">| = 45,268,558,720 行調べることになります。テーブルが肥大化したときにかかる時</span>
<span class="quote1">| 間を考えてください....</span>

ってなことらしいです。どうやらインデックスがまずいようです。

mysql&gt; show fields from TableA; show fields from TableB;
mysql&gt; show keys from TableA; show keys from TableB;

でテーブル構造やインデックスを確認してみましょう。


<span class="quote1">&gt; が 要件は あくまで ＬＥＦＴ ＪＯＩＮ なんです。</span>
<span class="quote1">&gt; Select 句は 実際は、COUNT(*)ではなくいくつかの項目を指定したいわけで</span>
<span class="quote1">&gt; TableB に一致しないものも含め TableA 全件 なんです。</span>

ああ、なるほど…。

--
とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;

</pre>
</div>
<p class="button"><a href="1443.html">[前]</a><a href="1445.html">[次]</a><a href="../list/1401-1500.html">[番号順一覧]</a><a href="../thread/1401-1500.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="1441.html">   1441 2000-01-04 16:37 [akon &lt;akon@xxxxxxxxx] LEFT JOIN は実用に耐えるか              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="1442.html">   1442 2000-01-04 16:35 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="1443.html">   1443 2000-01-04 17:31 　┗[akon &lt;akon@xxxxxxxxx]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="1444.html">   1444 2000-01-04 17:32 　　┗[とみたまさひろ &lt;tomm]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="1445.html">   1445 2000-01-04 18:37 　　　┗[akon &lt;akon@xxxxxxxxx]                                 </a></span>
</pre>
</body>
</html>
