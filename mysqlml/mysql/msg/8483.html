<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8483</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="8482.html">[前]</a><a href="8484.html">[次]</a><a href="../list/8401-8500.html">[番号順一覧]</a><a href="../thread/8401-8500.html">[スレッド一覧]</a></p>
<p class="id">
mysql:8483
</p>
<div class="header">
<p>
From: "江口" &lt;"江口" &lt;eguchi@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 11 Dec 2003 15:28:14 +0900<br>
Subject: [mysql 08483] Re: innoDB の行排他ロックについて<br>

</p>
</div>
<div class="body">
<pre>ひろせ様

いつもお世話になります。江口です。ご意見ありがとうございます。
回答が遅くなり申し訳ありません。

<span class="quote1">&gt;レコード数が多かろうが少なかろうが、</span>
<span class="quote1">&gt;</span>
<span class="quote3">&gt;&gt; &gt; MySQLで大量データを持つ表に対しある処理で一部レコードを更新</span>
<span class="quote1">&gt;                                             ^^^^^^^^^^^^</span>
<span class="quote3">&gt;&gt; &gt; しながら別の処理で他のレコードを更新することが実現可能か</span>
<span class="quote1">&gt;                      ^^^^^^^^^^^^</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;処理 1 と処理 2 の更新対象レコードが独立ならば、更新処理同士の競合回避</span>
<span class="quote1">&gt;という点で SELECT ～ FOR UPDATE は必要ないし、恐らくトランザクション処</span>
<span class="quote1">&gt;理も必要ないのではないかと思うのですが、実際の処理内容はもっと複雑なの</span>
<span class="quote1">&gt;でしょうか?</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;それと</span>
<span class="quote1">&gt;</span>
<span class="quote3">&gt;&gt; &gt; どうかの調査を行っており、Oracleでの開発を行った経験から</span>
<span class="quote3">&gt;&gt; &gt; 双方の処理で行の排他ロックを掛ける必要があると思っています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;Oracle でどいう問題があったのかも気になります。</span>


処理内容は特に複雑なわけではありません。
トランザクション処理を使用する目的はなんらかの障害が発生した
ときにトランザクションの開始時点までrallbackさせたい。
と考えています。

行排他ロックを使用する目的はデータの保護を意識的に行えば、
エラー発生後のデータを確実に復旧しやすいのではないか
と考えるためです。
なぜ表ロックしてしまわないのかというと
（例えば今回のように行排他ロックを行ったつもりが
　表ロックされてしまうことがなぜ好ましくないのかといえば）
想定しているシステムではそれぞれの処理が完了するまで
別の処理で更新ができないとなると運用に耐えないシステム
となってしまうと考えたからです。
＊これが大量データ云々の部分に関係します。
　説明が不足しており申し訳ありませんでした。

Oracleに限った話ではないと思いますが
別の製造者が作成した、表ロック、行排他ロック、暗黙のロック（というんでしょう
か？）
を使用したプログラムが同時に動作した場合、デッドロックが発生する
確率が高くなるのではないかと思っています。


</pre>
</div>
<p class="button"><a href="8482.html">[前]</a><a href="8484.html">[次]</a><a href="../list/8401-8500.html">[番号順一覧]</a><a href="../thread/8401-8500.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="8466.html">   8466 2003-12-10 14:40 ["江口" &lt;eguchi@xxxxx] innoDB の行排他ロックについて           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8467.html">   8467 2003-12-10 18:28 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8468.html">   8468 2003-12-10 18:58 　┣["江口" &lt;eguchi@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8471.html">   8471 2003-12-10 19:10 　┃┗["江口" &lt;eguchi@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8469.html">   8469 2003-12-10 19:08 　┗["HIROSE, Masaaki" &lt;h]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8472.html">   8472 2003-12-10 19:22 　　┣["HIROSE, Masaaki" &lt;h]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="8483.html">   8483 2003-12-11 15:28 　　┗["江口" &lt;eguchi@xxxxx]                                   </a></span>
</pre>


</body></html>