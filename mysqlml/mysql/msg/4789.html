<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:4789</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="4788.html">[前]</a><a href="4790.html">[次]</a><a href="../list/4701-4800.html">[番号順一覧]</a><a href="../thread/4701-4800.html">[スレッド一覧]</a></p>
<p class="id">
mysql:4789
</p>
<div class="header">
<p>
From: &quot;H.Sato&quot; &lt;&quot;H.Sato&quot; &lt;h-sato_iwase@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 5 Dec 2001 20:58:44 +0900<br>
Subject: [mysql 04789] Access OpenRecordset に対しての Update ?<br>

</p>
</div>
<div class="body">
<pre>
こんにちは！satoです。

Win98,mysql(3.23.44),myodbc,Access2000の環境です。
Accessで以下のプログラムが
「ほかのユーザーが同じデータに対し変更を試みているので
プロセスが停止しました。」のエラーが出ます。
Accessのテーブルでは問題なかったのですが・・・。
対処策ありましたらアドバイス宜しくお願い致します。

---------------&lt;Access VBA&gt;------------------
Function 更新()
    Dim db As DAO.Database
    Dim rs1, rs2 As DAO.Recordset
    Dim sql1, sql2

    Set db = CurrentDb

    sql1 = &quot;SELECT * FROM jutyu;&quot;     '&lt;--MySQL ODBC リンクテーブル
    Set rs1 = db.OpenRecordset(sql1)

    Do Until rs1.EOF
        sql2 = &quot;SELECT * FROM JSPCPF WHERE JSSER1 = '&quot; &amp; rs1![JUSER1] &amp; &quot;';&quot;
        Set rs2 = db.OpenRecordset(sql2)
            If rs2.RecordCount &lt;&gt; 0 Then
              rs1.Edit
                 rs1![JUSPE] = rs2![JSSPE1]
              rs1.Update                                 '&lt;---ERROR
            End If
        rs1.MoveNext
    Loop

    Set sql1 = Nothing
    Set sql2 = Nothing
    Set db = Nothing

End Function



</pre>
</div>
<p class="button"><a href="4788.html">[前]</a><a href="4790.html">[次]</a><a href="../list/4701-4800.html">[番号順一覧]</a><a href="../thread/4701-4800.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="4789.html">   4789 2001-12-05 20:58 [&quot;H.Sato&quot; &lt;h-sato_iwa] Access OpenRecordset に対しての Update ?</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4793.html">   4793 2001-12-06 12:46 ┗[madara &lt;madara@xxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4795.html">   4795 2001-12-07 10:08 　┗[&quot;H.Sato&quot; &lt;h-sato_iwa]                                     </a></span>
</pre>
</body>
</html>
