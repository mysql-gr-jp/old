<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15115</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15114">[前]</a><a href="15116">[次]</a><a href="../list/15101-15200">[番号順一覧]</a><a href="../thread/15101-15200">[スレッド一覧]</a></p>
<p class="id">
mysql:15115
</p>
<div class="header">
<p>
From: 岩崎　誠司 &lt;岩崎　誠司 &lt;iwasaki_ryuqseed_6130@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 24 Dec 2009 15:54:15 +0900 (JST)<br>
Subject: [mysql 15115] バイナリデータの取り込みについて<br>

</p>
</div>
<div class="body">
<pre>
皆様　お世話になります。

質問です。

今、私はファイルのバイナリデータをMySQLに取り込みたいと
思い悪戦苦闘しおります。

LAN上でMySQL経由でバイナリファイルを共有したいと思い
VS2008 C++でアプリを組み、アプリ内でクエリを発行して
データをinsertしたいのですがうまくいきません。

皆様のお知恵を拝借願えないでしょうか？

コードはこんな感じです。

FILE *pStream;
CString sPath1(&quot;G:\\file1.***&quot;); // 読込元のファイル
CString sPath2(&quot;G:\\file2.***&quot;); // 保存先のファイル
CString Sql;			 // Sqlクエリ
CString sSqlData; // MySQLからselectで取り出したデータ
char pD[100000];	 // ファイルの読み書き用

// ファイルの取得(読込モード)
fopen_s(&amp;pStream, sPath1, &quot;rb&quot;);
int n = fread(pD, sizeof(char), sizeof(pD), pStream);
fclose(pStream);

// クエリの作成
Sql.Format(_T(
	&quot;INSERT INTO eudc (id, eudc_data, count) &quot;
	&quot;VALUES (0, '%s', n)&quot;
	), cData, n);

// Sqlクエリの発行

// MySQLからのバイナリデータを取得

// char への変換
pD == &quot;&quot;;
strcpy(pD, sSqlData);
// ファイルへの書き込み
fopen_s(&amp;pStream, sPath2, &quot;wb&quot;);
fwrite(pD, sizeof(char), n, pStream);
fclose(pStream);

freadでは、ちゃんと取得できてるようですが、
pDの先頭がNULLみたいでCStringに変換できません。
（%sのところにバイナリデータが入らない。）

ちなみにテキストファイルの場合は、これで問題ないです。
又、pDを触らずにそのまま別のファイルに書き込んでも
大丈夫みたいです。

使用環境
OS　Windows Vista Ultimate SP2
開発ツール　VS2008 C++
MySQL Ver5.1

以上、初歩的なことかもしれませんが、
よろしくお願いします。

--------------------------------------
Get Disney character's mail address on Yahoo! Mail
<a href="http://pr.mail.yahoo.co.jp/disney/">http://pr.mail.yahoo.co.jp/disney/</a>

</pre>
</div>
<p class="button"><a href="15114">[前]</a><a href="15116">[次]</a><a href="../list/15101-15200">[番号順一覧]</a><a href="../thread/15101-15200">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15105">  15105 2009-12-14 19:00 [Honda Takayuki &lt;hond] レプリケーションエラー(server id was not set)</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15106">  15106 2009-12-14 20:26 ┗[Honda Takayuki &lt;hond]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="15115">  15115 2009-12-24 15:54 　┗[岩崎　誠司 &lt;iwasaki_] バイナリデータの取り込みについて    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15116">  15116 2009-12-24 16:01 　　┣[&lt;y-iida@xxxxxxxxxx&gt; ]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15117">  15117 2009-12-24 16:25 　　┣[岩崎　誠司 &lt;iwasaki_]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15118">  15118 2009-12-24 17:17 　　┃┗[&quot;Eigo Mori&quot; &lt;eigom@x]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15121">  15121 2009-12-24 19:45 　　┣[Yoshiaki Yanagimoto ]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15122">  15122 2009-12-25 01:59 　　┗[ちさ &lt;admin@xxxxxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15123">  15123 2009-12-25 12:18 　　　┗[岩崎　誠司 &lt;iwasaki_]                                 </a></span>
</pre>
</body>
</html>
