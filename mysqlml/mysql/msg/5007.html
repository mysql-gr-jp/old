<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5007</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="5006.html">[前]</a><a href="5008.html">[次]</a><a href="../list/5001-5100.html">[番号順一覧]</a><a href="../thread/5001-5100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5007
</p>
<div class="header">
<p>
From: "MIYATSU Kazunari" &lt;"MIYATSU Kazunari" &lt;mid@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 22 Jan 2002 16:15:19 +0900<br>
Subject: [mysql 05007] Re: Access2000 でのデータ更新<br>

</p>
</div>
<div class="body">
<pre>宮津@長野です

手元の環境
MySQL:3.23.41-nt(Win32)
MyODBC:MySQL-EUC 2.50.29.00
MS ACCESS:2000(9.0.4402 SR-1)
Windows 2000 SP2

でMyODBCを
Don't optimize column width
Return matching row
Ignore # in #.table
Use Manager cursors (exp)
Don't use setlocale
Change BIGINT columns to INT

のオプション付けと適切なホスト、データベース、ユーザ名、パスワードでシステム
DSNに追加した後ACCESS2000からテーブルをリンクしていじってみました。

フィールド構成を変えてはリンクしなおしてみると、timestamp型フィールドは付加
しなくても問題ありませんでしたが、DATE型のフィールドを追加して再リンクした時
に障害の一端が見えた気がしました。

既存のレコードが存在する状態でDATE型フィールドを付加すると"0000-00-00"が挿入
されますが、ACCESS上からは空フィールドに見えます。この状態ではDATEフィールド
以外も更新不可になりました。ODBCのトレースログを見るとUPDATE構文のWhere条件
にDATE=""(ACCESSでの見え方)が入れられているようなので、他ユーザが変更した・
・・というよりは該当するレコードが存在しない・・・というエラーが出る方が適切
なのだと思います。

フィールド型をあれこれ変えてみると、このACCESS側での値の解釈とMySQLでの値の
差違が問題の本質なのではないかと思います。

auto increment属性を付けたフィールドに何も値を設定しないでデータ挿入すると
"#DELETED"表示になるのも根底は同じ問題と思います。

Uniqueフィールドが存在する場合には、それだけをWhereに指定するなどODBCドライ
バ側に改変を加える方が良いかもしれません。



</pre>
</div>
<p class="button"><a href="5006.html">[前]</a><a href="5008.html">[次]</a><a href="../list/5001-5100.html">[番号順一覧]</a><a href="../thread/5001-5100.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="4984.html">   4984 2002-01-19 11:51 ["T.Yamamoto" &lt;yamamo] Access2000 でのデータ更新               </a></span>
<span class="current">-&gt;&nbsp;<a href="5007.html">   5007 2002-01-22 16:15 ┗["MIYATSU Kazunari" &lt;]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5008.html">   5008 2002-01-22 17:25 　┗["T.Yamamoto" &lt;yamamo]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5009.html">   5009 2002-01-22 18:04 　　┣["MIYATSU Kazunari" &lt;]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5012.html">   5012 2002-01-22 18:55 　　┃┣["T.Yamamoto" &lt;yamamo]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5013.html">   5013 2002-01-22 19:24 　　┃┃┣[Daiju Azuma &lt;daiju_a]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5018.html">   5018 2002-01-23 09:24 　　┃┃┗["MIYATSU Kazunari" &lt;]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5015.html">   5015 2002-01-22 22:28 　　┃┗[とみたまさひろ &lt;tomm]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5017.html">   5017 2002-01-23 08:23 　　┃　┗["MIYATSU Kazunari" &lt;]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5010.html">   5010 2002-01-22 18:20 　　┣[Daiju Azuma &lt;daiju_a]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5014.html">   5014 2002-01-22 20:53 　　┣[楠吉彦 &lt;moredebu@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5016.html">   5016 2002-01-23 01:55 　　┗[masahiro kawata &lt;mas]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5019.html">   5019 2002-01-23 14:36 　　　┗["T.Yamamoto" &lt;yamamo]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5020.html">   5020 2002-01-23 21:08 　　　　┗["T.Yamamoto" &lt;yamamo]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5027.html">   5027 2002-01-24 18:02 　　　　　┗["T.Yamamoto" &lt;yamamo]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5028.html">   5028 2002-01-24 20:44 　　　　　　┗[tateyan &lt;tateyan@xxx]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5029.html">   5029 2002-01-25 11:54 　　　　　　　┗["T.Yamamoto" &lt;yamamo]                         </a></span>
</pre>


</body></html>