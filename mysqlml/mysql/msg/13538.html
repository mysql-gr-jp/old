<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13538</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13537.html">[前]</a><a href="13539.html">[次]</a><a href="../list/13501-13600.html">[番号順一覧]</a><a href="../thread/13501-13600.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13538
</p>
<div class="header">
<p>
From: &lt;xbox@xxxxxxxxxx&gt;<br>
Date: 22 Nov 2006 15:22:36 +0900<br>
Subject: [mysql 13538] Re: [質問]突如データベース接続不能となってしまいました。<br>

</p>
</div>
<div class="body">
<pre>
YuGoさんお返事ありがとうございます！

<span class="quote1">&gt; CMSとはなんですか。</span>

申し訳ありません。
コンテンツマネジメントシステムの略です。
xoopsというCMSなのですが、phpとmysqlを使って、ポータルサイト
の管理等を行えるものです。

<span class="quote1">&gt; データベースサーバがリモートにあるということでしょうか。</span>
<span class="quote1">&gt; このサーバは借り物であるということでしょうか。</span>
<span class="quote1">&gt; 持ち主が設定変更したということはないでしょうか。</span>

自宅に設置してある、サーバーです。

EXIM4というメールサーバーの設定は行っていましたが、パッケー
ジのインストール等の大掛かりな事はまったく行っていませんでし
た。

<span class="quote1">&gt; /etc/init.d/mysql strat</span>
<span class="quote1">&gt; ではなく、</span>
<span class="quote1">&gt; /usr/bin/mysqld_safeとかで起動を試みれば、何かメッセージが返ってきませんか。</span>

すみません。findで探してみたのですが、どうも物が居ないようで
す。debianではいないのか・・・私の環境下ではなくなってしまっ
たかのどちらかと・・・


 
<span class="quote1">&gt; 1と2について</span>
<span class="quote1">&gt; MySQL4.0.24をインストールしたとありますが、パッケージからインストールされているためわたしはわかりません。</span>

なるほど、私もdebパッケージよりインストールしました。
正常に動いているときには、ディレクトリ自身があるか無いかとい
うところを確認したことが無かったため・・・正誤の判断つきませ
んでした。

<span class="quote1">&gt; 3について</span>
<span class="quote1">&gt; cnfファイルのとおりとすれば、 /var/lib/mysqlにデータがあるはずですから、コピーすればバックアップできると思います。ついでにここに何かログがないでしょうか。</span>

ありがとうございます。
それらしき、データベース名のディレクトリの中にテーブルがあり
ました。助かります。最悪の場合再インストールし、データを戻す
ことができそうです。ただ、コピーするだけではダメなんでしょう
が、少しホッとしました。


お忙しいところ、ご回答いただきありがとうございました。

よろしくお願いいたします。

<span class="quote1">&gt;CMSとはなんですか。</span>
<span class="quote1">&gt;データベースサーバがリモートにあるということでしょうか。</span>
<span class="quote1">&gt;このサーバは借り物であるということでしょうか。</span>
<span class="quote1">&gt;持ち主が設定変更したということはないでしょうか。</span>
<span class="quote1">&gt;/etc/init.d/mysql strat</span>
<span class="quote1">&gt;ではなく、</span>
<span class="quote1">&gt;/usr/bin/mysqld_safeとかで起動を試みれば、何かメッセージが返ってきませんか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;1と2について</span>
<span class="quote1">&gt;MySQL4.0.24をインストールしたとありますが、パッケージからインストールされているためわたしはわかりません。</span>
<span class="quote1">&gt;3について</span>
<span class="quote1">&gt;cnfファイルのとおりとすれば、 /var/lib/mysqlにデータがあるはずですから、コピーすればバックアップできると思います。ついでにここに何かログがないでしょうか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;YuGo</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; 現在Debian Sage上にてMysql4.0.24 をインストールし、CMSとし</span>
<span class="quote2">&gt;&gt; てXoopsを利用していたのですが、昨晩より下記のエラーが発生</span>
<span class="quote2">&gt;&gt; し、データーベースへの接続が不能となってしまいました。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; Unable to connect to database in file class/database/databasefactory.php </span>
<span class="quote2">&gt;&gt; line 34</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 実際にtelnetでログインすると、mysqldが起動されておらず、</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; /etc/init.d/mysql strat</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; を実行しても数秒後にメッセージモなくプロンプトが戻ってくる</span>
<span class="quote2">&gt;&gt; だけで終了してしまいます。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; /var/log/mysql.err にはデータが無くゼロバイト</span>
<span class="quote2">&gt;&gt; /var/log/mysql.log もゼロバイトの状態です。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; ソケット等を調べようとしたのですが</span>
<span class="quote2">&gt;&gt; /var/run/を覗くとmysqldのディレクトリが無く、無いことが異常</span>
<span class="quote2">&gt;&gt; なのかも知識が無く、判断できていません。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; cnfファイルの確認をしたところ、</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; debina.cnf：</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; # Automatically generated for Debian scripts. DO NOT TOUCH!</span>
<span class="quote2">&gt;&gt; [client]</span>
<span class="quote2">&gt;&gt; host     = localhost</span>
<span class="quote2">&gt;&gt; user     = debian-sys-maint</span>
<span class="quote2">&gt;&gt; password = XXXXXXXXXXXXXXXXX</span>
<span class="quote2">&gt;&gt; socket   = /var/run/mysqld/mysqld.sock</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; my.cnf：</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; [client]</span>
<span class="quote2">&gt;&gt; port            = 3306</span>
<span class="quote2">&gt;&gt; socket          = /var/run/mysqld/mysqld.sock</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; [mysqld_safe]</span>
<span class="quote2">&gt;&gt; socket          = /var/run/mysqld/mysqld.sock</span>
<span class="quote2">&gt;&gt; nice            = 0</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; [mysqld]</span>
<span class="quote2">&gt;&gt; #</span>
<span class="quote2">&gt;&gt; # * Basic Settings</span>
<span class="quote2">&gt;&gt; #</span>
<span class="quote2">&gt;&gt; user            = mysql</span>
<span class="quote2">&gt;&gt; pid-file        = /var/run/mysqld/mysqld.pid</span>
<span class="quote2">&gt;&gt; socket          = /var/run/mysqld/mysqld.sock</span>
<span class="quote2">&gt;&gt; port            = 3306</span>
<span class="quote2">&gt;&gt; basedir         = /usr</span>
<span class="quote2">&gt;&gt; datadir         = /var/lib/mysql</span>
<span class="quote2">&gt;&gt; tmpdir          = /tmp</span>
<span class="quote2">&gt;&gt; language        = /usr/share/mysql/japanese</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 上記2ファイルとも/var/run/mysqld/を指し示していました。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; そして、上記languageの項目から /usr/share/を覗くと、mysqlと</span>
<span class="quote2">&gt;&gt; いうディレクトリそのものがありません。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; せめてエラーログに何か溜まれば、推測のしようもあるのですが</span>
<span class="quote2">&gt;&gt; ・・・</span>
<span class="quote2">&gt;&gt; 現状このような状態となっております。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; つきましては、正常復帰を望んでおりますが、下記件もあわせて、</span>
<span class="quote2">&gt;&gt; ご質問させてください。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 1./var/runの下にmysqldのディレクトリが無いのは正常なのか？</span>
<span class="quote2">&gt;&gt; 2./usr/share/の下にmysqlのディレクトリが無いのは正常なのか？</span>
<span class="quote2">&gt;&gt; 3.mysqldが起動していない状態での、データベースの保存（バッ</span>
<span class="quote2">&gt;&gt;  クアップ手段があるのか？）は可能でしょうか？</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; よろしくお願い申し上げます。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; +-----------------+</span>
<span class="quote2">&gt;&gt; Tetsuya NAKAHARA</span>
<span class="quote2">&gt;&gt; xbox@xxxxxxxxxx</span>
<span class="quote2">&gt;&gt; +-----------------+</span>
<span class="quote2">&gt;&gt; </span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>

</pre>
</div>
<p class="button"><a href="13537.html">[前]</a><a href="13539.html">[次]</a><a href="../list/13501-13600.html">[番号順一覧]</a><a href="../thread/13501-13600.html">[スレッド一覧]</a></p>
</body>
</html>
