<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15381</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15380">[前]</a><a href="15382">[次]</a><a href="../list/15301-15400">[番号順一覧]</a><a href="../thread/15301-15400">[スレッド一覧]</a></p>
<p class="id">
mysql:15381
</p>
<div class="header">
<p>
From: &quot;Watanabe Tomoyuki&quot; &lt;&quot;Watanabe Tomoyuki&quot; &lt;WATANABE.TOMOYUKI.2@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 24 Aug 2010 08:56:19 +0900<br>
Subject: [mysql 15381] Re: int column への2147483648<br>

</p>
</div>
<div class="body">
<pre>
渡辺です。

余談になってしまいますが。


私も C API を触ったことはないです。
PHPのPDOを見回してみましたが、PDOからもPDOStatementからも
実行結果のWarningを取得することはできなさそうでした。
errorinfo的なものにはエラーしか入らないようですね。

面倒ですが「SHOW WARNINGS;」のSQLを別途実行してWarningが無いかを
確認するしかないのでしょうか・・・



<span class="quote1">&gt; -----Original Message-----</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 坂井です</span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt; &gt; そうなんですか？ちなみに、何という本でしょうか？調べてみたいと思い</span>
<span class="quote2">&gt; &gt; ます。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; <a href="http://www.amazon.co.jp/x/dp/4774142948">http://www.amazon.co.jp/x/dp/4774142948</a></span>
<span class="quote1">&gt; エキスパートのためのMySQL[運用+管理]トラブルシューティングガイド</span>
<span class="quote1">&gt; 奥野幹也 著　　　技術評論社 刊</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt;   です。</span>
<span class="quote1">&gt;   ちなみに、Google で、「奥野 本 MySQL」と検索するだけで、この本</span>
<span class="quote1">&gt;   の情報にたどり着けます:-)</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt;   今回の話題に絞って言えば、４章の「SQLモード」の説明が役に立つと</span>
<span class="quote1">&gt;   思います。</span>
<span class="quote1">&gt;   要点だけ抜き書くと、「STRICT_ALL_TABLES （というSQLモードを指定すると)</span>
<span class="quote1">&gt;   全てのテーブルにおいてTRUNCATIONが行われなくなります。無効な値を</span>
<span class="quote1">&gt;   指定したときはエラーになります。」ということで、</span>
<span class="quote1">&gt;   今回のような期待と異なる値で登録されることを防ぐのに役にたつかと思いま</span>
<span class="quote1">&gt;   す。</span>
<span class="quote1">&gt;   </span>
<span class="quote2">&gt; &gt; こちらは、プログラムインタフェースmysql_stmt_execute()の結果は0と</span>
<span class="quote2">&gt; &gt; なり、エラーにならないんです。  </span>
<span class="quote1">&gt;   </span>
<span class="quote1">&gt;   私は C API でプログラムを書かないので、マニュアルをざっと調べて</span>
<span class="quote1">&gt;   見たのですが分かりませんでした。実行結果のWARNINGを取得する方法って、</span>
<span class="quote1">&gt;   どうやるのでしょうね。詳しい方、ぜひ教えてください！</span>
<span class="quote1">&gt;   </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; Thank you</span>
<span class="quote1">&gt; On Sat, 21 Aug 2010 10:39:39 +0900 (LMT)</span>
<span class="quote1">&gt; Etsuo SUMIYA &lt;sumiya-e@xxxxxxxxxx&gt; wrote:</span>
<span class="quote2">&gt; &gt; sumiyaといいます。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; From: SAKAI Kei &lt;sak2@xxxxxxxxxx&gt;</span>
<span class="quote2">&gt; &gt; Subject: <a href="15377">[mysql 15377]</a> Re: int column への2147483648</span>
<span class="quote2">&gt; &gt; Date: Fri, 20 Aug 2010 22:10:41 +0900</span>
<span class="quote2">&gt; &gt; Message-ID: &lt;20100820221039.6D79.51EA1301@xxxxxxxxxx&gt;</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote4">&gt; &gt; &gt; &gt; 5.1.xになって、columnの型がunsignedに変わり、  </span>
<span class="quote3">&gt; &gt; &gt;  </span>
<span class="quote3">&gt; &gt; &gt;   の部分がとても気になりました。</span>
<span class="quote3">&gt; &gt; &gt;   バージョンアップをする過程のどこかで、signed int が</span>
<span class="quote3">&gt; &gt; &gt;   unsigned int になる操作が入ってしまったのだと推測し</span>
<span class="quote3">&gt; &gt; &gt;   ていますが、心当たりはあるでしょうか。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; 5.0.47の環境で、columnを作る時、signedで作ってしまい、先の結果とな</span>
<span class="quote2">&gt; &gt; りました。混乱させてしまいました。</span>
<span class="quote2">&gt; &gt; 5.0.47でも、unsigned intのcolumnには-2147483648は書けませんでした。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote3">&gt; &gt; &gt;   </span>
<span class="quote3">&gt; &gt; &gt;   推測ついでにもうひとつ書くと、</span>
<span class="quote3">&gt; &gt; &gt;   おそらく 5.0.47 でも unsigned int にしたテーブルで</span>
<span class="quote3">&gt; &gt; &gt;   同様の操作をすると、同じ結果（0）になると思います。</span>
<span class="quote3">&gt; &gt; &gt;   処理結果のコードを見ると、Code:1264 の Warning が</span>
<span class="quote3">&gt; &gt; &gt;   帰ってきていませんか。メッセージはこんな感じです。</span>
<span class="quote3">&gt; &gt; &gt; </span>
<span class="quote3">&gt; &gt; &gt;     Out of range value adjusted for column 'c1' at row 1</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; こちらは、プログラムインタフェースmysql_stmt_execute()の結果は0と</span>
<span class="quote2">&gt; &gt; なり、エラーにならないんです。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote3">&gt; &gt; &gt;     INSERT INTO t VALUES (-2147483648);</span>
<span class="quote3">&gt; &gt; &gt;   </span>
<span class="quote3">&gt; &gt; &gt;   という文を、signed 型カラムのテーブルに対して実行すれば</span>
<span class="quote3">&gt; &gt; &gt;   -2147483648 が登録されるし、</span>
<span class="quote3">&gt; &gt; &gt;   unsigned型のテーブルに対して実行したら 0 になります。</span>
<span class="quote3">&gt; &gt; &gt;   </span>
<span class="quote3">&gt; &gt; &gt;   この切り捨てが起きないようにする方法も、最近出た奥野さん</span>
<span class="quote3">&gt; &gt; &gt;   の本に出ていましたね。（SQL MODE の話）</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; そうなんですか？ちなみに、何という本でしょうか？調べてみたいと思い</span>
<span class="quote2">&gt; &gt; ます。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>

</pre>
</div>
<p class="button"><a href="15380">[前]</a><a href="15382">[次]</a><a href="../list/15301-15400">[番号順一覧]</a><a href="../thread/15301-15400">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15374">  15374 2010-08-19 20:46 [Etsuo SUMIYA &lt;sumiya] int column への2147483648               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15375">  15375 2010-08-19 21:50 ┗[Mikiya Okuno &lt;mikiya]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15376">  15376 2010-08-20 08:23 　┗[Etsuo SUMIYA &lt;sumiya]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15377">  15377 2010-08-20 22:10 　　┗[SAKAI Kei &lt;sak2@xxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15378">  15378 2010-08-21 10:39 　　　┗[Etsuo SUMIYA &lt;sumiya]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15379">  15379 2010-08-21 18:31 　　　　┗[SAKAI Kei &lt;sak2@xxxx]                               </a></span>
<span class="current">-&gt;&nbsp;<a href="15381">  15381 2010-08-24 08:56 　　　　　┗[&quot;Watanabe Tomoyuki&quot; ]                             </a></span>
</pre>
</body>
</html>
