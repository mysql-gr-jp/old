<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:11159</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="11158.html">[前]</a><a href="11160.html">[次]</a><a href="../list/11101-11200.html">[番号順一覧]</a><a href="../thread/11101-11200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:11159
</p>
<div class="header">
<p>
From: 東原　正智 &lt;東原　正智 &lt;ZAP02756@xxxxxxxxxx&gt;&gt;<br>
Date: Sun, 13 Mar 2005 21:13:01 +0900<br>
Subject: [mysql 11159] MySQLDriverCSを使っての接続<br>

</p>
</div>
<div class="body">
<pre>
はじめまして。

現在、VB.NETとMySQLとのLAN内での接続を試みていますが、VB.NETでサーバーへのIPを
指定しての接続がうまくいきません。接続文字のIPを変えてみるなどしましたが、
localhostをみているようです。
localhostに同様な構成のDBをコピーし作成すると、これは、selectできています。
IP指定した場合のエラーメッセージは、
&quot;MySQLDriverCS Exception:MySQLDriverCS error:wrong query Table 'データベース名
.
テーブル名' doesn't exist&quot;
と出てきます。

サーバー内のDBには、接続の権限を与えるため
mysql -D db -e \ &quot;grant all privileges on db.* to myuser@*.*.*.*(クラスCのIP) 
identified by 'password' with grant option
としました。
また、mysql -h ホスト名　-uroot -ppassword 
とするとサーバー内のDBは見えています。
以下これまでの手順とソースです。
・参照設定でMySQLDriverCS.dllを追加
（ソース）
Imports MySQLDriverCS
Imports System
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles Button1.Click
        'MySQLへの接続
        '宣言
        Dim conn As New MySQLConnection( _
            String.Format(&quot;Port={0};Server={1};_
            Database={2};User ID=3};Password={4}&quot;, _
             3306, &quot;*.*.*.*&quot;, &quot;db&quot;, &quot;root&quot;, &quot;password&quot;))
        Dim cmd As MySQLCommand
        Dim red As MySQLDataReader
        'MySQL Open
        Try
            conn.Open()
            'コマンド実行
            cmd = New MySQLCommand(&quot;SELECT id, name _
                FROM db.table&quot;, conn)
            red = CType(cmd.ExecuteReader(), MySQLDataReader)
            '結果表示
            Do While red.Read
                Console.WriteLine(&quot;id={0}, name={1}&quot;, red(0), red(1))
            Loop
以下略

なにかお気づきの点がありましたお願い致します。
長文にて失礼いたします。

                                           HIGASHIHARA MASANORI

</pre>
</div>
<p class="button"><a href="11158.html">[前]</a><a href="11160.html">[次]</a><a href="../list/11101-11200.html">[番号順一覧]</a><a href="../thread/11101-11200.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="11159.html">  11159 2005-03-13 21:13 [東原　正智 &lt;ZAP02756] MySQLDriverCSを使っての接続             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11160.html">  11160 2005-03-14 01:55 ┗[東原　正智 &lt;ZAP02756] Re: MySQLDriverCSを使っての接         </a></span>
</pre>
</body>
</html>
