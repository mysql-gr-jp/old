<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12567</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="12566.html">[前]</a><a href="12568.html">[次]</a><a href="../list/12501-12600.html">[番号順一覧]</a><a href="../thread/12501-12600.html">[スレッド一覧]</a></p>
<p class="id">
mysql:12567
</p>
<div class="header">
<p>
From: TOMTOM &lt;TOMTOM &lt;tomf1@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 15 Dec 2005 11:34:50 +0900<br>
Subject: [mysql 12567] エクセルでの,文字化け<br>

</p>
</div>
<div class="body">
<pre>

こんにちは、
MySQLに、エクセルのVBAで、アクセスしてみたのですが、
うまくいきません。
何処が悪いの解らないので、
ご教示ください。
私のMySQLの設定は以下のようになっています。

mysql&gt; status;
--------------
C:\Program Files\MySQL\MySQL Server 5.0\bin\mysql.exe  Ver 14.12 Distrib 5.0.15,
 for Win32 (ia32)
Connection id:          40
Current database:
Current user:           root@localhost
SSL:                    Not in use
Using delimiter:        ;
Server version:         5.0.15-nt
Protocol version:       10
Connection:             localhost via TCP/IP
Server characterset:    sjis
Db     characterset:    sjis
Client characterset:    sjis
Conn.  characterset:    sjis
TCP port:               3306
Uptime:                 2 hours 5 min 53 sec

Threads: 2  Questions: 172  Slow queries: 0  Opens: 0  Flush tables: 1  Open tab
les: 1  Queries per second avg: 0.023
--------------
mysql&gt; select * from ff;
+------------+
<span class="quote1">| name       |</span>
+------------+
<span class="quote1">| こんばんは |</span>
<span class="quote1">| ??         |</span>
<span class="quote1">| 漢字       |</span>
<span class="quote1">| 結構       |</span>
<span class="quote1">| 396        |</span>
<span class="quote1">| aaa        |</span>
<span class="quote1">| aaa        |</span>
+------------+
7 rows in set (0.00 sec)

テーブルのデータは、以上の様になっています。

エクセルのvbaを以下のように、しました。

Public Sub qt1()
Dim qt As QueryTable
sqlstring = &quot;select * from ff&quot;
connstring = &quot;ODBC;DSN=MySQL;UID=root;PWD=*****;Database=test&quot;
With ActiveSheet.QueryTables.Add(Connection:=connstring, Destination:=Range(&quot;B1&quot;), Sql:=sqlstring)
    .Refresh
End With

End Sub

エクセルの結果は、以下のようになりました。

name
?????
??
??
??
396
aaa
aaa

以上のように文字化けしました

いろいろ試してみたのですが、
なんで、文字化けするのか、良く分かりません、
どうのようにしたら、文字化けしないか、
教えてください。
よろしくお願いいたします。

ちなみに、ODBC　ドライバーは、以下のものを使っています。

mysql-connector-odbc-3.51.12-win32




</pre>
</div>
<p class="button"><a href="12566.html">[前]</a><a href="12568.html">[次]</a><a href="../list/12501-12600.html">[番号順一覧]</a><a href="../thread/12501-12600.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="12567.html">  12567 2005-12-15 11:34 [TOMTOM &lt;tomf1@xxxxxx] エクセルでの,文字化け                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12570.html">  12570 2005-12-15 12:33 ┗[Hiroshi Moriyama &lt;mt]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12571.html">  12571 2005-12-15 13:31 　┗[TOMTOM &lt;tomf1@xxxxxx] Re: : エクセルでの,文字化け         </a></span>
</pre>
</body>
</html>
