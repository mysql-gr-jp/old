<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=iso-2022-jp">
<META content="MSHTML 6.00.2800.1561" name=GENERATOR>
<STYLE></STYLE>
</HEAD>
<BODY bgColor=#ffffff>
<DIV><FONT face="MS UI Gothic">お世話になっております。</FONT></DIV>
<DIV><FONT face="MS UI Gothic">ｙｋａｗａです。</FONT></DIV>
<DIV><FONT face="MS UI Gothic"></FONT>&nbsp;</DIV>
<DIV><FONT face="MS UI Gothic">かなりハマッている今日この頃です。</FONT></DIV>
<DIV><FONT face="MS UI Gothic"></FONT>&nbsp;</DIV>
<DIV><FONT 
face="MS UI Gothic">結局のところ、4.0.26でＤＢのバックアップを取得し、それを5.0.24aにインポートする事にしました。</FONT></DIV>
<DIV><FONT face="MS UI Gothic"></FONT>&nbsp;</DIV>
<DIV><FONT 
face="MS UI Gothic">しかし、インポートした時に下記のエラーが出てしまい、途中で止まってしまいます。</FONT></DIV>
<DIV><FONT face="MS UI Gothic">何か良い方法は無いでしょうか？</FONT></DIV>
<DIV><FONT face="MS UI Gothic"></FONT>&nbsp;</DIV>
<DIV><FONT face="MS UI Gothic">◆バックアップを取った時のコマンド</FONT></DIV>
<DIV><FONT face="MS UI Gothic">
<DIV><FONT face="MS UI Gothic">&nbsp;&nbsp;&nbsp; $mysqldump -d 
--no-data&nbsp;db_name &gt; db_name.schema</FONT></DIV>
<DIV>
<DIV><FONT face="MS UI Gothic">&nbsp;&nbsp;&nbsp; $mysqldump -t&nbsp;db_name 
&gt; db_name.insert</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV>
<DIV><FONT face="MS UI Gothic">◆インポートした時のコマンド</FONT></DIV>
<DIV>&nbsp;&nbsp;&nbsp; $mysql -u xxx db_name　&lt; db_name.schema　←これは成功</DIV>
<DIV>
<DIV>&nbsp;&nbsp;&nbsp; $mysql -u xxx db_name　&lt; db_name.insert　←失敗</DIV>
<DIV>&nbsp;&nbsp;&nbsp; エラー内容は、</DIV>
<DIV>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ERROR 1062(23000) at line 
367：Duplicate entry 'ｘｘｘｘｘ'　fro key 1</DIV>
<DIV>&nbsp;</DIV>
<DIV>◎キーに対して同じ値を登録しようとしているので失敗していると思われる。（mysqldumpの素のデータなのに、何故？）</DIV>
<DIV>&nbsp;&nbsp;&nbsp; そこで、二重登録が発生したら無視する様な指定で実行すれば良いかと思ったのですが</DIV>
<DIV>&nbsp;&nbsp;&nbsp; 
mysqlコマンドに、ignoreオプションが無い。『-i』は、あるが、これは少し意味合いが違うみたい。</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; しょうがないので、mysqlimportを使ってみた。　←これを使う事が有っているのか解らず。</DIV>
<DIV>&nbsp;&nbsp;&nbsp; しかし、結果はダメでした。</DIV>
<DIV>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
mysqlimport：Error:Table　'db_name.db_name' doesn't　exist when using 
table：　db_name</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV>すませんが、皆様のお力を貸してください。</DIV>
<DIV>&nbsp;</DIV>
<DIV>以上、宜しくお願い致します。</DIV></DIV></DIV></DIV></FONT><FONT 
face="MS UI Gothic"></FONT></DIV>
<BLOCKQUOTE dir=ltr 
style="PADDING-RIGHT: 0px; PADDING-LEFT: 5px; MARGIN-LEFT: 5px; BORDER-LEFT: #000000 2px solid; MARGIN-RIGHT: 0px">
  <DIV style="FONT: 10pt MS UI Gothic">----- Original Message ----- </DIV>
  <DIV 
  style="BACKGROUND: #e4e4e4; FONT: 10pt MS UI Gothic; font-color: black"><B>From:</B> 
  <A title=kawano@livingston.co.jp href="mailto:kawano@livingston.co.jp">Yoshio 
  Kawano</A> </DIV>
  <DIV style="FONT: 10pt MS UI Gothic"><B>To:</B> <A title=ml@mysql.gr.jp 
  href="mailto:ml@mysql.gr.jp">ml@mysql.gr.jp</A> </DIV>
  <DIV style="FONT: 10pt MS UI Gothic"><B>Sent:</B> Wednesday, September 20, 
  2006 6:28 PM</DIV>
  <DIV style="FONT: 10pt MS UI Gothic"><B>Subject:</B> [mysql 13371] 
  mysqlが起動しない（4.0.26⇒5.0.24a）</DIV>
  <DIV><BR></DIV>
  <DIV><FONT face="MS UI Gothic">お世話になっております。<BR>ykawaです。（OS=Linux）</FONT></DIV>
  <DIV>&nbsp;</DIV>
  <DIV><FONT 
  face="MS UI Gothic">mySQLを4.0.26⇒5.0.24aにUPして、ｍｙSQLを起動しているのですが<BR>失敗に終わってしまいます。</FONT></DIV>
  <DIV>&nbsp;</DIV>
  <DIV><FONT face="MS UI Gothic">お忙しいところ誠に申し訳けありませんが、ご教示をお願い致します。</FONT></DIV>
  <DIV>&nbsp;</DIV>
  <DIV><FONT 
  face="MS UI Gothic">-&lt;/var/localhost.localdomain.errのログ&gt;-------------------------------<BR>060920 
  17:39:08&nbsp; mysqld started<BR>060920 17:39:09&nbsp; InnoDB: Started; log 
  sequence number 8 534940131<BR>060920 17:39:09 [Note] Recovering after a crash 
  using mysql-bin<BR>060920 17:39:09 [Note] Starting crash recovery...<BR>060920 
  17:39:09 [Note] Crash recovery finished.<BR>060920 17:39:09 [Warning] 
  './mysql/host' had no or invalid character set, and default character set is 
  multi-byte, so character column sizes may have changed<BR>060920 17:39:09 
  [Warning] './mysql/user' had no or invalid character set, and default 
  character set is multi-byte, so character column sizes may have 
  changed<BR>060920 17:39:09 [Warning] './mysql/db' had no or invalid character 
  set, and default character set is multi-byte, so character column sizes may 
  have changed<BR>060920 17:39:09 [ERROR] Fatal error: mysql.user table is 
  damaged or in unsupported 3.20 format.<BR>060920 17:39:09&nbsp; mysqld 
  ended<BR>-------------------------------------------------------------</FONT></DIV>
  <DIV>&nbsp;</DIV>
  <DIV><FONT 
  face="MS UI Gothic">※：自分なりに調べた結果、「下記のサイトに書かれている事を実行すれば宜しいのかな」と、思いましたが、英語が苦手であり、実行するのに躊躇しています。<BR>&nbsp;&nbsp;&nbsp; 
  <A 
  href="http://grebowiec.net/2006/08/10/131/">http://grebowiec.net/2006/08/10/131/</A><BR>&nbsp;&nbsp;&nbsp; 
  ここでは、下記のコマンドを実行しろと、言っているようですが、<BR>&nbsp;&nbsp;&nbsp; 
  一時的な対処なのか（毎回、ｍｙSQLを起動する度に、下記のコマンドを実施する必要があるのか？）<BR>&nbsp;&nbsp;&nbsp; 
  恒久的な対処なのか不明です。<BR>-&lt;サイトに掲載されているコマンドを抜粋&gt;------------------------------<BR>mysqld_safe 
  --skip-grant-tables --user=root &amp;<BR>mysql_fix_privilege_tables<BR>pkill 
  mysqld<BR>/etc/init.d/mysqld 
  restart<BR>-------------------------------------------------------------</FONT></DIV>
  <DIV>&nbsp;</DIV>
  <DIV><FONT 
face="MS UI Gothic"><BR></FONT>&nbsp;</DIV></BLOCKQUOTE></BODY></HTML>

