<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:14138</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="14137.html">[前]</a><a href="14139.html">[次]</a><a href="../list/14101-14200.html">[番号順一覧]</a><a href="../thread/14101-14200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:14138
</p>
<div class="header">
<p>
From: &quot;Hiroyuki Yamada&quot; &lt;&quot;Hiroyuki Yamada&quot; &lt;yamahiroyu.y@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 30 Jul 2007 12:21:07 +0900<br>
Subject: [mysql 14138] アプリケーションレベルでの書き込みの分散について<br>

</p>
</div>
<div class="body">
<pre>
MySQLにおける書き込みの分散について質問させてください。

現在、書き込みが多いサーバーを運用しており、
その書き込みをアプリケーションレベルで複数マシンに分散させたいとおもっております。


考えている手段としては、ユーザごとに書き込み先を分散させる方法で、
例えば、

user_id 1-100000 =&gt; マシン1へ書き込み
user_id 100001-200000 =&gt; マシン2へ書き込み

のようなことです。

例えば、２つのテーブルがあるとして、
(現状は、もうちょっと複雑ですが、説明をわかりやすくするために、２つのテーブルで説明します。)

user - ユーザのプロファイル等(書き込み少ない)
user_write - ユーザの書き込み履歴(書き込み多い)

user への書き込みはあまりなく、user_writeへの書き込みがとても多い状況なので、
user_writeのみを分散したいと考えています。


                   --------
                    user
                   --------

     ---------------     ---------------
     user_write1  user_write2
     ---------------     ---------------


この際、user_write1 と user を一貫性を保ったまま更新したい場合は
どのようにするのが一般的でしょうか？
(両方とも成功する必要があり、片方の失敗は許されない)

MySQL5からのtwo phase commit はこのような複数マシンをまたがったような
トランザクションにも対応できるのでしょうか？


よく出てくるmixiの例などは参考にしていますが、
(<a href="http://blog.livedoor.jp/nipotan/archives/50538571.html">http://blog.livedoor.jp/nipotan/archives/50538571.html</a>)
複数マシンへの書き込みに関しては具体的な方法がないので、
ちょっと困っております。


みなさんなら、こういう状況でどうされますでしょうか？
ご教授ください

Hiroyuki Yamada

</pre>
</div>
<p class="button"><a href="14137.html">[前]</a><a href="14139.html">[次]</a><a href="../list/14101-14200.html">[番号順一覧]</a><a href="../thread/14101-14200.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="14138.html">  14138 2007-07-30 12:21 [&quot;Hiroyuki Yamada&quot; &lt;y] アプリケーションレベルでの書き込みの分散について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14142.html">  14142 2007-07-31 15:00 ┣[&quot;T.Hirotsu&quot; &lt;hirotsu]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14143.html">  14143 2007-07-31 18:18 ┣[&quot;Kensuke Kaneko&quot; &lt;ky]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14144.html">  14144 2007-07-31 21:26 ┃┗[&quot;T.Hirotsu&quot; &lt;hirotsu]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14145.html">  14145 2007-07-31 23:53 ┃　┗[&quot;Hiroyuki Yamada&quot; &lt;y]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14151.html">  14151 2007-08-01 12:04 ┗[&lt;ikari-ml@xxxxxxxxxx] [meiwaku#]Re:  アプリケーションレベルでの書き込みの分散について</a></span>
</pre>
</body>
</html>
