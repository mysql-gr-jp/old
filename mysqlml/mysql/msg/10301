<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:10301</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="10300">[前]</a><a href="10302">[次]</a><a href="../list/10301-10400">[番号順一覧]</a><a href="../thread/10301-10400">[スレッド一覧]</a></p>
<p class="id">
mysql:10301
</p>
<div class="header">
<p>
From: T Shimada &lt;T Shimada &lt;t_shimada@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 06 Oct 2004 21:03:58 +0900<br>
Subject: [mysql 10301] MYSQLでXAのJDBCの設定方法について<br>

</p>
</div>
<div class="body">
<pre>

はじめまして。島田です。

 Windows2000+Java1.41+J2sdkee1.3.1+MySQL4.0.21環境で
 jdbc接続する方法についての質問です。

J2EEの環境で、JDBC接続によって
MYSQLのXAのコネクションを使用したいのですが、うまく接続設定できません。

j2eeadminのツールを使って、

resource.propertiesに以下を追加してみました。

jdbcXADataSource.1.name=jdbc/XAMysql
jdbcXADataSource.1.classname=com.mysql.jdbc.jdbc2.optional.
MysqlDataSource
jdbcXADataSource.1.dbpassword=pwd
jdbcXADataSource.1.dbuser=user1
jdbcXADataSource.1.prop.characterEncoding=SJIS
jdbcXADataSource.1.prop.url=jdbc\:mysql\://127.0.0.1/test
jdbcXADataSource.1.prop.useUnicode=true

Mysqlはローカルの testというdatabaseです。
ユーザは、user1でパスワードはpwdです。

また、プログラム側では、

InitialContext initCtx = new InitialContext();
DataSource ds = (DataSource)initCtx.lookup(&quot;jdbc/XAMysql&quot;);
con = ds.getConnection();
stmt = con.createStatement();

と記述しています。

これを実行すると、
con = ds.getConnection()の行で
下記のエラーが発生します。

java.lang.ClassCastException
at com.sun.enterprise.resource.Jdbc20XaAllocator.createResource
(Jdbc20XaAllocator.java:345)
at com.sun.enterprise.resource.PoolManagerImpl.getResourceFromPool
(PoolManagerImpl.java:177)
at com.sun.enterprise.resource.PoolManagerImpl.getResource
(PoolManagerImpl.java:126)
at com.sun.enterprise.resource.JdbcDataSource.internalGetConnection
(JdbcDataSource.java:137)
at com.sun.enterprise.resource.JdbcDataSource.getConnection
(JdbcDataSource.java:51)

DataSourceは、com.sun.enterprise.resource.JdbcDataSourceが取得されている
ようなので
コネクションがうまく取れないようです。

どなたかお分かりになられる方
お教え願います。


</pre>
</div>
<p class="button"><a href="10300">[前]</a><a href="10302">[次]</a><a href="../list/10301-10400">[番号順一覧]</a><a href="../thread/10301-10400">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="10301">  10301 2004-10-06 21:03 [T Shimada &lt;t_shimada] MYSQLでXAのJDBCの設定方法について       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10302">  10302 2004-10-06 23:37 ┗[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10304">  10304 2004-10-07 09:57 　┗[T Shimada &lt;t_shimada]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10305">  10305 2004-10-07 10:23 　　┗[&quot;TAKAHASHI, Tomohiro]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10306">  10306 2004-10-07 13:13 　　　┗[T Shimada &lt;t_shimada]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10307">  10307 2004-10-07 15:13 　　　　┗[&quot;TAKAHASHI, Tomohiro]                               </a></span>
</pre>
</body>
</html>
