<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5967</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5966">[前]</a><a href="5968">[次]</a><a href="../list/5901-6000">[番号順一覧]</a><a href="../thread/5901-6000">[スレッド一覧]</a></p>
<p class="id">
mysql:5967
</p>
<div class="header">
<p>
From: SUGAWARA Hajime &lt;SUGAWARA Hajime &lt;sugawara@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 19 Aug 2002 13:24:54 +0900<br>
Subject: [mysql 05967] Re: Perl + MySQL でのメタ文字の扱い方<br>

</p>
</div>
<div class="body">
<pre>
　菅原です。

<span class="quote1">&gt; また</span>
<span class="quote2">&gt; &gt;   当方、</span>
<span class="quote2">&gt; &gt;     $db-&gt;do(&quot;INSERT INTO $conf{'m_table'} SET no_res=''&quot;);</span>
<span class="quote2">&gt; &gt;   このようにINSERTをしているため、すべてを上記のように変更することが</span>
<span class="quote2">&gt; &gt;   大変なため、</span>
<span class="quote1">&gt; のように、テーブル名にはプレースホルダは使えません。</span>
<span class="quote1">&gt; quoteでもクォートで囲まれますから、自前でエスケープするしかないでしょ</span>
<span class="quote1">&gt; う。</span>
<span class="quote1">&gt; MySQLの場合、prepareされたSQLに与えられたバインド値を</span>
<span class="quote1">&gt; quoteして埋め込んで発行するという仕組みなので、ごまかせるかも</span>
<span class="quote1">&gt; しれませんが。</span>
<span class="quote1">&gt; ＃テーブル名をユーザ入力でっていうのが本当ならばですが。</span>


　マニュアルの6.1.2によると、3.23.6より前のバージョンでは

<span class="quote1">&gt; 名前は、現在の文字セットのアルファベットと数字文字から成り、`_'と`$'も</span>
<span class="quote1">&gt; 含みます。</span>

みたいなので、記号は使えない気がします。

　3.23.6以降は

<span class="quote1">&gt; ファイル名として許されるすべての文字。/ と . を除く。</span>

とのことです。
　なので、サーバで使っているOSがファイル名として「'」等を許していなけれ
ば、それらは使えないでしょう。それに、「/」と「.」はエスケープしても使え
ません。

　また、

<span class="quote1">&gt;  規則はMySQL 3.23.6で変更されました。それは識別子(データベース名、テー</span>
<span class="quote1">&gt;  ブル名、フィールド名)の ``' でのクォートを導入した時です (ANSIモード</span>
<span class="quote1">&gt;  で実行する場合は、&quot; も識別子をクォートするために働きます)。</span>

とのことですので、「`」で括ればエスケープの必要がない*かも*しれません。

　エスケープの有無のいずれにしろ、

<span class="quote1">&gt; 識別子が制限された単語であったり特殊文字を含む場合は、それを使用する時</span>
<span class="quote1">&gt; には常に ` でクォートする必要があります</span>

ですから、常に「`」で括るべきでしょう。
　そうでないと、「select」等のテーブル名を作ろうとして、エラーになるでし
ょうから。


＃もっとも、ユーザーにテーブル名を入れさせる掲示板というのは
＃どうかなぁと思うのですが……。
------
菅原はじめ＠ホビー・データ
sugawara@xxxxxxxxxx

</pre>
</div>
<p class="button"><a href="5966">[前]</a><a href="5968">[次]</a><a href="../list/5901-6000">[番号順一覧]</a><a href="../thread/5901-6000">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5957">   5957 2002-08-18 21:58 [TATSUYA &lt;tatsuya@xxx] Re: Perl + MySQL でのメタ文字の扱い方   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5962">   5962 2002-08-19 06:24 ┗[&quot;KAWAI,Takanori&quot; &lt;GC]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="5967">   5967 2002-08-19 13:24 　┗[SUGAWARA Hajime &lt;sug]                                     </a></span>
</pre>
</body>
</html>
