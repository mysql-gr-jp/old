<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5160</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5159">[前]</a><a href="5161">[次]</a><a href="../list/5101-5200">[番号順一覧]</a><a href="../thread/5101-5200">[スレッド一覧]</a></p>
<p class="id">
mysql:5160
</p>
<div class="header">
<p>
From: &quot;AN/NaNa_レディス_メンズ_ダンス&quot; &lt;&quot;AN/NaNa_レディス_メンズ_ダンス&quot; &lt;an-nana@xxxxxxxxxx&gt;&gt;<br>
Date: Sat, 16 Feb 2002 16:11:18 +0900<br>
Subject: [mysql 05160] MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？<br>

</p>
</div>
<div class="body">
<pre>

皆様はじめまして。
今度新しくこのMLに参加させていただきます
竹内といいます。
MySQL、Accessともに初心者です。
いきなりで恐縮ですが、質問をさせていただきたく
投稿しました。よろしくお願いします。

（環境はAccess2000+Win98無印、
  mysql-3.23.36-win + myodbc-2.50.29-win95
  です。）

現在「MySQL活用ガイド」という書籍にて、MS-Accessから
のMySQLへのアクセスについて勉強中です。

そこで質問なのですが、MyODBCを使ってDAOでテーブルに
アクセスし、データの更新やレコードの新規追加をしよう
とした場合、ロックはAccess既定のロックが適用されるの
でしょうか？
それともそれは無視されて、ロックがかからない状態
になっているのでしょうか？

今現在、以下のコードでテーブルデータの更新等が可能だ
ということまではわかりましたが、ロックが実際のところ
どのようになっているかがわかりません。

***************************************************

Dim db As DAO.Database
Dim rs As DAO.Recordset

Set db = CurrentDb
Set rs = db.OpenRecordset(&quot;msg&quot;, dbOpenDynaset)

rs.LockEdits = True     ’排他ロックを発生させる設定に。

    rs.Edit                  ’実ロック発生。でも本当にロックが
                              ’かかっているのでしょうか？
        rs!入庫 = 3

    rs.Update             ’実ロック解除？


Set rs = Nothing
Set db = Nothing

***************************************************


上記コードで本当にロックがかかっているか？を調べるために、
「MsgBox &quot;stop&quot;」という１行を「rs!入庫 = 3」の行
の次に追加してから実行し、その後、他のmdbから上記
と同じコードで同じテーブルにアクセスしたところ、書き
換えができてしまいました。
（例えば”他のユーザーがアクセス中”などのエラーが出ない。）

「MsgBox &quot;stop&quot;」を「rs.Update」行に移動させて
実行しても同じ結果でした。

***************************************************

テーブルの構成は以下のとおりです。

テーブル名:msg

フィールド設定：                                       Null  Default
serial （int(11)PrimaryKey/auto_increment）            Null
mdate  （timeStamp(14)）                           Yes     Null
txt     (varchar(255))                                Yes     Null
入庫   （int(11))                                       Yes     Null
売上   （int(11))                                       Yes     Null
在庫   （int(11))                                       Yes     Null

ODBCアドミニストレーターの「システムDNS」にて
「TEST2」という名前でアクセスしています。
ユーザーIDやパスワードは設定していません。
また、テーブルはリンクテーブルとして設定し、
アクセスしています。

mdb側のオプションのロック設定は既定、排他モード両方
試しました。（こちらの設定はフォームやテーブルの
データシートビューに対してだけなのでしょうか？）

また、MyODBCのバージョンに関係があるのかな？と思い、
myodbc-2.50.39-win95でも試してみましたが結果は
同じでした。


***************************************************

ざっと、以上のような状況でして、
チェックの仕方が悪いのか、それともロックがかかって
いないのか？判断しかねています。

何か良い判断方法、チェック方法がありましたら、何卒
ご教授ください。また、正しいロックのかけ方が他にある
のならそちらもお教え頂けませんでしょうか？
もしくは、「MyODBC経由ではロックはかからない」などの
情報でも結構です。

よろしくお願いいたします。


***************************************************
（株）ロダン AN／NaNa 竹内 理
***************************************************



</pre>
</div>
<p class="button"><a href="5159">[前]</a><a href="5161">[次]</a><a href="../list/5101-5200">[番号順一覧]</a><a href="../thread/5101-5200">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5157">   5157 2002-02-15 22:34 [Shin-ichi Tsurunaga ] オフ会総括                              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5158">   5158 2002-02-16 00:10 ┣[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5159">   5159 2002-02-16 09:30 ┣[遠藤 俊裕 &lt;endo_t@xx]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="5160">   5160 2002-02-16 16:11 ┃┣[&quot;AN/NaNa_レディス_メ] MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5165">   5165 2002-02-17 09:10 ┃┃┗[Kengo Jinno &lt;kengo@x]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5184">   5184 2002-02-20 10:51 ┃┃　┗[&quot;AN/NaNa_レディス_メ] [ お礼 ]MyODBC  経由・ Access  の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5185">   5185 2002-02-20 16:39 ┃┃　　┗[&quot;AN/NaNa_レディス_メ] [ できました ]MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5161">   5161 2002-02-16 17:50 ┃┗[&quot;Y. Tsutsui&quot; &lt;tutui@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5171">   5171 2002-02-17 14:16 ┃　┣[とみたまさひろ &lt;tomm]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5180">   5180 2002-02-18 13:01 ┃　┃┗[遠藤 俊裕 &lt;endo_t@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5172">   5172 2002-02-17 14:50 ┃　┗[Hidesuke Shimada &lt;hi]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5166">   5166 2002-02-17 10:23 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
</pre>
</body>
</html>
