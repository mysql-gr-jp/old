<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12912</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="12911">[前]</a><a href="12913">[次]</a><a href="../list/12901-13000">[番号順一覧]</a><a href="../thread/12901-13000">[スレッド一覧]</a></p>
<p class="id">
mysql:12912
</p>
<div class="header">
<p>
From: Yasufumi Kinoshita &lt;Yasufumi Kinoshita &lt;kinoshita.yasufumi@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 04 Apr 2006 18:00:01 +0900<br>
Subject: [mysql 12912] Re: バイナリログからのデータの復旧<br>

</p>
</div>
<div class="body">
<pre>
こういうことでしょうか？

<a href="http://lists.mysql.com/mysql-ja/184">http://lists.mysql.com/mysql-ja/184</a>
（リカバリーの節）

間違っていたらすみません。
バージョンによってはオプションの綴りが違うかもしれません。
マニュアルでご確認を。

Kenta Hashimoto wrote:
<span class="quote1">&gt; 橋本です。</span>
<span class="quote1">&gt; いつも、お世話になっております。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; バイナリログからのデータの復旧に関して質問です。</span>
<span class="quote1">&gt; バイナリログから、データを復旧する場合、レプリケーションの</span>
<span class="quote1">&gt; Exec_Master_Log_Posを利用して、途中から適用するできますでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 今、ＤＢのバックアップを取る仕組みを構築しています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 誤ってデータを消してしまったなどの障害が起きた場合に、</span>
<span class="quote1">&gt; 一日に一度とってある、mysqldumpしたファイルを、mysqlに流し込む</span>
<span class="quote1">&gt; 形で、復旧するところまではできています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; これに加えて、さらに、バックアップをとった後に走ったクエリからも、</span>
<span class="quote1">&gt; データを復旧したいと思っているのですが、そこで詰まっています。</span>
<span class="quote1">&gt; アドバイスをいただけるとありがたいです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; バックアップは、以下の手順を自動化して、とっています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; １．レプリケーションのスレーブを、STOP SLAVEする。</span>
<span class="quote1">&gt; ２．FLUSH TABLESする</span>
<span class="quote1">&gt; ３．relay-log.info の、Master_Log_Fileと、Exec_Master_Log_Posを保存する</span>
<span class="quote1">&gt; ４．mysqldumpで、バックアップを取る。</span>
<span class="quote1">&gt; ５．レプリケーションを再開する。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; これで、データを消してしまった場合などには、このダンプファイルの時点の</span>
<span class="quote1">&gt; データまでは復元できます。</span>
<span class="quote1">&gt; ダンプファイルの時点まで復元した後、バイナリログからも復元したいのですが、</span>
<span class="quote1">&gt; その場合は、ダンプファイルを取った時点よりも後のものだけを適用したいのです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; mysqlbinlogには、positionという引数があるようなのですが、これは、</span>
<span class="quote1">&gt; バイナリログ内での場所であって、レプリケーションのExec_Master_Log_Posとは</span>
<span class="quote1">&gt; 別のもののようです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; こういう場合は、皆さんはどうしていらっしゃるのでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ・Exec_Master_Log_Posをもとにmysqlbinlogを使用する方法がある？</span>
<span class="quote1">&gt; ・バックアップを取るときに、マスターを一度とめて、その時点でのバイナリログの場所を、</span>
<span class="quote1">&gt; 　なんらかの方法で記録する？</span>
<span class="quote1">&gt; ・バックアップを取るときに、バイナリログのファイルを新しいものにする方法がある？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; などのことを考え、調べたのですが、結局見つかりませんでした。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; よろしくお願いいたします。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>


</pre>
</div>
<p class="button"><a href="12911">[前]</a><a href="12913">[次]</a><a href="../list/12901-13000">[番号順一覧]</a><a href="../thread/12901-13000">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="12908">  12908 2006-04-03 16:42 [&quot;Kenta Hashimoto&quot; &lt;k] バイナリログからのデータの復旧          </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12909">  12909 2006-04-03 17:01 ┣[&quot;F.Y&quot; &lt;fumi_sby@xxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12910">  12910 2006-04-03 17:36 ┃┗[&quot;Kenta Hashimoto&quot; &lt;k]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="12912">  12912 2006-04-04 18:00 ┗[Yasufumi Kinoshita &lt;]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12916">  12916 2006-04-05 16:39 　┗[&quot;Kenta Hashimoto&quot; &lt;k]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12924">  12924 2006-04-12 15:29 　　┗[Katsuyuki Sakai &lt;sak]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12929">  12929 2006-04-19 17:40 　　　┗[Katsuyuki Sakai &lt;sak]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12930">  12930 2006-04-20 11:28 　　　　┗[&quot;Kenta Hashimoto&quot; &lt;k]                               </a></span>
</pre>
</body>
</html>
