<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5997</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5996.html">[前]</a><a href="5998.html">[次]</a><a href="../list/5901-6000.html">[番号順一覧]</a><a href="../thread/5901-6000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5997
</p>
<div class="header">
<p>
From: "Yoshitaka Ichikawa" &lt;"Yoshitaka Ichikawa" &lt;y_ichikawa@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 27 Aug 2002 13:05:14 +0900<br>
Subject: [mysql 05997] VB から LOAD DATA が使えません<br>

</p>
</div>
<div class="body">
<pre>こんにちは、市川と申します。

●システム情報
サーバー　OS:W2K Server　MySQL:3.23.49
クライアント　OS：W2K Professional　MySQLODBCドライバ:3.51

●プログラムの内容
AS/400から出力されるCSV・XLS形式のファイルを共有フォルダ（例：
\\192.168.0.1\webdb\）から取得し、下記の処理を行いMySQLにインポートする処理
を行います。
それから、MySQLサーバーは、このEXEを実行するPCとは別のPCで稼動しています。

・ファイル変換
XLS　→　CSV

・文書整形
1.英数　→　全て半角
2.カナ　→　全て全角
3.㈱　　→　（株）
4.半角「・」　→　全角「・」
5.機種依存文字　→　非機種依存文字

・変数等
OUT_FILE = API(Temp) &amp; "\outfile.txt"
Chr(&amp;H22) →　'”'ダブルコーテーション

●SQLのコマンド
load_co.Execute "load data local infile '" &amp; OUT_FILE &amp; "' into table
meigara fields terminated by ',' enclosed by '" &amp; Chr(&amp;H22) &amp; "' lines
terminated by '\r\n';"

●実行時エラー'-2147467259(80004005)':
[MySQL][ODBC 3.51 Driver][mysqld-3.23.49-nt]The used command is not allowed
with MySQL Version

因みに、「かねやんMySQLAdmin」というフリーの管理ソフトで、このSQLコマンドを
SQL発行ウインドウで実行した結果、正常にインポートすることができました。
<a href="http://www.mmdb.net/m_kaneko/">http://www.mmdb.net/m_kaneko/</a>

お手数ですが、よろしくお願い致します。



</pre>
</div>
<p class="button"><a href="5996.html">[前]</a><a href="5998.html">[次]</a><a href="../list/5901-6000.html">[番号順一覧]</a><a href="../thread/5901-6000.html">[スレッド一覧]</a></p>


</body></html>