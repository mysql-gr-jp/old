<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:10371</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="10370">[前]</a><a href="10372">[次]</a><a href="../list/10301-10400">[番号順一覧]</a><a href="../thread/10301-10400">[スレッド一覧]</a></p>
<p class="id">
mysql:10371
</p>
<div class="header">
<p>
From: &quot;Kageyama Takahiro&quot; &lt;&quot;Kageyama Takahiro&quot; &lt;kageyama329@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 01 Nov 2004 13:04:59 +0900<br>
Subject: [mysql 10371] 複数のデータベースに対して、集計する方法<br>

</p>
</div>
<div class="body">
<pre>
お世話になります、景山と申します。

現在使っているデータベースと、それを以前バックアップしたデータベースの
両方のある列のデータに対して、グループに集合を分け、各グループについて
集計するにはどのようにしたら良いのでしょうか？

片方のデータベースに対してのみの場合でしたら、

SELECT 列１, COUNT(列１) FROM DB1.TEST GROUP BY 列１;

+------+-------------+
<span class="quote1">| 列１ | COUNT(列１) |</span>
+------+-------------+
<span class="quote1">| AAA  |         100 |</span>
<span class="quote1">| BBB  |         100 |</span>
+------+-------------+

SELECT 列１, COUNT(列１) FROM DB2.TEST GROUP BY 列１;

+------+-------------+
<span class="quote1">| 列１ | COUNT(列１) |</span>
+------+-------------+
<span class="quote1">| AAA  |          20 |</span>
<span class="quote1">| BBB  |          20 |</span>
<span class="quote1">| CCC  |          20 |</span>
+------+-------------+

とすればできますが、両方のデータベースに対して
１回で取得しようとすると、

SELECT 列１, COUNT(列１) FROM DB1.TEST GROUP BY 列１
UNION
SELECT 列１, COUNT(列１) FROM DB2.TEST GROUP BY 列１;

+------+-------------+
<span class="quote1">| 列１ | COUNT(列１) |</span>
+------+-------------+
<span class="quote1">| AAA  |         100 |</span>
<span class="quote1">| BBB  |         100 |</span>
<span class="quote1">| AAA  |          20 |</span>
<span class="quote1">| BBB  |          20 |</span>
<span class="quote1">| CCC  |          20 |</span>
+------+-------------+

となってしまいます。どうすれば、

+------+-------------+
<span class="quote1">| 列１ | COUNT(列１) |</span>
+------+-------------+
<span class="quote1">| AAA  |         120 |</span>
<span class="quote1">| BBB  |         120 |</span>
<span class="quote1">| CCC  |          20 |</span>
+------+-------------+

とすることが出来ますでしょうか？


ご存知の方がいらっしゃいましたら、ご教授願いますでしょうか。

_________________________________________________________________
楽しい絵文字でココロ伝わるメッセンジャー <a href="http://messenger.msn.co.jp/">http://messenger.msn.co.jp/</a> 


</pre>
</div>
<p class="button"><a href="10370">[前]</a><a href="10372">[次]</a><a href="../list/10301-10400">[番号順一覧]</a><a href="../thread/10301-10400">[スレッド一覧]</a></p>
</body>
</html>
