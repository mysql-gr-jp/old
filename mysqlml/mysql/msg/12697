<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12697</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="12696">[前]</a><a href="12698">[次]</a><a href="../list/12601-12700">[番号順一覧]</a><a href="../thread/12601-12700">[スレッド一覧]</a></p>
<p class="id">
mysql:12697
</p>
<div class="header">
<p>
From: 佐野大輔 &lt;佐野大輔 &lt;d-sano@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 01 Feb 2006 23:04:27 +0900<br>
Subject: [mysql 12697] Re: テーブルを結合するSQL<br>

</p>
</div>
<div class="body">
<pre>
さのと言います。

tbl2.keyではなくtbl1.keyでgroup byすれば良いです。

kero wrote:
<span class="quote1">&gt; お世話になります。keroといいます。</span>
<span class="quote1">&gt; 2つのテーブルを結合して表示したいのですが、うまくいきません。</span>
<span class="quote1">&gt; 単純なSQLの問題で、MySQL固有ではないのですがご教示願えませんでしょうか。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; テーブル構成は以下のtbl1とtbl2があり、tbl1のkey、tbl2のidが主キーになり、</span>
<span class="quote1">&gt; tbl2.keyがtbl1.keyに関連付けられています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; tbl1</span>
<span class="quote1">&gt; +------+------+</span>
<span class="quote2">&gt; | key  | name |</span>
<span class="quote1">&gt; +------+------+</span>
<span class="quote2">&gt; | aa   | 1234 |</span>
<span class="quote2">&gt; | bb   | 2345 |</span>
<span class="quote2">&gt; | cc   | 3456 |</span>
<span class="quote2">&gt; | dd   | 4567 |</span>
<span class="quote2">&gt; | ee   | 5678 |</span>
<span class="quote2">&gt; | ff   | 6789 |</span>
<span class="quote1">&gt; +------+------+</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; tbl2</span>
<span class="quote1">&gt; +----+------+</span>
<span class="quote2">&gt; | id | key  |</span>
<span class="quote1">&gt; +----+------+</span>
<span class="quote2">&gt; |  1 | aa   |</span>
<span class="quote2">&gt; |  2 | aa   |</span>
<span class="quote2">&gt; |  3 | aa   |</span>
<span class="quote2">&gt; |  4 | bb   |</span>
<span class="quote2">&gt; |  5 | bb   |</span>
<span class="quote2">&gt; |  6 | cc   |</span>
<span class="quote1">&gt; +----+------+</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 希望としては以下のような結果（tbl2をkeyでグループ化しておのおのの行数を取得</span>
<span class="quote1">&gt; し、tbl1と結合）を得たいと思っています。</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote2">&gt; | key  | count(id) |</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote2">&gt; | dd   |         0 |</span>
<span class="quote2">&gt; | ee   |         0 |</span>
<span class="quote2">&gt; | ff   |         0 |</span>
<span class="quote2">&gt; | aa   |         3 |</span>
<span class="quote2">&gt; | bb   |         2 |</span>
<span class="quote2">&gt; | cc   |         1 |</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 以下のようなSQLを記述したのですが、</span>
<span class="quote1">&gt; select tbl1.key,count(id) from tbl1 left outer join tbl2 on tbl1.key=tbl2.key </span>
<span class="quote1">&gt; group by tbl2.key;</span>
<span class="quote1">&gt; このような結果になってしまいます。</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote2">&gt; | key  | count(id) |</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote2">&gt; | dd   |         0 |</span>
<span class="quote2">&gt; | aa   |         3 |</span>
<span class="quote2">&gt; | bb   |         2 |</span>
<span class="quote2">&gt; | cc   |         1 |</span>
<span class="quote1">&gt; +------+-----------+</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 希望する結果を得るためにはどのようなSQLを書けばよろしいでしょうか。</span>
<span class="quote1">&gt; ご教示下さい。</span>
<span class="quote1">&gt; どうぞよろしくお願いします。</span>
<span class="quote1">&gt; </span>

</pre>
</div>
<p class="button"><a href="12696">[前]</a><a href="12698">[次]</a><a href="../list/12601-12700">[番号順一覧]</a><a href="../thread/12601-12700">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="12697">  12697 2006-02-01 23:04 [佐野大輔 &lt;d-sano@xxx] Re: テーブルを結合するSQL               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12701">  12701 2006-02-02 10:01 ┗[kero &lt;info@xxxxxxxxx]                                       </a></span>
</pre>
</body>
</html>
