<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8833</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="8832.html">[前]</a><a href="8834.html">[次]</a><a href="../list/8801-8900.html">[番号順一覧]</a><a href="../thread/8801-8900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:8833
</p>
<div class="header">
<p>
From: &lt;lavlav@xxxxxxxxxx&gt;<br>
Date: Fri, 20 Feb 2004 17:48:40 +0900<br>
Subject: [mysql 08833] <br>

</p>
</div>
<div class="body">
<pre>こんにちわ。
近藤と言います。

かなり複雑なSQL文がどうしても組めず２日と11時間ぐらい悩んでおります....

CREATE TABLE mail_tb (
  mail_id bigint(20) unsigned NOT NULL auto_increment,
  mail_from_master_id bigint(20) unsigned NOT NULL default '0',
  mail_to_master_id bigint(20) unsigned NOT NULL default '0',
  mail_subject varchar(31) NOT NULL default '',
  mail_message text NOT NULL,
  mail_datetime datetime NOT NULL default '0000-00-00 00:00:00',
  KEY mail_id (mail_id)
) TYPE=MyISAM;

CREATE TABLE date_tb (
  date_id bigint(20) unsigned NOT NULL auto_increment,
  date_name date NOT NULL default '0000-00-00',
  KEY date_id (date_id)
) TYPE=MyISAM;


CREATE TABLE master_tb (
  master_id bigint(20) unsigned NOT NULL auto_increment,
  master_group_id bigint(20) unsigned NOT NULL default '0',
  master_flag tinyint(1) unsigned NOT NULL default '0',
  KEY master_id (master_id)
) TYPE=MyISAM;

この様なDBがあり、master_staff_id と 日付の範囲(*1)をフォームから送信して結果的に、

   DATE      |   0時 |   1時 |   2時 |   3時 | ・・・
----------+-----------------------------------------------------------------------
2004-02-01 |     2 |       3 |      6 |     10 | ・・・
----------+-----------------------------------------------------------------------
2004-02-02 |     8 |       0 |      2 |       4 | ・・・
----------+-----------------------------------------------------------------------
2004-02-03 |     5 |       2 |      3 |       7 | ・・・
----------+-----------------------------------------------------------------------
2004-02-04 |     8 |       2 |      2 |       0 | ・・・

(*1) 上記の表だとフォームから送信された値は、040201 と 040204 になります。

の様に、日付、時間別に送信数、受信数を出したいのです。

master_group_id とはそのまんまグループであり、グループ毎にmaster_tbにユーザーが複数います。
その複数のメールのやりとりを合計して集計したいのです。

# 正規化がちゃんと出来てないから難しくなってるだけ？

また、現時点で当方よりお見せ出来るSQLが出来ておりません。
IF()の多様かな？と思って頭の中で考えてはいるのですが、正直分からずじまいです。

アドバイス頂けたら幸いです。
宜しくお願い致します。



</pre>
</div>
<p class="button"><a href="8832.html">[前]</a><a href="8834.html">[次]</a><a href="../list/8801-8900.html">[番号順一覧]</a><a href="../thread/8801-8900.html">[スレッド一覧]</a></p>
<pre class="list"><span class="current">-&gt;&nbsp;<a href="8833.html">   8833 2004-02-20 17:48 [&lt;lavlav@xxxxxxxxxx&gt; ]                                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8834.html">   8834 2004-02-20 17:55 ┣[&lt;lavlav@xxxxxxxxxx&gt; ] Re: SQL 文について                    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8836.html">   8836 2004-02-20 18:09 ┣[遠藤 俊裕 &lt;endo_t@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8839.html">   8839 2004-02-20 18:40 ┃┗[&lt;lavlav@xxxxxxxxxx&gt; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8841.html">   8841 2004-02-20 20:23 ┃　┣[&lt;numata@xxxxxxxxxx&gt; ]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8844.html">   8844 2004-02-21 04:51 ┃　┣[Kazuhiro Yoshida &lt;mo]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8846.html">   8846 2004-02-21 14:24 ┃　┃┗[&lt;konet218@xxxxxxxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8849.html">   8849 2004-02-21 17:59 ┃　┃　┣[Kazuhiro Yoshida &lt;mo]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8850.html">   8850 2004-02-21 18:38 ┃　┃　┃┗[&lt;konet218@xxxxxxxxxx]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8852.html">   8852 2004-02-22 02:22 ┃　┃　┃　┗[Kazuhiro Yoshida &lt;mo]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8855.html">   8855 2004-02-22 16:11 ┃　┃　┗["katayose" &lt;katayose]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8857.html">   8857 2004-02-23 02:03 ┃　┃　　┗[ML account &lt;ml@xxxxx]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8847.html">   8847 2004-02-21 15:16 ┃　┗[ML account &lt;ml@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8848.html">   8848 2004-02-21 17:18 ┃　　┗[&lt;konet218@xxxxxxxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8838.html">   8838 2004-02-20 18:15 ┗[Shingo Yamagai &lt;yama] Re: SQL 文について                    </a></span>
</pre>


</body></html>