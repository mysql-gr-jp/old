<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5185</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5184.html">[前]</a><a href="5186.html">[次]</a><a href="../list/5101-5200.html">[番号順一覧]</a><a href="../thread/5101-5200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5185
</p>
<div class="header">
<p>
From: &quot;AN/NaNa_レディス_メンズ_ダンス&quot; &lt;&quot;AN/NaNa_レディス_メンズ_ダンス&quot; &lt;an-nana@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 20 Feb 2002 16:39:01 +0900<br>
Subject: [mysql 05185] [ できました ]MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？<br>

</p>
</div>
<div class="body">
<pre>
竹内です。

あれからいろいろと試していたら、DAOではなく、
ADOでやったらなんとか（？）できましたのでご報告致します。

以下のようなコードです。

**************************************************

Dim cnt As ADODB.Connection
Dim rst As ADODB.Recordset
Dim sql As String

Set cnt = CreateObject(&quot;ADODB.Connection&quot;)
Set rst = CreateObject(&quot;ADODB.RecordSet&quot;)


cnt.Open &quot;TEST&quot;                  'システムDSN名
sql = &quot;SELECT * FROM msg&quot;
rst.Open sql, cnt, adOpenKeyset, adLockOptimistic

cnt.Execute (&quot;LOCK TABLES msg WRITE&quot;)

    MsgBox &quot;stop&quot;

    rst!入庫 = 5                 '編集
    rst.Update                   '更新

cnt.Execute (&quot;Unlock TABLES&quot;)


Set rst = Nothing
Set cnt = Nothing

End Sub


**************************************************



test1.mdbで上記コードを実行し、「MsgBox &quot;stop&quot;」行で実行を
一時中断後、他のmdb（test2.mdb）から「msg」テーブルを開こう
としたら、ちゃんとロックがかかったのか（？）開けませんでした。
（半開き状態…とりあえず開くが空白状態になって固まる）

その後、test1.mdbでメッセージボックスの「OK」ボタンを押した
ら、そのあとにtest2.mdbテーブルの内容が見えました。
（コードどおりデータが書き換え・更新された状態で）

以上です。

神野様、ヒントを与えてくださって本当にありがとうございました。

なお、引き続き、もし上記コードにまずい部分がありましたら教えて
ください。運良くできただけなので、いまいち自分自身がきちんと
わかってないのです。
「この書き方じゃあこんなときにまずいよ！」なんてことがもしありま
したらご教示よろしくお願い致します。


***************************************************
（株）ロダン AN／NaNa 竹内 理
***************************************************







</pre>
</div>
<p class="button"><a href="5184.html">[前]</a><a href="5186.html">[次]</a><a href="../list/5101-5200.html">[番号順一覧]</a><a href="../thread/5101-5200.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5157.html">   5157 2002-02-15 22:34 [Shin-ichi Tsurunaga ] オフ会総括                              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5158.html">   5158 2002-02-16 00:10 ┣[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5159.html">   5159 2002-02-16 09:30 ┣[遠藤 俊裕 &lt;endo_t@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5160.html">   5160 2002-02-16 16:11 ┃┣[&quot;AN/NaNa_レディス_メ] MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5165.html">   5165 2002-02-17 09:10 ┃┃┗[Kengo Jinno &lt;kengo@x]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5184.html">   5184 2002-02-20 10:51 ┃┃　┗[&quot;AN/NaNa_レディス_メ] [ お礼 ]MyODBC  経由・ Access  の DAO でロックはかけられるのでしょうか？</a></span>
<span class="current">-&gt;&nbsp;<a href="5185.html">   5185 2002-02-20 16:39 ┃┃　　┗[&quot;AN/NaNa_レディス_メ] [ できました ]MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5161.html">   5161 2002-02-16 17:50 ┃┗[&quot;Y. Tsutsui&quot; &lt;tutui@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5171.html">   5171 2002-02-17 14:16 ┃　┣[とみたまさひろ &lt;tomm]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5180.html">   5180 2002-02-18 13:01 ┃　┃┗[遠藤 俊裕 &lt;endo_t@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5172.html">   5172 2002-02-17 14:50 ┃　┗[Hidesuke Shimada &lt;hi]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5166.html">   5166 2002-02-17 10:23 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
</pre>
</body>
</html>
