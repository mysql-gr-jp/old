<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8199</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="8198.html">[前]</a><a href="8200.html">[次]</a><a href="../list/8101-8200.html">[番号順一覧]</a><a href="../thread/8101-8200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:8199
</p>
<div class="header">
<p>
From: &lt;yimamura@xxxxxxxxxx&gt;<br>
Date: Wed, 10 Sep 2003 09:53:16 +0900<br>
Subject: [mysql 08199] MyODBC+ADO で Update 出来ない<br>

</p>
</div>
<div class="body">
<pre>
IMAMURAと申します。

以下の環境で、ADOのレコードセットを使用してレコードの更新をしようと思って
いるのですが、「更新する行がみつからなかったため、クエリーベースの更新に
失敗しました」というエラーが出てしまいます。

テーブル（フィールド）によっては正常に更新されるのですが、駄目な場合はど
うやってもエラーが出ます。

<a href="http://www.hi-ho.ne.jp/tsumiki/book_sup1.html">http://www.hi-ho.ne.jp/tsumiki/book_sup1.html</a>の情報を元に、
ODBCドライバの「Return matching rows」オプションはチェックしています。

解決方法をご教授いただけないでしょうか？

環境：
Win2000Server + SP3
IIS 5.0(ASP)
MySQL 4.0.12
MyODBC 3.51
MDAC 2.8

Set oConn = Server.CreateObject(&quot;ADODB.Connection&quot;)
oConn.Open gCONSTR, &quot;&quot;, &quot;&quot;
Set oRst = Server.CreateObject(&quot;ADODB.Recordset&quot;)
sSQL = &quot;SELECT * FROM TEST WHERE ID = 1&quot;
oRst.Open sSQL, oConn, 0, 3
oRst(&quot;COL1&quot;)=&quot;hoge&quot;
oRst(&quot;COL2&quot;)=&quot;hoge&quot;
oRst.Update   ←ここでエラーになります
oRst.Close
oConn.Close
Set oRst=Nothing
Set oConn=Nothing


</pre>
</div>
<p class="button"><a href="8198.html">[前]</a><a href="8200.html">[次]</a><a href="../list/8101-8200.html">[番号順一覧]</a><a href="../thread/8101-8200.html">[スレッド一覧]</a></p>
</body>
</html>
