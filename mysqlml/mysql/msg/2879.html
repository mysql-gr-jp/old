<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:2879</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="2878.html">[前]</a><a href="2880.html">[次]</a><a href="../list/2801-2900.html">[番号順一覧]</a><a href="../thread/2801-2900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:2879
</p>
<div class="header">
<p>
From: 田辺 敬勝 &lt;田辺 敬勝 &lt;norikatu@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 18 Dec 2000 11:06:38 +0900<br>
Subject: [mysql 02879] RubyforWin32 の使い方について<br>

</p>
</div>
<div class="body">
<pre>
田辺と申します　宜しくお願い致します。

初歩的な事なのかもしれませんが、解らないので質問させて頂きた
いと思います。

現在Ruby　on　Windows海賊課のページ
<a href="http://www.geocities.co.jp/SiliconValley-Bay/4076/">http://www.geocities.co.jp/SiliconValley-Bay/4076/</a>

より、mswin32最新版のバイナリファイルをダウンロードして使用
しております。

<a href="http://www.softagency.co.jp/mysql/Win/ruby/mysql_win.html">http://www.softagency.co.jp/mysql/Win/ruby/mysql_win.html</a>
ページのMySQL-rubyをWindows上でのページで、MySQL-rubyが
Windowsで使用出来る事が解り、早速 mysql-ruby-2.3.0.lzh :
mysql-ruby-2.3.0 ONLY (2000-09-06) ( 138725 bytes )
をダウンロードして解凍後　展開されて出来たmysql.dllをWindows
rubyの\lib\ruby\1.6\i586-mswinに放り込んで、実行してみました。

−−実行したスクリプト
#!/usr/local/bin/ruby

require &quot;mysql&quot;

host = &quot;192.168.xxx.yyy&quot;
user = &quot;UserName&quot;
pass = &quot;Password&quot;

m = Mysql.new(host, user, pass)

  printf &quot;-----&lt;list_dbs&gt;--------\n&quot;
    m.list_dbs.each do |db|
        printf &quot;*(%-s)\n&quot;,db
  end

すると
C:/usr/local/ruby-mswinkaizoku/bin 80&gt; ./ruby.mswin32.exe mysqltest.rb
LoadLibraryExA: C:/usr/local/ruby-mswinkaizoku/lib/ruby/1.6/i586-mswin32/mysql.d
ll
mysqltest.rb:3:in `require': 126: 指定されたモジュールが見つ
かりません。 - C:/usr/
local/ruby-mswinkaizoku/lib/ruby/1.6/i586-mswin32/mysql.dll (LoadError)
        from mysqltest.rb:3

とエラーになってしまって実行出来ません。
（環境はWindowsNT4.0SP6　shellはWcshと言う物を使っております。）

その後pathの問題かな？とruby -e 'p $LOAD_PATH'でpathを調べて
見ましたが、mysql,dllは$LOAD_PATHに表示されるPATHに入ってお
ります。

その後、同ページの ruby本体+mysqlモジュール：ruby-1.4.2.lzh
: ruby-1.4.2 with mysql-ruby-2.2.0 (1999-11-25) (977039bytes)
をダウンロードして展開して、上記でエラーになったスクリプトを
実行すると、問題無くデータベースの一覧が表示される事を確認し
ました。


実行方法が悪いと思うのですが、自分には何が悪いのかさっぱり解
りません、MSCを持っていないのとC言語が解らないので、自分でソー
スから．．と言う訳にも行かず、メーリングリストで質問させて頂
きました。

御教授、宜しくお願い致します

−−−−−−−−−−−−−−−−−−−−
//	Name　：Norikatu Tanabe
//Mail（会社）norikatu@xxxxxxxxxx
//Mail（自宅）tanabjm@xxxxxxxxxx
−−−−−−−−−−−−−−−−−−−−


</pre>
</div>
<p class="button"><a href="2878.html">[前]</a><a href="2880.html">[次]</a><a href="../list/2801-2900.html">[番号順一覧]</a><a href="../thread/2801-2900.html">[スレッド一覧]</a></p>
</body>
</html>
