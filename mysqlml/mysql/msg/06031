<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6031</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6030">[前]</a><a href="6032">[次]</a><a href="../list/6001-6100">[番号順一覧]</a><a href="../thread/6001-6100">[スレッド一覧]</a></p>
<p class="id">
mysql:6031
</p>
<div class="header">
<p>
From: Torii &lt;Torii &lt;torii@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 29 Aug 2002 19:22:35 +0900<br>
Subject: [mysql 06031] ADO で集計関数<br>

</p>
</div>
<div class="body">
<pre>
はじめまして、鳥居と申します。
早速の質問で申し訳ありませんが、何かヒントでもあればと
投稿いたしました。

現在、Windows2000 server、IIS、MySQL、MyODBCという組み合わせで
ASPによるシステムを組んでいます。

ここで、

　　　SELECT Sum(Field1) FROM Table1 ORDER BY Field2

というフィールド値を合計するSQL文はちゃんと動作するのですが、

　　　SELECT Count(Field1) FROM Table1 ORDER BY Field2

という件数をカウントするSQL文は、レコードセットの
EOFがTrueになってしまい、件数が取得できません。

確認したら、MaxもMinもEOFがTrueになってしまいました。

サーバーのDOSプロンプトでmysqlコマンドを起動して直接
上記SQL文を入力するとちゃんと動作します。

以下にソースを抜粋しておきます。
set cn=Server.CreateObject(&quot;ADODB.Connection&quot;)
set rs=Server.CreateObject(&quot;ADODB.Recordset&quot;)
cn.Open database
SQL = &quot;select count(Field1) from Table1 group by Field2&quot;
rs.Open SQL, cn, 3, 1

どなたかお心あたり、ございませんでしょうか？




</pre>
</div>
<p class="button"><a href="6030">[前]</a><a href="6032">[次]</a><a href="../list/6001-6100">[番号順一覧]</a><a href="../thread/6001-6100">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="6024">   6024 2002-08-29 18:08 [tk &lt;tk@xxxxxxxxxx&gt;  ] コマンドラインとブラウザー              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6025">   6025 2002-08-29 18:19 ┣[&quot;Hiroaki,Sakuma&quot; &lt;sa]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6026">   6026 2002-08-29 18:26 ┣[&quot;altana&quot; &lt;altana@xxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6027">   6027 2002-08-29 18:21 ┣[&quot;KAWAI,Takanori&quot; &lt;GC]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6028">   6028 2002-08-29 18:23 ┗[遠藤 俊裕 &lt;endo_t@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6029">   6029 2002-08-29 19:06 　┗[tk &lt;tk@xxxxxxxxxx&gt;  ]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="6031">   6031 2002-08-29 19:22 　　┣[Torii &lt;torii@xxxxxxx] ADO で集計関数                    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6032">   6032 2002-08-29 19:43 　　┃┣[Noriyuki Sakimura &lt;s]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6033">   6033 2002-08-29 19:51 　　┃┃┗[崎村 典行 &lt;sakimura@]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6034">   6034 2002-08-29 19:58 　　┃┣[Shingo Yamagai &lt;yama]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6038">   6038 2002-08-29 21:17 　　┃┗[&quot;Nobuhiro Shimura&quot; &lt;]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6041">   6041 2002-08-30 08:16 　　┃　┗[Torii &lt;torii@xxxxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6035">   6035 2002-08-29 20:04 　　┣[&quot;altana&quot; &lt;altana@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6036">   6036 2002-08-29 20:20 　　┣[&quot;KAWAI,Takanori&quot; &lt;GC]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6037">   6037 2002-08-29 21:12 　　┣[遠藤 俊裕 &lt;endo_t@xx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6042">   6042 2002-08-30 11:27 　　┃┗[tk &lt;tk@xxxxxxxxxx&gt;  ]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6046">   6046 2002-08-30 15:19 　　┃　┗[&quot;KAWAI,Takanori&quot; &lt;GC]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6044">   6044 2002-08-30 13:31 　　┗[&quot;Hiroaki,Sakuma&quot; &lt;sa]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6045">   6045 2002-08-30 14:48 　　　┗[遠藤 俊裕 &lt;endo_t@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6047">   6047 2002-08-31 12:40 　　　　┗[&quot;Hiroaki,Sakuma&quot; &lt;sa]                               </a></span>
</pre>
</body>
</html>
