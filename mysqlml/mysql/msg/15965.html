<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15965</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="15964.html">[前]</a><a href="15966.html">[次]</a><a href="../list/15901-16000.html">[番号順一覧]</a><a href="../thread/15901-16000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15965
</p>
<div class="header">
<p>
From: HAYASHI Kentaro &lt;HAYASHI Kentaro &lt;hayashi@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 29 May 2013 12:18:06 +0900<br>
Subject: [mysql 15965] [ANN] mroonga 3.04<br>

</p>
</div>
<div class="body">
<pre>
林です。

今日は毎月恒例の肉の日ですね。

まずはじめに、利用事例の記事を書いてくれる人募集のお知らせです。

  これまでも、groonga.orgにて利用事例 <a href="http://groonga.org/ja/users/">http://groonga.org/ja/users/</a> を
  紹介してきましたが、それとは別に、<a href="http://gihyo.jp/">http://gihyo.jp/</a>にてgroonga関連の記事の連載を
  隔週連載groongaとしてはじめました。
  まだgroongaを知らない人にもWebの連載記事を通じて知ってもらいたいというのが動機です。
  現在第4回まで公開しています。

    <a href="http://gihyo.jp/dev/clip/01/groonga">http://gihyo.jp/dev/clip/01/groonga</a>

    * 第1回 全文検索エンジンgroongaを紹介します！
      <a href="http://gihyo.jp/dev/clip/01/groonga/0001">http://gihyo.jp/dev/clip/01/groonga/0001</a>
    * 第2回 groongaをRuby On Railsでも使ってみた ～chikamap.comの事例から
      <a href="http://gihyo.jp/dev/clip/01/groonga/0002">http://gihyo.jp/dev/clip/01/groonga/0002</a>
    * 第3回 すべてのMySQLユーザに高速な全文検索機能を！ - mroongaの紹介
      <a href="http://gihyo.jp/dev/clip/01/groonga/0003">http://gihyo.jp/dev/clip/01/groonga/0003</a>
    * 第4回 rroongaを使ったソースコード検索エンジンMilkode
      <a href="http://gihyo.jp/dev/clip/01/groonga/0004">http://gihyo.jp/dev/clip/01/groonga/0004</a>

  利用事例がつきたら終了なので、実際に使っているユーザーのみなさんに
  利用事例を書いてもらえたらいいなぁと思っています!
  詳細は「groonga普及のための協力のお願い」を参照してください。

    <a href="http://sourceforge.jp/projects/groonga/lists/archive/dev/2013-February/001186.html">http://sourceforge.jp/projects/groonga/lists/archive/dev/2013-February/001186.html</a>

それとは別に、毎週木曜にQiitaでのgroonga関連(もちろんmroongaも!)の情報提供も続けているので、
参考にしてみてください。

  <a href="http://qiita.com/users/groonga">http://qiita.com/users/groonga</a>


mroonga 3.04をリリースしました。
  <a href="http://mroonga.org/ja/docs/news.html#release-3-04">http://mroonga.org/ja/docs/news.html#release-3-04</a>

mroongaはMySQL 5.1/5.5/5.6、MariaDB 5.3/5.5/5.6で利用できる全文検
索・位置情報検索可能なストレージエンジンです。mroongaは
Tritonnの後継プロジェクトです。

ドキュメント:
  <a href="http://mroonga.org/ja/">http://mroonga.org/ja/</a>
インストールガイド:
  <a href="http://mroonga.org/ja/docs/install.html">http://mroonga.org/ja/docs/install.html</a>

mroongaでよくあるMySQLとのバージョン不一致で
うまくインストールできなかったんだけど、、、というトラブルも
リリース直後は遭遇しにくいので、この機会にmroongaを試してみるのは
いかがでしょうか。

みなさんからのフィードバックをお待ちしています!

1.20より前のバージョンからアップグレードする場合は以下にある
手順を使ってください。
  <a href="http://mroonga.org/ja/docs/news.html#release-1-20">http://mroonga.org/ja/docs/news.html#release-1-20</a>

1.20からアップグレードする場合は以下にある手順を使ってくださ
い。
  <a href="http://mroonga.org/ja/docs/news.html#release-2-00">http://mroonga.org/ja/docs/news.html#release-2-00</a>

2.00か2.01からアップグレードする場合は、以下の手順でパッケージ
署名用の新しい鍵をインポートしてください。

  <a href="http://mroonga.org/ja/docs/news.html#release-2-02">http://mroonga.org/ja/docs/news.html#release-2-02</a>

2.00以降でストレージモードにてマルチカラムインデックスを
使っている場合は以下の手順でインデックスを作り直して
ください。

  <a href="http://mroonga.org/ja/docs/news.html#release-2-03">http://mroonga.org/ja/docs/news.html#release-2-03</a>

2.04以降でストレージモードにてSETカラムもしくは要素数が256より
少ないENUMを使用している場合は、以下の手順でデータベースを
再作成してください。

  <a href="http://mroonga.org/ja/docs/news.html#release-2-05">http://mroonga.org/ja/docs/news.html#release-2-05</a>

2.05以降でマルチカラムインデックスをVARCHARやCHAR型に対して使っている
場合は、以下の手順でインデックスを再作成してください。

  <a href="http://mroonga.org/ja/docs/news.html#release-2-08">http://mroonga.org/ja/docs/news.html#release-2-08</a>

2.08以降でTIMESTAMP型のカラムを使っているテーブルがあれば、
データベースを再作成してください。
CHAR(N)を主キーとしているテーブルがあれば、インデックスを再作成してく
ださい。

  <a href="http://mroonga.org/ja/docs/news.html#release-2-09">http://mroonga.org/ja/docs/news.html#release-2-09</a>

今回のリリースの主なトピックは以下の通りです。

  * Wプラグマのサポート
  * Debian 8.0 (jessie) のサポート

○ Wプラグマのサポート

今回のリリースではTritonnのWプラグマをサポートしました。

  <a href="http://qwik.jp/senna/query.html">http://qwik.jp/senna/query.html</a>

クエリの冒頭に以下の書式で対象となるセクションと重みづけ指定を
行うことができます。

  *W[数値[:重み][,数値[:重み]]...

Wプラグマの使い方を説明します。まずはサンプルのスキーマです。

  CREATE TABLE diaries (
    id INT PRIMARY KEY,
    title VARCHAR(255),
    content TEXT,
    FULLTEXT INDEX (title, content)
  ) ENGINE=mroonga DEFAULT CHARSET=utf8;

これに以下のサンプルデータを投入します。
  
  INSERT INTO diaries VALUES(1, "Hello", "今日からはじめました。");
  INSERT INTO diaries VALUES(2, "天気", "明日の富士山の天気について");
  INSERT INTO diaries VALUES(3, "富士山", "今日も天気がよくてきれいに見える。");

サンプルデータに対し、Wプラグマを用いてこのサンプルから"天気"を検索してみましょう。

diariesテーブルにはtitle,contentカラムがありますが、
contentカラムよりもtitleカラムをより重視したいとします。
titleカラムに重み10を、contentカラムに重み2を与えることにします。
Wプラグマに与える数値とカラムは以下のようになります。

  0 -&gt; titleカラム
  1 -&gt; contentカラム

上記を踏まえたクエリは以下の通りです。

  SELECT *, MATCH(title, content)
          AGAINST("*W0:10,1:2 +天気" in BOOLEAN MODE) AS score
       FROM diaries
       WHERE MATCH(title, content)
             AGAINST("*W0:10,1:2 +天気" in BOOLEAN MODE);

結果は以下のようになります。

  id	title	content	score
  2	天気	明日の富士山の天気について	12
  3	富士山	今日も天気がよくてきれいに見える。	2

Wプラグマにより重み付けできていることがわかります。

○ Debian 8.0 (jessie) のサポート

今回のリリースでは、Debian 8.0 (jessie) のサポートを追加しました。

Debian 7.0 (wheezy)が安定板としてリリースされたことに伴い、
新たにDebian 8.0 (jessie)のサポートを始めました。

jessie(testing)環境でも再びmroongaが使えるようになりました。

これまでの安定版であるDebian 6.0 (squeeze)はold stable扱いとなりますので、
いましばらくはサポートを続ける予定ですがお早めのwheezyへの移行をお勧めします。

いつsqueezeのサポートを切るかについては、別途検討の上でアナウンスします。

jessieでのインストール手順はドキュメントを参照してください。

  <a href="http://mroonga.org/ja/docs/install.html#debian-gnu-linux-jessie">http://mroonga.org/ja/docs/install.html#debian-gnu-linux-jessie</a>


○ 変更点

3.03からの変更点は以下の通りです。
  <a href="http://mroonga.org/ja/docs/news.html#release-3-04">http://mroonga.org/ja/docs/news.html#release-3-04</a>

改良
^^^^

  * MariaDB 10.0.2のサポートを改善しました。 [#1729]
  * [doc] サポートしているSQLコマンドのリストを更新しました。 [Y.Kentaroさんが報告]
  * Ubuntu 11.10 (Oneiric Ocelot)のサポートをやめました。
  * MariaDBパッケージへのmroonga組み込みをサポートしました。 [#1691]
  * [ラッパーモード] カラムコメントをパースするのをやめました。 [Y.Kentaroさんが報告]
  * 通常のカラムコメントのバリデーションをしないようにしました。 [Y.Kentaroさんが報告]
  * libmysqlservices.aを含むディレクトリの検出方法を改善しました。
    [Y.Kentaroさんが報告]
  * テーブル/インデックスコメントをフリースタイルで書けるように改善しました。
    [Y.Kentaroさんが提案]
  * "W"プラグマをサポートしました。この機能は Tritonn に由来します。
  * データベースを指定することなく mroonga_command() を使えるようにしました。
    [Y.Kentaroさんが報告]
  * auto_increment の値をテーブルを作るときにも参照するように改善しました。 [#1741]
  * auto_increment の値を直近のレコードが削除されてもそのまま保持するように改善しました。 [#1738]
  * [doc] Windowsでのmroongaのインストール手順を追加しました。

修正
^^^^

  * 空の検索クエリがSEGVを引き起す不具合を修正しました。
    [groonga-dev,01346][中井さんが報告]
  * ディレクトリの存在に依存したパッケージのビルドエラーを修正しました。 
    [groonga-dev,01335] [WINGさんが報告] [yoku tsさんがパッチ提供]
  * groonga-normalizer-mysql パッケージへのビルド時の依存関係の抜けを修正しました。
    [Y.Kentaroさんがパッチ提供]
  * my.cnfの Mroonga_log_level の値が設定されない不具合を修正しました。
    [groonga-dev,01379] [磯部和広さんが報告]
  * デフォルトのトークナイザーが正しく開放されずメモリリークする不具合を修正しました。
  * [ラッパーモード] ストレージエンジン名なしでALTER TABLEによりコメントを変更すると
    テーブルが消失する不具合を修正しました。 [Y.Kentaroさんが報告]

感謝
^^^^

  * Y.Kentaroさん
  * 中井さん
  * WINGさん
  * yoku tsさん
  * 磯部和広さん



-- 
HAYASHI Kentaro &lt;hayashi@xxxxxxxxxx&gt;

</pre>
</div>
<p class="button"><a href="15964.html">[前]</a><a href="15966.html">[次]</a><a href="../list/15901-16000.html">[番号順一覧]</a><a href="../thread/15901-16000.html">[スレッド一覧]</a></p>


</body></html>