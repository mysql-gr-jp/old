<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13289</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13288.html">[前]</a><a href="13290.html">[次]</a><a href="../list/13201-13300.html">[番号順一覧]</a><a href="../thread/13201-13300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13289
</p>
<div class="header">
<p>
From: Ushiro &lt;Ushiro &lt;ushi9999@xxxxxxxxxx&gt;&gt;<br>
Date: Sat, 02 Sep 2006 18:16:45 +0900<br>
Subject: [mysql 13289] ひらがな先頭文字のselectができない<br>

</p>
</div>
<div class="body">
<pre>
いつもお世話になります。投稿は初めてです、よろしくお願いします。

ひらがな（・かたかな）のSELECTがしたいのですがどうしても
うまくいかないのです。

やりたいのは「あるフィールドをあ行、か行、さ行、、わ行、英字、その他に分
類する」ことです。
まずひらがな（・カタカナ）分類を行っていますが
フィールドの先頭のひらがなの前方一致をするところがうまくいきません。

あるフィールド（aaa）が
(1)「たのテスト」
(2)「たのテスト２」
(3)「だのテスト」
(4)「にのテスト」
というデータがあります。

「た行」を選択するのに「ただタダ....ド」をlike検索します。

SELECT * FROM testtable WHERE ( aaa LIKE &quot;た%&quot; or aaa LIKE &quot;だ%&quot; or
aaa LIKE &quot;タ%&quot; or aaa LIKE &quot;ダ%&quot; or aaa LIKE &quot;ち%&quot; or aaa LIKE &quot;
ぢ%&quot; or aaa LIKE &quot;チ%&quot; or aaa LIKE &quot;ヂ%&quot; or aaa LIKE &quot;つ%&quot; or
aaa LIKE &quot;づ%&quot; or aaa LIKE &quot;ツ%&quot; or aaa LIKE &quot;ヅ%&quot; or aaa LIKE &quot;
て%&quot; or aaa LIKE &quot;で%&quot; or aaa LIKE &quot;テ%&quot; or bdesc LIKE &quot;デ%&quot; or
aaa LIKE &quot;と%&quot; or aaa LIKE &quot;ど%&quot; or aaa LIKE &quot;ト%&quot; or aaa LIKE &quot;
ド%&quot; ) ORDER BY aaa ASC

本来は(1)(2)(3)が選択されるべきなのですが、(4)「に」も入ってきます。
（aaa の前に BINARY をつけると、何も選択されなくなりました）

さらに絞り込んで「た」のみだと

SELECT * FROM testtable WHERE ( aaa LIKE &quot;た%&quot; or aaa LIKE &quot;だ%&quot; or
aaa LIKE &quot;タ%&quot; or aaa LIKE &quot;ダ%&quot;)

なら正しく(1)(2)(3)になりますが、以下のように「ち」にすると

SELECT * FROM testtable WHERE ( aaa LIKE &quot;ち%&quot; or aaa LIKE &quot;
ぢ%&quot; or aaa LIKE &quot;チ%&quot; or aaa LIKE &quot;ヂ%&quot;)

何もないはずが、(3)「だ」が選択されます。「つ」も同様です。


「と」では、

SELECT * FROM testtable WHERE ( LIKE &quot;と%&quot; or aaa LIKE &quot;
ど%&quot; or aaa LIKE &quot;ト%&quot; or aaa LIKE &quot;ド%&quot; )

(4)「に」が選択されます。

==================
PHPスクリプトはEUCです。
MySQLデータベースがUTF8(UTF-8 Unicode)なので、その辺りが原因でしょうか？
ちなみに「た行」選択に当初は範囲指定（「た」&gt;= and &lt;=「ど」等）としてい
たのですが、うまくいかないためlike切り替えました。しかし
同様の問題にあたてしまいました。
日本語の正規表現は使えないですし...

本当に行き詰っています。
何か少しでもヒントをお持ちの方、よろしくお願いいたします。


環境
PHP 4.4.2
MySQL 4.1.11
Apache/1.3.37

mbstring.encoding_translation On
mbstring.func_overload 0 
mbstring.http_input EUC-JP
mbstring.http_output EUC-JP
mbstring.internal_encoding EUC-JP 
mbstring.language Japanese 
mbstring.script_encoding EUC-JP
mbstring.substitute_character

*-* USHIRO Kaori &lt;ushi9999@xxxxxxxxxx&gt; *-*



</pre>
</div>
<p class="button"><a href="13288.html">[前]</a><a href="13290.html">[次]</a><a href="../list/13201-13300.html">[番号順一覧]</a><a href="../thread/13201-13300.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="13289.html">  13289 2006-09-02 18:16 [Ushiro &lt;ushi9999@xxx] ひらがな先頭文字のselectができない      </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13290.html">  13290 2006-09-02 19:03 ┗[nomoto &lt;shin-1@xxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13291.html">  13291 2006-09-04 09:27 　┗[Ushiro &lt;ushi9999@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13292.html">  13292 2006-09-04 09:46 　　┗[Ushiro &lt;ushi9999@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13304.html">  13304 2006-09-05 09:35 　　　┗[Ushiro &lt;ushi9999@xxx]                                 </a></span>
</pre>
</body>
</html>
