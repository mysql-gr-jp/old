<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12001</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="12000.html">[前]</a><a href="12002.html">[次]</a><a href="../list/12001-12100.html">[番号順一覧]</a><a href="../thread/12001-12100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:12001
</p>
<div class="header">
<p>
From: Masatugu Teshima &lt;Masatugu Teshima &lt;teshima@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 24 Aug 2005 18:02:05 +0900<br>
Subject: [mysql 12001] Re: MySQL5 + MyODBC + Access  2000で一部の日本語文字が登録できない。<br>

</p>
</div>
<div class="body">
<pre>
藤原様はじめまして
手島と申します。

<span class="quote1">&gt;  問題が発生するSQL文そのもの(create table,insert)を教えてもらえませ</span>
<span class="quote1">&gt;  んでしょうか？ 実際に実験してみたいもので。</span>

環境
Server
Windows2000 + MySQL5.0.9

Client
Windows XP + Access 2000 + MyODBC3.5.11-2

上記の環境で
Access 2000 にODBCリンクテーブルを作成して、そのテーブルを直接開いて
データを入力して試しています。

table自体は簡単なもので以下の文で作成しています。

CREATE TABLE ADDON (
 PROGRAM_ID varchar (10) primary key NOT NULL ,
 ADDON_NAME varchar(50) NULL ,
 FILE_NAME varchar (50) NULL
);

上記の3つのうちのどれかに2バイト目が0x5Cのマルチバイト文字で
終わる値(集計表など)を入力して、行を移動すると

「ODBC--リンクテーブル 'addon'への挿入み失敗しました。」

が発生します。

このときの文字コードですが
Server Client
sjis   sjis
sjis   utf8
utf8   sjis
utf8   utf8
で試したtころ、この現象がでるのはClientがsjisのパターンで
clientがutf8のパターンでは、マルチバイト文字を入力しても
空文字で登録されます。

これでお分かりになりますでしょうか？

P.S.
mysqlコマンド環境からは

clientをsjisにした場合は
insert into addon values('aaa','集計表','dddd');

を実行したところ、問題なく追加できました。
この値もAccess2000から正しく表示できます。
ただし、変更がかかると同じエラーがでます。

clientをutf8にした場合は追加できません（当然ですが）

</pre>
</div>
<p class="button"><a href="12000.html">[前]</a><a href="12002.html">[次]</a><a href="../list/12001-12100.html">[番号順一覧]</a><a href="../thread/12001-12100.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="11985.html">  11985 2005-08-22 18:30 [Masatugu Teshima &lt;te] MySQL5 + MyODBC + Access  2000で一部の日本語文字が登録できない。</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11986.html">  11986 2005-08-23 05:05 ┣[&quot;KKuji_Y2a&quot; &lt;kkuji@x]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11987.html">  11987 2005-08-23 09:19 ┃┗[Masatugu Teshima &lt;te]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11989.html">  11989 2005-08-23 14:00 ┃　┗[&quot;KKuji_Y2a&quot; &lt;kkuji@x]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11990.html">  11990 2005-08-23 14:46 ┃　　┗[Masatugu Teshima &lt;te]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11991.html">  11991 2005-08-23 17:47 ┃　　　┗[内藤祐介 &lt;naito@xxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11992.html">  11992 2005-08-24 09:18 ┃　　　　┗[Masatugu Teshima &lt;te]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11994.html">  11994 2005-08-24 11:43 ┃　　　　　┣[&lt;naito@xxxxxxxxxx&gt;  ]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11995.html">  11995 2005-08-24 13:47 ┃　　　　　┃┗[Topsystem 下地 &lt;simo]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11996.html">  11996 2005-08-24 13:53 ┃　　　　　┣[Seiichi YANAI &lt;yanai]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11997.html">  11997 2005-08-24 14:19 ┃　　　　　┗[Masatugu Teshima &lt;te]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11998.html">  11998 2005-08-24 14:52 ┃　　　　　　┣[SUGIMURA Takashi 杉�]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12002.html">  12002 2005-08-24 18:03 ┃　　　　　　┃┗[Masatugu Teshima &lt;te]                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="11999.html">  11999 2005-08-24 14:33 ┃　　　　　　┗[Hirofumi Fujiwara &lt;f]                         </a></span>
<span class="current">-&gt;&nbsp;<a href="12001.html">  12001 2005-08-24 18:02 ┃　　　　　　　┗[Masatugu Teshima &lt;te]                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12008.html">  12008 2005-08-25 09:32 ┗[&quot;Shuichi Tamagawa&quot; &lt;]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12009.html">  12009 2005-08-25 21:06 　┣[&quot;S.Yamada&quot; &lt;proton@x]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12012.html">  12012 2005-08-26 16:08 　┃┗[Masatugu Teshima &lt;te]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12011.html">  12011 2005-08-26 16:06 　┗[Masatugu Teshima &lt;te]                                     </a></span>
</pre>
</body>
</html>
