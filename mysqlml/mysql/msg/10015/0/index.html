<table width=100%><tr><td>
<P>はじめまして、雨柳と言います。</P>
<P>仕事の関係でMySQLを勉強し始めたところなのですが、<BR>以下の条件で検索を行うと、索引があるに関わらず、全件をなめます。</P>
<P><BR>create table TBL_A( COL_A char(10), PRIMARY KEY (COL_A));<BR>create table TBL_B( COL_B char(10), PRIMARY KEY (COL_B));</P>
<P><BR>mysql&gt; desc TBL_A;<BR>+-------+----------+------+-----+---------+-------+<BR>| Field | Type&nbsp;&nbsp;&nbsp;&nbsp; | Null | Key | Default | Extra |<BR>+-------+----------+------+-----+---------+-------+<BR>| COL_A | char(10) |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRI |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+-------+----------+------+-----+---------+-------+<BR>1 row in set (0.00 sec)</P>
<P>mysql&gt; desc TBL_B;<BR>+-------+----------+------+-----+---------+-------+<BR>| Field | Type&nbsp;&nbsp;&nbsp;&nbsp; | Null | Key | Default | Extra |<BR>+-------+----------+------+-----+---------+-------+<BR>| COL_B | char(10) |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRI |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+-------+----------+------+-----+---------+-------+<BR>1 row in set (0.00 sec)</P>
<P><BR>TBL_A、TBL_Bともに0000000000～0000000009の１０件挿入する。</P>
<P><BR>mysql&gt; explain select COL_A from TBL_A where COL_A in (select COL_B from TBL_B where COL_B like '0000000001');<BR>+----+--------------------+-------+-----------------+---------------+---------+---------+------+------+--------------------------+<BR>| id | select_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | table | type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | possible_keys | key&nbsp;&nbsp;&nbsp;&nbsp; | key_len | ref&nbsp; | rows | Extra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+----+--------------------+-------+-----------------+---------------+---------+---------+------+------+--------------------------+<BR>|&nbsp; 1 | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | TBL_A | index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | NULL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRIMARY |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20 | NULL |&nbsp;&nbsp; 10 | Using where; Using index |<BR>|&nbsp; 2 | DEPENDENT SUBQUERY | TBL_B | unique_subquery | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRIMARY |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20 | func |&nbsp;&nbsp;&nbsp; 1 | Using index; Using where |<BR>+----+--------------------+-------+-----------------+---------------+---------+---------+------+------+--------------------------+<BR>2 rows in set (0.00 sec)</P>
<P><BR>テーブル TBL_A に対し、全件なめているようです。<BR>以下ですと、そうではないのですが。。。。</P>
<P><BR>mysql&gt; explain select COL_A from TBL_A where COL_A in ('0000000001');<BR>+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------------+<BR>| id | select_type | table | type&nbsp; | possible_keys | key&nbsp;&nbsp;&nbsp;&nbsp; | key_len | ref&nbsp;&nbsp; | rows | Extra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------------+<BR>|&nbsp; 1 | SIMPLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | TBL_A | const | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRIMARY |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20 | const |&nbsp;&nbsp;&nbsp; 1 | Using index |<BR>+----+-------------+-------+-------+---------------+---------+---------+-------+------+-------------+<BR>1 row in set (0.00 sec)</P>
<P>mysql&gt; explain select COL_A from TBL_A where COL_A like (select COL_B from TBL_B where COL_B like '0000000001');<BR>+----+-------------+-------+-------+---------------+---------+---------+------+------+--------------------------+<BR>| id | select_type | table | type&nbsp; | possible_keys | key&nbsp;&nbsp;&nbsp;&nbsp; | key_len | ref&nbsp; | rows | Extra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+----+-------------+-------+-------+---------------+---------+---------+------+------+--------------------------+<BR>|&nbsp; 1 | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp; | TBL_A | range | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | PRIMARY |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20 | NULL |&nbsp;&nbsp;&nbsp; 1 | Using where; Using index |<BR>|&nbsp; 2 | SUBQUERY&nbsp;&nbsp;&nbsp; | TBL_B | ALL&nbsp;&nbsp; | PRIMARY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | NULL&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; NULL | NULL |&nbsp;&nbsp;&nbsp; 1 |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>+----+-------------+-------+-------+---------------+---------+---------+------+------+--------------------------+<BR>2 rows in set (0.00 sec)</P>
<P><BR>この現象は、ＭｙＳＱＬの仕様でしょうか？<BR>それとも、設定等の問題でしょうか？</P>
<P>ご教授ください。よろしくお願いします。<BR></P>
</td></tr></table>
<p><br><hr size=1>GANBARE! NIPPON!<br>
Yahoo! JAPAN JOC OFFICIAL INTERNET PORTAL SITE<br>
<a href="http://mail.ganbare-nippon.yahoo.co.jp/">http://mail.ganbare-nippon.yahoo.co.jp/</a>

