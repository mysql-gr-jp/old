<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15788</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15787.html">[前]</a><a href="15789.html">[次]</a><a href="../list/15701-15800.html">[番号順一覧]</a><a href="../thread/15701-15800.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15788
</p>
<div class="header">
<p>
From: 中川 貴 &lt;中川 貴 &lt;takashi.nakagawa@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 11 Jul 2012 15:00:25 +0900<br>
Subject: [mysql 15788] Re: カテゴリ毎の上位3件<br>

</p>
</div>
<div class="body">
<pre>中川です。
後藤さんのやり方にはひとつ問題がありまして、3件以上のレコードがないカテゴリの
抽出ができません。
PostgreSQL、Oracle、DB2などでは
ROW_NUMBER関数やRANK関数が使えるのですがMySQLは未実装なのでここのあたりは
対応が苦しいところですね。

****************************************
コープ情報システム株式会社
運用事業部
コーププラザサービスデスクグループ
中川　貴
175-0094
東京都渋谷区渋谷3-29-8 コーププラザ5F
TEL 03-5778-8010
E-MAIL takashi.nakagawa@xxxxxxxxxx
****************************************

(2012/07/11 14:17), gotou1213@xxxxxxxxxx wrote:
<span class="quote1">&gt; 後藤です。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 以下のように相関サブクエリの回数を減らしたほうが早いかもしれません。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; select a.category, a.name, a.price</span>
<span class="quote1">&gt; from (</span>
<span class="quote1">&gt;    select category, (</span>
<span class="quote1">&gt;      select price from saledata where category = g.category</span>
<span class="quote1">&gt;      order by category asc, price asc limit 2,1</span>
<span class="quote1">&gt;    ) as price</span>
<span class="quote1">&gt;    from ( select category from saledata group by category) g</span>
<span class="quote1">&gt; ) t</span>
<span class="quote1">&gt; inner join saledata a</span>
<span class="quote1">&gt;    on  a.category = t.category</span>
<span class="quote1">&gt;    and a.price&lt;= t.price</span>
<span class="quote1">&gt; ;</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 以上です。</span>
<span class="quote1">&gt; </span>


</pre>
</div>
<p class="button"><a href="15787.html">[前]</a><a href="15789.html">[次]</a><a href="../list/15701-15800.html">[番号順一覧]</a><a href="../thread/15701-15800.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="15783.html">  15783 2012-07-11 02:56 [&lt;shin-1@xxxxxxxxxx&gt; ] カテゴリ毎の上位3件                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15784.html">  15784 2012-07-11 10:27 ┣[高橋政利 &lt;takahashi@]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15785.html">  15785 2012-07-11 12:28 ┣[中川 貴 &lt;takashi.nak]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15796.html">  15796 2012-07-12 04:10 ┃┗[&lt;shin-1@xxxxxxxxxx&gt; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15786.html">  15786 2012-07-11 13:49 ┗[&lt;gotou1213@xxxxxxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15787.html">  15787 2012-07-11 14:17 　┣[&lt;gotou1213@xxxxxxxxx]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="15788.html">  15788 2012-07-11 15:00 　┃┗[中川 貴 &lt;takashi.nak]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15790.html">  15790 2012-07-11 16:09 　┗[&lt;shin-1@xxxxxxxxxx&gt; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15791.html">  15791 2012-07-11 17:11 　　┣[あきら &lt;akirainfoml@]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15794.html">  15794 2012-07-12 03:38 　　┃┗[&lt;shin-1@xxxxxxxxxx&gt; ]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15792.html">  15792 2012-07-12 00:40 　　┗[&lt;gotou1213@xxxxxxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15795.html">  15795 2012-07-12 03:42 　　　┗[&lt;shin-1@xxxxxxxxxx&gt; ]                                 </a></span>
</pre>


</body></html>