<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6271</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6270">[前]</a><a href="6272">[次]</a><a href="../list/6201-6300">[番号順一覧]</a><a href="../thread/6201-6300">[スレッド一覧]</a></p>
<p class="id">
mysql:6271
</p>
<div class="header">
<p>
From: 西出 学 &lt;西出 学 &lt;Nishide@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 25 Sep 2002 22:24:27 +0900<br>
Subject: [mysql 06271] ODBC による DB 接続について<br>

</p>
</div>
<div class="body">
<pre>
西出＠島津エス・ディーと申します。
皆様にはお世話になっております。

さて、MySQLのデータベース格納場所ですが、過去にも
メーリングリストにて話題になっており、過去ログを調べましたが、
結局はどうなのだろう？
とわからなくなってしまいました。
どなたかお分かりの方が居られれば、教えて頂きたいのですが。
お手数ですが、宜しくお願いいたします。

○環境
   WinNT４．０＋VC６．０＋MyODBC３．５１＋
   mysql-3.23.51
   にてADOを利用してMySQLのDBに接続し、
   各種の処理を行うDLLを作成しています。

○問題点
    MySQLサーバー起動時のDBデータフォルダは
    c:\mysql\dataにしてあり、そこにあるデータの
    アクセスには問題はありませんが、以下のような
   処理を行いたく困っています。

   （例）
   Local PC（Mysqlサーバー起動）
      c:\mysql\data\Aデータベースの
                   Bテーブル上にある特定レコード
                           ↓ バックアップ後、削除
                               （リストアも考慮）
                   DVD−RAMなどに（なければ）DB作成後、
                   Bテーブル上のバックアップレコードを格納
                    （c:\mysql\dataフォルダ以外でも同じ）

    ADOのコネクション設定は、以下のような形式で設定しておりますが、
    対象となるDB位置が自由に設定できないためどうしようかと悩んでいます。
    Provider=XXやDSN=XXX Data Source=XXXなどの設定を試みたのですが、
    どうも上手く接続せきません。
    ACCESSやMS−SQLなどでは、Data Source指定により、対象とする
    DBデータを動的に切り替えられるのですが。。。
   何か上手い方法はありますでしょうか？
   MySQLでは、無理なのでしょうか？

    （MyODBC サンプルHPより流用）
  //Connection string for MyODBC 3.51
    string MyConString = &quot;DRIVER={MySQL ODBC 3.51 Driver};&quot; + 
                             &quot;SERVER=localhost;&quot; +
                             &quot;DATABASE=test;&quot; +
                             &quot;UID=root;&quot; +
                             &quot;PASSWORD=;&quot; +
                             &quot;OPTION=16835&quot;;

--------------------------------------------------------
  島津エス・ディー株式会社      第一技術部　第三課            
  西出  学 (Manabu Nishide)    E-mail: nishide@xxxxxxxxxx     
--------------------------------------------------------



</pre>
</div>
<p class="button"><a href="6270">[前]</a><a href="6272">[次]</a><a href="../list/6201-6300">[番号順一覧]</a><a href="../thread/6201-6300">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="6271">   6271 2002-09-25 22:24 [西出 学 &lt;Nishide@xxx] ODBC による DB 接続について             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6272">   6272 2002-09-26 09:43 ┣[&quot;Takashi Yamashita&quot; ]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6277">   6277 2002-09-26 12:42 ┗[SUGAWARA Hajime &lt;sug]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6279">   6279 2002-09-26 17:05 　┗[&quot;Takashi Yamashita&quot; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6283">   6283 2002-09-26 20:15 　　┗[&quot;kosugi&quot; &lt;kosugi@xxx]                                   </a></span>
</pre>
</body>
</html>
