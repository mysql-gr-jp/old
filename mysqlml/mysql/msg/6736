<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6736</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6735">[前]</a><a href="6737">[次]</a><a href="../list/6701-6800">[番号順一覧]</a><a href="../thread/6701-6800">[スレッド一覧]</a></p>
<p class="id">
mysql:6736
</p>
<div class="header">
<p>
From: &lt;enim2@xxxxxxxxxx&gt;<br>
Date: Fri, 20 Dec 2002 14:15:00 +0900<br>
Subject: [mysql 06736] Re: Access2000 と MySQL における時刻の表示<br>

</p>
</div>
<div class="body">
<pre>
Enimといいます.

Accessの日付/時刻型は内部的には浮動小数で管理しているはずです.

「1899/12/31 0:00:00」＝「1」
「1899/12/31 0:00:01」＝「1.0000115740740700」
「1900/01/01 0:00:01」＝「2.0000115740740700」
「2002/01/31 0:00:00」＝「37287」

というような感じです.
基準が
「1899/12/31 0:00:00」＝「1」
になってます。

で、MySQLのdatetime型はこの内部的な基準が
Accessと違うからではないでしょうか？
（これは私も調べきれませんでした。ごめんなさい。）
その基準さえ分かればAccess側で何かしら計算してから
表示すれば良いような気がします。

基準を調べる方法としてはAccessの該当項目のデータ型を
「日付/時刻型」ではなくて「倍精度浮動小数点型」にしてみて
上のAccessの基準と比べてみてはいかがでしょうか？

-------------------------------------------------------
　Name:　　　Enim
　Home(PC):　<a href="http://game6.ncs.gr.jp/~enim/">http://game6.ncs.gr.jp/~enim/</a>
　Home(i): 　<a href="http://game6.ncs.gr.jp/~enim/i/">http://game6.ncs.gr.jp/~enim/i/</a>
　Mail:　　　enim2@xxxxxxxxxx
-------------------------------------------------------

&quot;kossy&quot; &lt;kossy@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; タイムテーブルをMySQLで作成しました。</span>
<span class="quote1">&gt; time型を用いて作成し、ODBC経由でMS Access2000で表示したら</span>
<span class="quote1">&gt; 表示がまったく違う時刻になりました。</span>
<span class="quote1">&gt; Access2000には日付／時刻型しかないので、ダメなのかと思い、</span>
<span class="quote1">&gt; MySQL側の型をdatetime型にしたらなんとか表示されるようにはなった</span>
<span class="quote1">&gt; のですが、誤差が出てしまいました。</span>
<span class="quote1">&gt; （日付は必要がないので9999-12-31を埋め込みました）</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 誤差とは、例えば、MySQL上で19:30ならAccessでは19:29:59といった</span>
<span class="quote1">&gt; 感じです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 何か回避策はありますでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 使用環境は以下の通りです。</span>
<span class="quote1">&gt; ・サーバー側</span>
<span class="quote1">&gt;   Cobalt Raq4 (RedHatLinux ?)</span>
<span class="quote1">&gt; 　MySQL 3.23.39</span>
<span class="quote1">&gt; ・クライアント側</span>
<span class="quote1">&gt; 　WindowsXP</span>
<span class="quote1">&gt; 　ODBC MyODBC 3.51.04</span>
<span class="quote1">&gt; 　MS Access2000 SP-3</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; よろしくお願いします。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 小柴</span>
<span class="quote1">&gt; kossy@xxxxxxxxxx</span>




</pre>
</div>
<p class="button"><a href="6735">[前]</a><a href="6737">[次]</a><a href="../list/6701-6800">[番号順一覧]</a><a href="../thread/6701-6800">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="6732">   6732 2002-12-20 10:50 [&quot;kossy&quot; &lt;kossy@xxxxx] Access2000 と MySQL における時刻の表示  </a></span>
<span class="current">-&gt;&nbsp;<a href="6736">   6736 2002-12-20 14:15 ┗[&lt;enim2@xxxxxxxxxx&gt;  ]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6739">   6739 2002-12-20 15:24 　┗[&quot;kossy&quot; &lt;kossy@xxxxx]                                     </a></span>
</pre>
</body>
</html>
