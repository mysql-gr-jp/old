<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:9239</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="9238.html">[前]</a><a href="9240.html">[次]</a><a href="../list/9201-9300.html">[番号順一覧]</a><a href="../thread/9201-9300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:9239
</p>
<div class="header">
<p>
From: 高橋政利 &lt;高橋政利 &lt;takahashi@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 20 Apr 2004 18:45:49 +0900<br>
Subject: [mysql 09239] auto_incrementで次番号を確認したい。<br>

</p>
</div>
<div class="body">
<pre>
auto_increment型について質問がありまして投稿しました。高橋と申します。

社内業務の為にと独学で PHP 4.3.1 + MySQL 4.0.12-nt にて業務用Webを作成し
ておりましたが、管理を容易にするために管理用のページを作成しております。
そこで、当MLやホームページを調べてみたのですが解決に至りませんでしたので、
質問させていただきます。
見積書管理用のテーブルにて、管理番号（auto_increment型 主KEY）、顧客名称、
見積品目を管理しています。管理番号は６桁で先頭の２桁は、見積作成時の年度
を、残りの４桁は管理番号（連続した番号）で構成されています。
例）平成１５年度　　150001 〜 159999
　　平成１６年度　　160001 〜 169999

年度が変わるたびに、平成１５年度の場合

ALTER TABLE 見積書 AUTO_INCREMENT = 150001

を年度初めに処理していますので問題ないのですが、管理画面上（PHPで作成し
ています。）で、上記のような処理をした後に、確認の意味を含めて次に発行さ
れる予定の番号（つまり正しく年度情報が設定されたか）を確認したいのですが、
良い方法はないのでしょうか？

調べたところ、LAST_INSERT_ID()が使えるのかな？と思ったのですが、確かに通
常の運用では、最後の番号を取得して１を加える方法や

SELECT 管理番号 FROM 見積書 ORDER BY 管理番号 DESC LIMIT 1

として得た数字に１を加えれば良いのですが、平成１５年度の管理番号が500件
しかなく最終番号が150500となっている場合に、平成１６年度となり

ALTER TABLE 見積書 AUTO_INCREMENT = 160001

としたときには希望通りの動作にはなりません。

年に１度の事なので、まぁ良いとすればそれまでなのですが・・・・。


</pre>
</div>
<p class="button"><a href="9238.html">[前]</a><a href="9240.html">[次]</a><a href="../list/9201-9300.html">[番号順一覧]</a><a href="../thread/9201-9300.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="9239.html">   9239 2004-04-20 18:45 [高橋政利 &lt;takahashi@] auto_incrementで次番号を確認したい。    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9240.html">   9240 2004-04-20 23:29 ┣[Shinya Kawaji &lt;kawaj]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9245.html">   9245 2004-04-21 09:00 ┃┗[高橋政利 &lt;takahashi@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9248.html">   9248 2004-04-21 10:12 ┃　┗[Shinya Kawaji &lt;kawaj]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9250.html">   9250 2004-04-21 11:20 ┃　　┗[ML account &lt;ml@xxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9246.html">   9246 2004-04-21 09:15 ┣[&quot;片寄白王&quot; &lt;katayose]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9251.html">   9251 2004-04-21 17:39 ┃┗[川合孝典 &lt;gcd00051@x]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9252.html">   9252 2004-04-21 18:02 ┃　┣[&quot;山本　瑞己&quot; &lt;mizuki]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9253.html">   9253 2004-04-21 18:53 ┃　┗[ML account &lt;ml@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9254.html">   9254 2004-04-22 00:19 ┃　　┗[&quot;KATAYOSE hakuo&quot; &lt;ka]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9255.html">   9255 2004-04-22 01:42 ┃　　　┗[ML account &lt;ml@xxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9256.html">   9256 2004-04-22 09:02 ┃　　　　┗[&quot;片寄白王&quot; &lt;katayose]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9258.html">   9258 2004-04-22 09:36 ┃　　　　　┗[高橋政利 &lt;takahashi@]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9265.html">   9265 2004-04-22 11:44 ┃　　　　　　┗[ML account &lt;ml@xxxxx]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9249.html">   9249 2004-04-21 10:56 ┣[Seiji Tateyama &lt;tate]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9257.html">   9257 2004-04-22 09:07 ┣[高橋政利 &lt;takahashi@]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9264.html">   9264 2004-04-22 11:44 ┃┗[ML account &lt;ml@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9277.html">   9277 2004-04-23 00:29 ┗[Kenji Irie &lt;kenji@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9279.html">   9279 2004-04-23 08:01 　┗[高橋政利 &lt;takahashi@]                                     </a></span>
</pre>
</body>
</html>
