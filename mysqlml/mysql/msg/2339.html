<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:2339</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="2338.html">[前]</a><a href="2340.html">[次]</a><a href="../list/2301-2400.html">[番号順一覧]</a><a href="../thread/2301-2400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:2339
</p>
<div class="header">
<p>
From: "MIYATSU Kazunari" &lt;"MIYATSU Kazunari" &lt;mid@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 2 Aug 2000 13:12:06 +0900<br>
Subject: [mysql 02339] Re: php で写真 GIF  を出力するには<br>

</p>
</div>
<div class="body">
<pre>宮津@長野です。

共用標準ファイルをブラウザで取り出す・・・とゆーよーな運用にこのようなモノを用
いています。
------------------------------------------------------------------------------
&lt;?
$conn=mysql_connect("localhost");
if(!mysql_select_db("StdArchive",$conn)){echo ("Cannot select database.\n");}
$result = mysql_query("select * from stddoc where(ID=$FileID)");
if($row =@mysql_fetch_object($result)){
 header("Content-type: $row-&gt;MIME");

 header("Content-Disposition: Filename=$row-&gt;Filename");
// header("Content-Disposition: inline; filename=$row-&gt;Filename");
// header("Content-Disposition: attachment; filename=$row-&gt;Filename");
// header("Content-Disposition: extension-token; Filename=$row-&gt;Filename");

 echo $row-&gt;Dbinary;
}else{
 echo "&lt;HTML&gt;\n&lt;HEAD&gt;&lt;TITLE&gt;File not Found&lt;/TITLE&gt;&lt;/HEAD&gt;\n";
 echo "&lt;BODY&gt;\nFile Not Found.&lt;BR&gt;";
 echo "Please Check Link or Argument and Reload.&lt;BR&gt;";
 echo "&lt;HR&gt;Standard Document Archive.&lt;BR&gt;";
 echo "&lt;/BODY&gt;\n&lt;/HTML&gt;";
};
?&gt;
------------------------------------------------------------------------------
FileIDを引数にして合致したIDを持つファイルを送りつけるものです。
この他にメンテナンス用,アップロード用,リスティング用がありますが、割愛します。

MySQL側のテーブル(StdArchive)のフィールドは
 ID                int   インデックス
 MIME              varchar MIMEタイプ
 Filename          varchar ファイル名 
 Dbinary           longbolb バイナリ本体
といった構成になっており、アップロード時にMIMEタイプも格納し、2M以内ならなんで
も上げられるようにしています。

GIFだけならMIMEに"image/gif"を決め打ちで良いかと。

３行ばかりコメントになっている部分は、これらを差し替えることでIE,NNでの挙動が変
る部分です。お好きなのを残してコメントアウトしてください。



</pre>
</div>
<p class="button"><a href="2338.html">[前]</a><a href="2340.html">[次]</a><a href="../list/2301-2400.html">[番号順一覧]</a><a href="../thread/2301-2400.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="2328.html">   2328 2000-08-01 19:33 [楠吉彦  &lt;moredebu@xx] php で写真 GIF を出力するには           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2331.html">   2331 2000-08-01 20:38 ┣[とみたまさひろ &lt;tomm]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="2339.html">   2339 2000-08-02 13:12 ┗["MIYATSU Kazunari" &lt;]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2340.html">   2340 2000-08-02 18:07 　┗[楠吉彦  &lt;moredebu@xx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2341.html">   2341 2000-08-02 18:36 　　┗["MIYATSU Kazunari" &lt;]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2342.html">   2342 2000-08-02 18:45 　　　┗["MIYATSU Kazunari" &lt;]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2343.html">   2343 2000-08-02 20:35 　　　　┣[楠吉彦  &lt;moredebu@xx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2347.html">   2347 2000-08-04 18:42 　　　　┗[楠吉彦  &lt;moredebu@xx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2349.html">   2349 2000-08-05 11:52 　　　　　┗["MIYATSU Kazunari" &lt;]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2350.html">   2350 2000-08-05 16:26 　　　　　　┗[楠吉彦  &lt;moredebu@xx]                           </a></span>
</pre>


</body></html>