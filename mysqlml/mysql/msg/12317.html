<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12317</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="12316.html">[前]</a><a href="12318.html">[次]</a><a href="../list/12301-12400.html">[番号順一覧]</a><a href="../thread/12301-12400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:12317
</p>
<div class="header">
<p>
From: "KIYOSE" &lt;"KIYOSE" &lt;kiyose@xxxxxxxxxx&gt;&gt;<br>
Date: Sat, 29 Oct 2005 03:07:39 +0900<br>
Subject: [mysql 12317] 複合の集計？<br>

</p>
</div>
<div class="body">
<pre>KENJIです。

まだまだ初心者の私なのですが、

以下のような内容を行いたいと
思っています。

MySQLは4.1です。

以下のようなテーブルから
集計を行いたいのです。

＜テーブル-1＞
Aid	date
1	2005-10-1
2	2005-10-2
3	2005-10-2
4	2005-10-3
5	2005-10-4

＜テーブル-2＞
id	Aid	g_id
1	1	2001
2	1	2002
3	2	2001
4	2	2005
5	3	2001
6	3	2005
7	4	2002
8	4	2001
9	4	2001
10	5	2001

テーブル-1のデータを
2005-10-1から2005-10-3までのAidを抽出して
テーブル-2のKEYにして
g_idを抽出して、g_idの集計を行いたいのです。

つまり、最終結果としては、
g_id	集計
2001	5
2002	2
2005	2

という結果を出したいのです。



自分なりには以下のようにやってみましたが、
一向にうまく行きません。

$bkday = "2005-10-1";
$today = "2005-10-3";

$sql = "select * from テーブル-1 where date&gt;='$bkday' and
date&lt;='$today'"; 
$result = $db_query-&gt;Db_Query_NVoid($db_name, $conn, $sql);
	
for($i=0;$i&lt;mysql_num_rows($result); $i++)
	{
	$arr = mysql_fetch_array($result);
	$sql  = "select * fromテーブル-2 where Aid='$arr[Aid]'　group by
g_id";
	$res2 = $db_query-&gt;Db_Query_NVoid($db_name, $conn, $sql);
			
	$arrsale = mysql_fetch_array($res2);
	$item = $arrsale[g_id];
			
	echo $item."&lt;BR&gt;";
	}


何とか
正しい集計をお教えいただけませんでしょうか？

よろしくお願い申し上げます。


KENJI




</pre>
</div>
<p class="button"><a href="12316.html">[前]</a><a href="12318.html">[次]</a><a href="../list/12301-12400.html">[番号順一覧]</a><a href="../thread/12301-12400.html">[スレッド一覧]</a></p>
<pre class="list"><span class="current">-&gt;&nbsp;<a href="12317.html">  12317 2005-10-29 03:07 ["KIYOSE" &lt;kiyose@xxx] 複合の集計？                            </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12318.html">  12318 2005-10-29 03:32 ┣[nomoto &lt;shin-1@xxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12319.html">  12319 2005-10-29 03:43 ┃┗[nomoto &lt;shin-1@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12323.html">  12323 2005-10-29 19:16 ┗[柴垣 &lt;akiro@xxxxxxxx]                                       </a></span>
</pre>


</body></html>