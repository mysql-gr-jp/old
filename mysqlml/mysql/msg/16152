<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:16152</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="16151">[前]</a><a href="16153">[次]</a><a href="../list/16101-16200">[番号順一覧]</a><a href="../thread/16101-16200">[スレッド一覧]</a></p>
<p class="id">
mysql:16152
</p>
<div class="header">
<p>
From: Yuya Takeyama &lt;Yuya Takeyama &lt;sign.of.the.wolf.pentagram@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 16 Sep 2014 11:24:42 +0900<br>
Subject: [mysql 16152] innodb_file_per_table = 0  で ALTER TABLE  実行時の ibdata1  の拡張について<br>

</p>
</div>
<div class="body">
<pre>
竹山と申します。

以下の状況で ALTER TABLE を実行したとき、ibdata1 の容量がどのように拡張されるかについての質問です。

MySQL のバージョン = 5.1
ストレージエンジン = InnoDB
innodb_file_per_table = 0

ここであるテーブルに ALTER TABLE でインデックスの追加を行いたいのですが、
(厳密には既存 UNIQUE KEY にカラムを追加)
データベース容量がやや苦しい状態となっており、どのように ibdata1 が拡張されるのか、気になっています。

例えば現状 1GB インデックスがあるとして、ALTER TABLE によって 1.1GB になったとき、
その 1.1GB はどこから確保されるのでしょうか。

こちらでは以下の 2 パターン予想しました。

---

1) ibdata1 上全く新たに 1.1GB 確保される

この場合データベース全体のサイズとしては 1.1GB 増えることになると思います。

2) 既存の 1GB が使いまわされた上で、0.1 GB は新たに確保される

この場合はデータベース全体のサイズとしては 0.1 GB 増えることになると思います。

---

根本的な解決としては innodb_file_per_table = 1 にしたうえでデータベース全体の再生成を行う予定ですが、
そちらはまだ先になりそうなので、とりあえずは少しでも容量を節約したい、とうい状態です。

この点についてご存知のどなたか、ご教示いただければ幸いです。

以上、よろしくお願いいたします。

---

Yuya Takeyama

</pre>
</div>
<p class="button"><a href="16151">[前]</a><a href="16153">[次]</a><a href="../list/16101-16200">[番号順一覧]</a><a href="../thread/16101-16200">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="16152">  16152 2014-09-16 11:24 [Yuya Takeyama &lt;sign.] innodb_file_per_table = 0  で ALTER TABLE  実行時の ibdata1  の拡張について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16153">@ 16153 2014-09-16 11:59 ┗[&quot;yoku ts.&quot; &lt;yoku0825] Re: [mysql 16152] innodb_file_per_table = 0 で ALTER TABLE 実行時の ibdata1 の拡張について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16154">@ 16154 2014-09-16 14:33 　┣[&quot;yoku ts.&quot; &lt;yoku0825]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16156">  16156 2014-09-16 14:42 　┃┗[Yuya Takeyama &lt;sign.] Re: [mysql 16154] Re: [mysql 16152] innodb_file_per_table = 0 で ALTER TABLE 実行時の ibdata1 の拡張について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16155">  16155 2014-09-16 14:36 　┗[Yuya Takeyama &lt;sign.] Re: [mysql 16153] Re: [mysql 16152] innodb_file_per_table = 0 で ALTER TABLE 実行時の ibdata1 の拡張について</a></span>
</pre>
</body>
</html>
