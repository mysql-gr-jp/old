<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6292</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6291.html">[前]</a><a href="6293.html">[次]</a><a href="../list/6201-6300.html">[番号順一覧]</a><a href="../thread/6201-6300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:6292
</p>
<div class="header">
<p>
From: &quot;kosugi&quot; &lt;&quot;kosugi&quot; &lt;kosugi@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 27 Sep 2002 11:58:43 +0900<br>
Subject: [mysql 06292] Re: insert 後すぐにそのデータを select    でよびだすと autoincrement    のデータが読めないことがあります。<br>

</p>
</div>
<div class="body">
<pre>
小杉です

<span class="quote1">&gt; このようにしています。この時に予約番号のみ表示されません。（他</span>
のデータは表示
<span class="quote1">&gt; されます。）</span>

表示されたデータのサンプルがあるほうがわかりやすいと思います。

date='$yoyakubi'
に合致するレコードがない場合、レコードセットが返らないので、$name
や、$yoyakubiなどのデータの更新は起きず、登録時のデータが表示され
ているだけではありませんか？
レコードセットが返らなければ、エラーを表示するなどの例外処理を入
れるとか、SQL用の変数名と、呼び出した結果を入れる変数名を変えてみ
ないと、原因の切り分けができないかと。

<span class="quote1">&gt; //登録した情報を呼び出す。</span>
<span class="quote1">&gt; $result_touroku=mysql_query(&quot;select * from date_data</span>
<span class="quote1">&gt;    where name = '$name' and date = '$yoyakubi' and time =</span>
'$yoyakutime' &quot;);
<span class="quote1">&gt;  while($row_touroku = mysql_fetch_array($result_touroku)){</span>
<span class="quote1">&gt; $yoyaku_no=$row_touroku[&quot;data_no&quot;];</span>
<span class="quote1">&gt; $yoyakubi=$row_touroku[&quot;yoyakubi&quot;];</span>
<span class="quote1">&gt; $date=$row_touroku[&quot;date&quot;];</span>
<span class="quote1">&gt; $yoyakutime=$row_touroku[&quot;time&quot;];</span>
<span class="quote1">&gt; $name=$row_touroku[&quot;name&quot;];</span>
<span class="quote1">&gt; $age=$row_touroku[&quot;age&quot;];</span>
<span class="quote1">&gt; $sex=$row_touroku[&quot;sex&quot;];</span>
<span class="quote1">&gt; $renraku=$row_touroku[&quot;renraku&quot;];</span>
<span class="quote1">&gt; $tel=$row_touroku[&quot;tel&quot;];</span>
<span class="quote1">&gt; $e_mail=$row_touroku[&quot;e_mail&quot;];</span>
<span class="quote1">&gt; $item=$row_touroku[&quot;item&quot;];</span>
<span class="quote1">&gt; $memo=$row_touroku[&quot;memo&quot;];</span>
<span class="quote1">&gt; $bikou=$row_touroku[&quot;bikou&quot;];</span>
<span class="quote1">&gt; $pass=$row_touroku[&quot;pass&quot;];</span>
<span class="quote1">&gt; }</span>


ところで

<span class="quote1">&gt; $result_touroku=mysql_query(&quot;select * from date_data</span>
<span class="quote1">&gt;    where name = '$name' and date = '$yoyakubi' and time =</span>
'$yoyakutime' &quot;);
<span class="quote1">&gt;</span>

dateとyoyakubiの違いがわからないので、なんともいえないのですが・
・
date='$yoyakubi'は、yoyakubi='$yoyakubi'でいいかなとおもうのです
が、
date='$yoyakubi'にしているのはなぜですか？


MySQL的には、autoincrementしたデータが読めないことがあるとした
ら、どういうケースなのだろうと、詳しいの方の意見を待ちたいです。


--
Tomoaki Kosugi
kosugi@xxxxxxxxxx




----- Original Message -----
From: &quot;Higashi Kanemitsu&quot; &lt;kanemitsu@xxxxxxxxxx&gt;
To: &lt;ml@xxxxxxxxxx&gt;
Sent: Friday, September 27, 2002 11:31 AM
Subject: <a href="06291.html">[mysql 06291]</a> insert 後すぐにそのデータを select でよび
だすと autoincrement のデータが読めないことがあります。
<span class="quote1">&gt;</span>
<span class="quote1">&gt; //データ番号　data_noはautoincrement機能を用いて、insert文には</span>
入っていませ
<span class="quote1">&gt; ん。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; //登録した情報を呼び出す。</span>
<span class="quote1">&gt; $result_touroku=mysql_query(&quot;select * from date_data</span>
<span class="quote1">&gt;    where name = '$name' and date = '$yoyakubi' and time =</span>
'$yoyakutime' &quot;);
<span class="quote1">&gt;  while($row_touroku = mysql_fetch_array($result_touroku)){</span>
<span class="quote1">&gt; $yoyaku_no=$row_touroku[&quot;data_no&quot;];</span>
<span class="quote1">&gt; $yoyakubi=$row_touroku[&quot;yoyakubi&quot;];</span>
<span class="quote1">&gt; $date=$row_touroku[&quot;date&quot;];</span>
<span class="quote1">&gt; $yoyakutime=$row_touroku[&quot;time&quot;];</span>
<span class="quote1">&gt; $name=$row_touroku[&quot;name&quot;];</span>
<span class="quote1">&gt; $age=$row_touroku[&quot;age&quot;];</span>
<span class="quote1">&gt; $sex=$row_touroku[&quot;sex&quot;];</span>
<span class="quote1">&gt; $renraku=$row_touroku[&quot;renraku&quot;];</span>
<span class="quote1">&gt; $tel=$row_touroku[&quot;tel&quot;];</span>
<span class="quote1">&gt; $e_mail=$row_touroku[&quot;e_mail&quot;];</span>
<span class="quote1">&gt; $item=$row_touroku[&quot;item&quot;];</span>
<span class="quote1">&gt; $memo=$row_touroku[&quot;memo&quot;];</span>
<span class="quote1">&gt; $bikou=$row_touroku[&quot;bikou&quot;];</span>
<span class="quote1">&gt; $pass=$row_touroku[&quot;pass&quot;];</span>
<span class="quote1">&gt; }</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; //後はこの呼び出したデータをhtmlで表示しています。</span>
<span class="quote1">&gt; &lt;table border=1 width=80%&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;td colspan=3 bgcolor=blue align=center&gt;</span>
<span class="quote1">&gt; &lt;font color=white&gt;予約情報　変更後画面 予約番号：&lt;? echo</span>
$yoyaku_no; ?&gt; 番
<span class="quote1">&gt; &lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="quote1">&gt; &lt;tr&gt;&lt;td&gt;日付</span>
<span class="quote1">&gt; −−−−−</span>
<span class="quote1">&gt; このようにしています。この時に予約番号のみ表示されません。（他</span>
のデータは表示
<span class="quote1">&gt; されます。）</span>
<span class="quote1">&gt; データ番号は、後でみるときちんと記入されています。</span>
<span class="quote1">&gt; &lt;last_insert_id() を使ってますよね？&gt;とのコメントをいただきまし</span>
たが、これと
<span class="quote1">&gt; 関連があるのでしょうか。</span>
<span class="quote1">&gt;</span>




</pre>
</div>
<p class="button"><a href="6291.html">[前]</a><a href="6293.html">[次]</a><a href="../list/6201-6300.html">[番号順一覧]</a><a href="../thread/6201-6300.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="6290.html">   6290 2002-09-27 09:10 [&quot;山崎　昌裕&quot; &lt;yamaza] MySQL のインターフェイスを直接 VC++6.0 で使用する方法</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6291.html">   6291 2002-09-27 11:31 ┣[&quot;Higashi Kanemitsu&quot; ] insert 後すぐにそのデータを select    でよびだすと autoincrement    のデータが読めないことがあります。</a></span>
<span class="current">-&gt;&nbsp;<a href="6292.html">   6292 2002-09-27 11:58 ┃┣[&quot;kosugi&quot; &lt;kosugi@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6294.html">   6294 2002-09-27 12:54 ┃┃┗[&quot;Higashi Kanemitsu&quot; ]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6295.html">   6295 2002-09-27 14:09 ┃┃　┗[&quot;Takashi Yamashita&quot; ]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6293.html">   6293 2002-09-27 12:00 ┃┣[&quot;Takashi Yamashita&quot; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6299.html">   6299 2002-09-27 17:44 ┃┗[Daiju Azuma &lt;daiju_a]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6300.html">   6300 2002-09-27 21:45 ┃　┗[&lt;kanemitsu@xxxxxxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6296.html">   6296 2002-09-27 14:31 ┗[Takeyuki Miyagawa &lt;m]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6297.html">   6297 2002-09-27 14:48 　┗[&quot;山崎　昌裕&quot; &lt;yamaza]                                     </a></span>
</pre>
</body>
</html>
