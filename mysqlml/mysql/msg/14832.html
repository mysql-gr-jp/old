<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:14832</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="14831.html">[前]</a><a href="14833.html">[次]</a><a href="../list/14801-14900.html">[番号順一覧]</a><a href="../thread/14801-14900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:14832
</p>
<div class="header">
<p>
From: Shuji Watanabe &lt;Shuji Watanabe &lt;shuji.w6e@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 7 May 2009 11:50:21 +0900<br>
Subject: [mysql 14832] Re: テーブルごとの合計を求めるには<br>

</p>
</div>
<div class="body">
<pre>
渡辺です。
なんでSQLでやらなければいけないか、疑問ですが・・・

select m.name, sum(m.uri), sum(m.nyu)
from
(
(select name, kingaku as uri, 0 as nyu from u)
union
(select name, 0 as uri, kingaku as nyu from n)
) m
group by m.name

こんな感じで可能は可能だと思います。
#動作は未確認です
普通は別々に習得してプログラムでマージするなりする方が単純で解りやすく、バグも少ないしし、仕様変更にも強いと思いますよ。

2009/05/07 11:35 柴垣 &lt;akiro@xxxxxxxxxx&gt;:
<span class="quote1">&gt; 柴垣といいます。いつも勉強させていただいています。</span>
<span class="quote1">&gt; sqlの書き方の投稿が続いているので、それに乗っかって・・</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 以下のような３つのテーブルがあったときに</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 名前テーブル:T</span>
<span class="quote1">&gt; Name</span>
<span class="quote1">&gt; A</span>
<span class="quote1">&gt; B</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 売上テーブル:U</span>
<span class="quote1">&gt; Name   Kingaku</span>
<span class="quote1">&gt; A       1000</span>
<span class="quote1">&gt; A       2000</span>
<span class="quote1">&gt; B       2000</span>
<span class="quote1">&gt; B       3000</span>
<span class="quote1">&gt; B       1000</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 入金テーブル:N</span>
<span class="quote1">&gt; Name   Kingaku</span>
<span class="quote1">&gt; A       1000</span>
<span class="quote1">&gt; A       1000</span>
<span class="quote1">&gt; A       2000</span>
<span class="quote1">&gt; B       3000</span>
<span class="quote1">&gt; B       4000</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 次のようなテーブルごとの集計を一つのクエリーで作る方法は</span>
<span class="quote1">&gt; あるのでしょうか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 求めたい結果セット</span>
<span class="quote1">&gt; Name  UriageGokei  NyukinGokei</span>
<span class="quote1">&gt; A           3000          4000</span>
<span class="quote1">&gt; B           6000          7000</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ※ 例えば次のように書くと、重複して合計を取ってしまいます。</span>
<span class="quote1">&gt; select T.Name,</span>
<span class="quote1">&gt; sum(U.Kingaku) as UriageGokei,</span>
<span class="quote1">&gt; sum(N.Kingaku) as NyukinGokei</span>
<span class="quote1">&gt; from T</span>
<span class="quote1">&gt; left join U on T.Name=U.Name</span>
<span class="quote1">&gt; left join N on T.Name=N.Name</span>
<span class="quote1">&gt; group by T.Name;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; _/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;  柴垣　 akiro@xxxxxxxxxx</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; _/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>



-- 
================================
Shuji Watanabe (skypeId: shuji.w6e)
  Blog:
    <a href="http://d.hatena.ne.jp/shuji_w6e/">http://d.hatena.ne.jp/shuji_w6e/</a>
  Labo:
    <a href="http://www.deathmarch.jp/">http://www.deathmarch.jp/</a>
  Community:
    <a href="http://www.sapporo-java.org/">http://www.sapporo-java.org/</a>

</pre>
</div>
<p class="button"><a href="14831.html">[前]</a><a href="14833.html">[次]</a><a href="../list/14801-14900.html">[番号順一覧]</a><a href="../thread/14801-14900.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="14831.html">  14831 2009-05-07 11:35 [柴垣 &lt;akiro@xxxxxxxx] テーブルごとの合計を求めるには          </a></span>
<span class="current">-&gt;&nbsp;<a href="14832.html">  14832 2009-05-07 11:50 ┣[Shuji Watanabe &lt;shuj]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14833.html">  14833 2009-05-07 12:21 ┗[HIRATSUKA Sadao &lt;hir]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14835.html">  14835 2009-05-08 00:42 　┗[柴垣 &lt;akiro@xxxxxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14836.html">  14836 2009-05-08 02:00 　　┗[ユウシステム 糸瀬 &lt;i]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14837.html">  14837 2009-05-08 09:42 　　　┗[柴垣 &lt;akiro@xxxxxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14838.html">  14838 2009-05-08 10:00 　　　　┗[Shuji Watanabe &lt;shuj]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14839.html">  14839 2009-05-08 10:59 　　　　　┗[ユウシステム 糸瀬 &lt;i]                             </a></span>
</pre>
</body>
</html>
