<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13762</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13761.html">[前]</a><a href="13763.html">[次]</a><a href="../list/13701-13800.html">[番号順一覧]</a><a href="../thread/13701-13800.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13762
</p>
<div class="header">
<p>
From: kurokawa &lt;kurokawa &lt;ml@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 23 Feb 2007 14:50:02 +0900<br>
Subject: [mysql 13762] Re: 処理速度について<br>

</p>
</div>
<div class="body">
<pre>
平井さん

solでございます。

WindowsのODBC設定項目でコネクションプール設定が見つかると思います。
（コントロールパネルの中のODBCの該当箇所）

PHPは標準で・・・


MySQLとても高速ですが、コネクションを新規に張るときは若干
処理に時間を要します。

立て続けにコネクションの接続切り離しを繰り返しますと
その処理時間が最大だったりすることが多いです。

名前解決に問題があるときは、taimeout待ちするので
だいたい30秒なにもせず、そこからコネクション張りに行く
そんな挙動になります。

IPアドレスで指定されているので、名前解決は無縁そうです。
（oracleの場合は別ですが）


ADOって長く使っていないのですが、接続時、全データ転送とかは
しないんですよね！？
access系エンジン使ったとき、その都度全データ転送されたような・・・




Susumu.Hirai wrote:
<span class="quote1">&gt; solさんすみません、名前記載してませんでしたね。</span>
<span class="quote1">&gt; 平井と申します。改めてよろしくお願いします。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; コネクションプールはVB6では使用できないとか・・・。ADOならできそうな気も </span>
<span class="quote1">&gt; しますが。PHPで組むときもコネクションプールとか気にしたことないので、そ </span>
<span class="quote1">&gt; こら辺も色々調べてみます。</span>
<span class="quote1">&gt; 妹尾さんありがとうございます。ついでにpingも治りました。MySQLへはもちろ </span>
<span class="quote1">&gt; ん自機なので&lt;1msecでした。</span>
<span class="quote1">&gt; ソフトウェアの構成は以下のようになっています。フォームロードの時点で「開 </span>
<span class="quote1">&gt; ける」を行い、起動中は「SQLする」でいくつものデータを処理して、ソフトク </span>
<span class="quote1">&gt; ローズで閉じる処理をしています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; '開ける</span>
<span class="quote1">&gt; Set DBConn = CreateObject(&quot;ADODB.Connection&quot;)</span>
<span class="quote1">&gt; Set DBRS = CreateObject(&quot;ADODB.Recordset&quot;)</span>
<span class="quote1">&gt; DBConn.Open = &quot;DRIVER={MySQL ODBC ・・・&quot;</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 'SQLする</span>
<span class="quote1">&gt; DBRS.Open SQL文, DBConn</span>
<span class="quote1">&gt; Set SQL_String = DBRS.fields</span>
<span class="quote1">&gt; DBRS.Close</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; '閉じる</span>
<span class="quote1">&gt; Set DBRS = Nothing</span>
<span class="quote1">&gt; Set DBConn = Nothing</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; マシンスペック等は以下の通りです。ちなみにPHP+MySQLでは問題なく、長くて </span>
<span class="quote1">&gt; も0.006秒以下の処理がVB6＋MySQLなら3.4秒かかります。こんなものでしょうか？</span>
<span class="quote1">&gt; CPU：PentiumM1.1</span>
<span class="quote1">&gt; RAM：768MB</span>
<span class="quote1">&gt; MySQL：5.0.18-nt</span>
<span class="quote1">&gt; データベースのデータサイズ：96KB</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ----- Original Message ----- From: &quot;kurokawa&quot; &lt;ml@xxxxxxxxxx&gt;</span>
<span class="quote1">&gt; To: &lt;ml@xxxxxxxxxx&gt;</span>
<span class="quote1">&gt; Sent: Friday, February 23, 2007 11:12 AM</span>
<span class="quote1">&gt; Subject: <a href="13758.html">[mysql 13758]</a> Re: 処理速度について</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt;&gt; Susumu.Hiraiさん</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; solでございます</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; コネクションプール設定していますか？</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; P.S.</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 名前くらいは名乗りましょう</span>
<span class="quote2">&gt;&gt; DBのスペック（容量等）、OS、マシンスペック明示しましょう</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; Susumu.Hirai wrote:</span>
<span class="quote3">&gt;&gt;&gt; いつもお世話になります。</span>
<span class="quote3">&gt;&gt;&gt; VB6+MySQL+ADOでソフトを構築していますが、処理が遅すぎて困っています。基</span>
<span class="quote3">&gt;&gt;&gt; 本的に３つの関数を作って起動したらSQL_StringでSQLを投げて取得するような</span>
<span class="quote3">&gt;&gt;&gt; やり方をしていますが、★印のあるところで３秒程度かかります。</span>
<span class="quote3">&gt;&gt;&gt; PHP＋MySQLで組む場合と速度が歴然と違いますが、何かいい策はありませんで</span>
<span class="quote3">&gt;&gt;&gt; しょうか？最悪VB6＋MySQL+PHPで組み直そうかと考えていますが・・・。</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; Function SQL_Open()</span>
<span class="quote3">&gt;&gt;&gt;    'SQL接続をオープン</span>
<span class="quote3">&gt;&gt;&gt;    Set DBConn = CreateObject(&quot;ADODB.Connection&quot;)</span>
<span class="quote3">&gt;&gt;&gt;    Set DBRS = CreateObject(&quot;ADODB.Recordset&quot;)</span>
<span class="quote3">&gt;&gt;&gt;    DBConn.Open = &quot;DRIVER={MySQL ODBC 3.51 Driver};&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;SERVER=127.0.0.1;&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;DATABASE=****;&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;UID=****;&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;PASSWORD=****;&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;useUnicode=true &amp;</span>
<span class="quote3">&gt;&gt;&gt; characterEncoding=SJIS;&quot; + _</span>
<span class="quote3">&gt;&gt;&gt;                                 &quot;OPTION=16834;STMT=set names sjis&quot;</span>
<span class="quote3">&gt;&gt;&gt; End Function</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; Function SQL_Close()</span>
<span class="quote3">&gt;&gt;&gt;    'SQL接続を閉じる</span>
<span class="quote3">&gt;&gt;&gt;    Set DBRS = Nothing</span>
<span class="quote3">&gt;&gt;&gt;    Set DBConn = Nothing</span>
<span class="quote3">&gt;&gt;&gt; End Function</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; Function SQL_String(strSQL As String) As Object</span>
<span class="quote3">&gt;&gt;&gt;    'SQLを実行してフィールドを返す</span>
<span class="quote3">&gt;&gt;&gt;    On Error Resume Next</span>
<span class="quote3">&gt;&gt;&gt;    DBRS.Close</span>
<span class="quote3">&gt;&gt;&gt;    DBRS.Open strSQL, DBConn '★ココが時間かかる</span>
<span class="quote3">&gt;&gt;&gt;    Set SQL_String = DBRS.fields</span>
<span class="quote3">&gt;&gt;&gt;    On Error GoTo 0</span>
<span class="quote3">&gt;&gt;&gt; End Function</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>


</pre>
</div>
<p class="button"><a href="13761.html">[前]</a><a href="13763.html">[次]</a><a href="../list/13701-13800.html">[番号順一覧]</a><a href="../thread/13701-13800.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="13755.html">  13755 2007-02-23 10:29 [&quot;Susumu.Hirai&quot; &lt;s_hi] 処理速度について                        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13756.html">  13756 2007-02-23 10:37 ┣[遠藤 俊裕 &lt;endo@xxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13757.html">  13757 2007-02-23 11:10 ┃┗[&quot;Susumu.Hirai&quot; &lt;s_hi]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13759.html">  13759 2007-02-23 11:28 ┃　┗[妹尾純一 &lt;j.senoo@xx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13758.html">  13758 2007-02-23 11:12 ┣[kurokawa &lt;ml@xxxxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13761.html">  13761 2007-02-23 12:18 ┃┗[&quot;Susumu.Hirai&quot; &lt;s_hi]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="13762.html">  13762 2007-02-23 14:50 ┃　┗[kurokawa &lt;ml@xxxxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13763.html">  13763 2007-02-23 15:20 ┃　　┗[&quot;Susumu.Hirai&quot; &lt;s_hi]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13764.html">  13764 2007-02-23 16:07 ┗[Hiroshi Nagasaka &lt;h-]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13765.html">  13765 2007-02-23 16:22 　┗[&quot;Susumu.Hirai&quot; &lt;s_hi]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13766.html">  13766 2007-02-23 17:43 　　┗[遠藤 俊裕 &lt;endo@xxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13768.html">  13768 2007-02-23 21:19 　　　┗[&quot;Susumu.Hirai&quot; &lt;s_hi]                                 </a></span>
</pre>
</body>
</html>
