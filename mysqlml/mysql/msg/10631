<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:10631</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="10630">[前]</a><a href="10632">[次]</a><a href="../list/10601-10700">[番号順一覧]</a><a href="../thread/10601-10700">[スレッド一覧]</a></p>
<p class="id">
mysql:10631
</p>
<div class="header">
<p>
From: Youichi Iwakiri &lt;Youichi Iwakiri &lt;yiwakiri@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 08 Dec 2004 16:36:33 +0900<br>
Subject: [mysql 10631] Re: date_format がうまくできない<br>

</p>
</div>
<div class="body">
<pre>
いわきりです

渡邊昌之 wrote in &lt;20041208055457.BEC9BFD811@xxxxxxxxxx&gt; :
<span class="quote1">&gt;4.0.20のmanual.txtを探ってみましたが</span>
<span class="quote1">&gt;該当する場所を修正したというchangelogは有りませんでした。</span>
<span class="quote1">&gt;また、www.mysql.orgのbugsでサーチしてみましたが、該当する物は</span>
<span class="quote1">&gt;有りませんでした。</span>
<span class="quote1">&gt;致命的じゃないので、特にコメントされなかっただけだと思います。</span>
<span class="quote1">&gt;要するに最低限4.0.20以降を使えば、大丈夫ってことですね。</span>

3系と4系の違いです。
3系は、bugっていたようで、4.0以降修正されています。
動作的には、ISO 8601:1988の下記条件
「日曜から週を開始。戻り値の範囲は 0 〜 53。週 1 は 4 日以上の日を持
つその年の最初の週。」
に沿って、1月1日が木曜以降であればその週に含まれる1月の日数は、
3日以内なので、0が帰ってきています。

対処法としては、
date_format(DATE_STRING, &quot;%U&quot;);
の代わりに
week(DATE_STRING, 2);
を使えば大丈夫です。

<a href="http://dev.mysql.com/doc/mysql/ja/Date_and_time_functions.html">http://dev.mysql.com/doc/mysql/ja/Date_and_time_functions.html</a>
のWEEK(date [,mode])関数の項を参考にしてください。

-- 
Youichi Iwakiri


</pre>
</div>
<p class="button"><a href="10630">[前]</a><a href="10632">[次]</a><a href="../list/10601-10700">[番号順一覧]</a><a href="../thread/10601-10700">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="10618">  10618 2003-12-08 12:33 [&quot;si&quot; &lt;mfcatl2000@xxx] date_format がうまくできない            </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10619">  10619 2004-12-08 13:40 ┣[渡邊昌之 &lt;mark@xxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10622">  10622 2004-12-08 14:08 ┃┗[&quot;si&quot; &lt;mfcatl2000@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10627">  10627 2004-12-08 14:28 ┃　┣[渡邊昌之 &lt;mark@xxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10629">  10629 2004-12-08 14:55 ┃　┃┣[渡邊昌之 &lt;mark@xxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10630">  10630 2004-12-08 16:10 ┃　┃┃┣[&quot;si&quot; &lt;mfcatl2000@xxx]                               </a></span>
<span class="current">-&gt;&nbsp;<a href="10631">  10631 2004-12-08 16:36 ┃　┃┃┗[Youichi Iwakiri &lt;yiw]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10633">  10633 2004-12-08 16:55 ┃　┃┃　┗[&quot;si&quot; &lt;mfcatl2000@xxx]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10634">  10634 2004-12-08 17:03 ┃　┃┗[IWASAKI Dai &lt;dai@xxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10632">  10632 2004-12-08 16:36 ┃　┗[UNO Shintaro &lt;uno@xx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10620">  10620 2004-12-08 13:47 ┗[Daiju &lt;d.is.here@xxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10621">  10621 2004-12-08 14:00 　┗[&quot;si&quot; &lt;mfcatl2000@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10623">  10623 2004-12-08 14:04 　　┗[Daiju &lt;d.is.here@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10624">  10624 2004-12-08 14:19 　　　┗[&quot;si&quot; &lt;mfcatl2000@xxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10626">  10626 2004-12-08 14:26 　　　　┣[渡邊昌之 &lt;mark@xxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10628">  10628 2004-12-08 14:34 　　　　┗[Daiju &lt;d.is.here@xxx]                               </a></span>
</pre>
</body>
</html>
