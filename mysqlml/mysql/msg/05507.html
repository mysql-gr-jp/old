<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5507</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="5506.html">[前]</a><a href="5508.html">[次]</a><a href="../list/5501-5600.html">[番号順一覧]</a><a href="../thread/5501-5600.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5507
</p>
<div class="header">
<p>
From: Kengo Jinno &lt;Kengo Jinno &lt;kengo@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 15 May 2002 11:39:52 +0900<br>
Subject: [mysql 05507] Re: 無謀な挑戦ですが<br>

</p>
</div>
<div class="body">
<pre>
神野です。

Tue, 14 May 2002 21:24:04 +0900 ごろに
&lt;200205141224.VAA20270@xxxxxxxxxx&gt; の
&quot;<a href="05499.html">[mysql 05499]</a> Re: 無謀な挑戦ですが&quot; のメールで
雀怜 &lt;jyakurei@xxxxxxxxxx&gt; さんは書きました。

<span class="quote1">&gt; <a href="03497.html">[mysql 03497]</a> に記述されているとおりに</span>
<span class="quote1">&gt; implib -c -a libmySQL.lib libmySQL.dll</span>
<span class="quote1">&gt; とやってD:\mysql\bin\libmySQL.dllからlibmySQL.libを</span>
<span class="quote1">&gt; 作成するということですよね。</span>
<span class="quote1">&gt; フリー版にもimplib.exeが含まれていますので、</span>
<span class="quote1">&gt; 勿論やってみましたが、やっぱり成功しません。</span>

「リンクに失敗する」ということですか？

winclientのバージョンにもよるようなのですが、
私の手元の環境では、<a href="05493.html">[mysql 05493]</a>のソースを使って

<span class="quote2">| &gt;implib -a libmysql.lib libmysql.dll</span>
<span class="quote1">| </span>
<span class="quote1">| Borland Implib Version 3.0.22 Copyright (c) 1991, 2000 Inprise Corporation</span>
<span class="quote1">| </span>
<span class="quote2">| &gt;bcc32 arp3.c libmysql.lib</span>
<span class="quote1">| Borland C++ 5.5.1 for Win32 Copyright (c) 1993, 2000 Borland</span>
<span class="quote1">| arp3.c:</span>
<span class="quote1">| 警告 W8070 arp3.c 24: 関数は値を返すべき(関数 main )</span>
<span class="quote1">| 警告 W8004 arp3.c 8: 'mysqldb' に代入した値は使われていない(関数 main )</span>
<span class="quote1">| Turbo Incremental Link 5.00 Copyright (c) 1997, 2000 Borland</span>

と、リンクは通りました。
＃変更点はmysql.hの前にwinsock.hをincludeしただけ。

<a href="05493.html">[mysql 05493]</a>を見ますと、

<span class="quote1">&gt; Error: 外部シンボル 'mysql_connect' が未解決</span>
<span class="quote1">&gt; Error: 外部シンボル 'mysql_select_db' が未解決</span>
<span class="quote1">&gt; Error: 外部シンボル 'mysql_query' が未解決</span>
<span class="quote1">&gt; と、やはりリンクに失敗してしまいます。</span>

と、'_'無しのエクスポート名を必要としているようです。
となると、implibの-aオプションは不要で、
implib libmysql.lib libmysql
あるいは
implib -c libmysql.lib libmysql
でインポートライブラリを作成するとどうでしょう？

逆に私の環境では、'_'付きのエクスポート名が必要なので、
-aオプションを使ってないとリンクに失敗します。

-- 
神野健吾 &lt;kengo@xxxxxxxxxx&gt;

</pre>
</div>
<p class="button"><a href="5506.html">[前]</a><a href="5508.html">[次]</a><a href="../list/5501-5600.html">[番号順一覧]</a><a href="../thread/5501-5600.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5493.html">   5493 2002-05-13 17:06 [雀怜 &lt;jyakurei@xxxxx] 無謀な挑戦ですが                        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5494.html">   5494 2002-05-13 17:15 ┗[Tomohiro 'Tomo-p' KA]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5499.html">   5499 2002-05-14 21:24 　┗[雀怜 &lt;jyakurei@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5502.html">   5502 2002-05-15 01:37 　　┣[Jyoji Irisa &lt;uc6j-ir]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="5507.html">   5507 2002-05-15 11:39 　　┗[Kengo Jinno &lt;kengo@x]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5511.html">   5511 2002-05-17 13:01 　　　┗[雀怜 &lt;jyakurei@xxxxx] どちらも失敗するんです          </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5512.html">   5512 2002-05-17 13:15 　　　　┗[Kengo Jinno &lt;kengo@x]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5513.html">   5513 2002-05-17 13:48 　　　　　┗[雀怜 &lt;jyakurei@xxxxx] 環境が違うんですね          </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5514.html">   5514 2002-05-17 14:05 　　　　　　┗[Kengo Jinno &lt;kengo@x]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5515.html">   5515 2002-05-18 10:32 　　　　　　　┗[雀怜 &lt;jyakurei@xxxxx]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5523.html">   5523 2002-05-21 12:01 　　　　　　　　┗[Kengo Jinno &lt;kengo@x]                       </a></span>
</pre>
</body>
</html>
