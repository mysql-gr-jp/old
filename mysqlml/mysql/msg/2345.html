<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:2345</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="2344.html">[前]</a><a href="2346.html">[次]</a><a href="../list/2301-2400.html">[番号順一覧]</a><a href="../thread/2301-2400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:2345
</p>
<div class="header">
<p>
From: (遠藤　俊裕) &lt;&lt;endo@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 04 Aug 2000 14:49:43 +0900<br>
Subject: [mysql 02345] 集計のクエリーの書き方<br>

</p>
</div>
<div class="body">
<pre>
遠藤です。

お教えください。

以下のようなテーブルがあるとします。

mast [create table mast ( code integer, point integer, name char (10)) ]
  code: integer;
  point: integer;
  name: char(10);

tran [create table tran ( code integer, check char(1)) ]
  code: integer;
  check: char(1);

ここでデータが以下のようになっています。

mast
  1, 10, aaa
  2, 20, bbb
  3, 30, ccc

tran
  1, 0
  1, 0
  1, 1
  1, 1
  2, 1
  3, 0
  3, 0

この状態で結果を

   aaa, 10, 4, 40, 2, 20
   bbb, 20, 1, 20, 1, 20
   ccc, 30, 2, 60, 0,  0

としたいのですが、どうすれば良いのでしょうか？
要するにチェック項目によって内数をカウントしたいのです。

以下の SQL で
   aaa, 10, 4, 40
   bbb, 20, 1, 20
   ccc, 30, 2, 60
とは出来たのですが、これ以上、どうしてもわかりません。

SELECT mast.name, mast.point, COUNT(mast.name), SUM(mast.point) FROM tran
LEFT JOIN mast ON mast.code=tran.code GROUP BY mast.name, mast.point
ORDER BY mast.name

出来るだけ方言を使わずに SQL のみの機能で何とかならないものかと
悩んでおります。SQL を数本使ってテンポラリテーブルを作るのでも
最悪構いません。その場合は効率の良い方法を知りたいです。
よろしくご教授ください。m(_ _)m

</pre>
</div>
<p class="button"><a href="2344.html">[前]</a><a href="2346.html">[次]</a><a href="../list/2301-2400.html">[番号順一覧]</a><a href="../thread/2301-2400.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="2345.html">   2345 2000-08-04 14:49 [&lt;endo@xxxxxxxxxx&gt;   ] 集計のクエリーの書き方                  </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2346.html">   2346 2000-08-04 15:56 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="2352.html">   2352 2000-08-05 22:47 　┗[&lt;endo@xxxxxxxxxx&gt;   ]                                     </a></span>
</pre>
</body>
</html>
