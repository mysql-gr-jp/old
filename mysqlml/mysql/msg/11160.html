<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:11160</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="11159.html">[前]</a><a href="11161.html">[次]</a><a href="../list/11101-11200.html">[番号順一覧]</a><a href="../thread/11101-11200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:11160
</p>
<div class="header">
<p>
From: 東原　正智 &lt;東原　正智 &lt;ZAP02756@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 14 Mar 2005 01:55:12 +0900<br>
Subject: [mysql 11160] Re: MySQLDriverCSを使っての接<br>

</p>
</div>
<div class="body">
<pre>
すみません。自己レスです。

MySQLDriverCSをあきらめ、MyODBCにて接続できました。
一応まとめておきます。お騒がせしました。
MySQLDriverCSの原因などご存知の方は、教えていただければ幸いです。
[環境]
MyODBC-3.51.11-1
MySQL4.1.10
VB.NET(2003)使用
[目的]
別マシンのサーバーに対してVB.NETよりIPを指定して接続、select.
[参照設定]
・Microsoft.Data.Odbc
・System
・System.Data
[Source]
Imports Microsoft.Data.Odbc
Imports System

Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As 
System.EventArgs) Handles Button1.Click
        Try
            'MySQLへの接続
            'MyODBC 3.51を使用
            '宣言
            'MyODBC 3.51 Connectionstring
            Dim MyConString As String = _
                 &quot;DRIVER={MySQL ODBC 3.51 Driver};&quot; &amp; _
                 &quot;SERVER=*.*.*.*;&quot; &amp; _
                 &quot;DATABASE=db;&quot; &amp; _
                 &quot;UID=***;&quot; &amp; _
                 &quot;PASSWORD=*****;&quot; &amp; _
                 &quot;OPTION=3;&quot;
            'Connection
            Dim MyConnection As New OdbcConnection(MyConString)
            MyConnection.Open()
            MsgBox(&quot;DBに接続しました&quot;)
            Console.WriteLine(&quot;Connection State::&quot; &amp; _          
                         MyConnection.State.ToString)
            Dim MyCommand As New OdbcCommand
            MyCommand.Connection = MyConnection
            'SELECT
            Console.WriteLine(&quot;Select field1,field2 _
                        FROM db.table&quot;)
            MyCommand.CommandText = &quot;SELECT field1,field2 _
                        FROM db.table;&quot;
            'DataReaderでの読込み
            Dim MyDataReader As OdbcDataReader
            MyDataReader = MyCommand.ExecuteReader
            While MyDataReader.Read
                If MyDataReader(&quot;field1&quot;) Is DBNull.Value Then
                    Console.WriteLine(&quot;field1= &quot; &amp; _
                        CStr(MyDataReader(&quot;field1&quot;)) &amp;_
                        &quot;field2 =&quot; &amp; &quot;NULL&quot;)
                Else
                    Console.WriteLine(&quot;field1= &quot; &amp; _
                        CStr(MyDataReader(&quot;field1&quot;)) &amp; _
                        &quot; field2 = &quot; &amp; _
                        CStr(MyDataReader(&quot;field2 &quot;)))
                End If
            End While
            'Catch ODBC Exception
        　　Catch MyOdbcException As OdbcException
            Dim i As Integer
            Console.WriteLine(MyOdbcException.ToString)
            'Catch program exception
        　　Catch MyException As Exception
            Console.WriteLine(MyException.ToString)
        End Try
End Sub

</pre>
</div>
<p class="button"><a href="11159.html">[前]</a><a href="11161.html">[次]</a><a href="../list/11101-11200.html">[番号順一覧]</a><a href="../thread/11101-11200.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="11159.html">  11159 2005-03-13 21:13 [東原　正智 &lt;ZAP02756] MySQLDriverCSを使っての接続             </a></span>
<span class="current">-&gt;&nbsp;<a href="11160.html">  11160 2005-03-14 01:55 ┗[東原　正智 &lt;ZAP02756] Re: MySQLDriverCSを使っての接         </a></span>
</pre>
</body>
</html>
