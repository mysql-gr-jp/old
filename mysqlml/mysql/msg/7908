<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:7908</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="7907">[前]</a><a href="7909">[次]</a><a href="../list/7901-8000">[番号順一覧]</a><a href="../thread/7901-8000">[スレッド一覧]</a></p>
<p class="id">
mysql:7908
</p>
<div class="header">
<p>
From: Sato Hiroyuki &lt;Sato Hiroyuki &lt;sato.hiroyuki657@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 17 Jun 2003 12:19:08 +0900<br>
Subject: [mysql 07908] バッチファイルからの起動<br>

</p>
</div>
<div class="body">
<pre>
佐藤と申します。

初めての投稿です。
MYSQLの問題ではないかも知れませんが、御教授頂ければと思い投稿しました。

MYSQL実行環境は下記の通りです。

クライアント
OS:WIN2000SP2
ツール：VB6.0SP5

サーバー
NT4.0SP6.0
MYSQL VER4.0.12

ここで、PERLのDB更新用ファイル（クライアント側に存在）を、
クライアントのＶＢプログラムからSHELL関数を使用して、起動すると
うまくDBの更新ができません。実行前後でDB側は何もかわらず、
エラーメッセージも表示されません。

ＤＯＳ環境からこのPERLファイルを実行すると当然うまく更新のですが、
プログラム側からは実行できないのでしょうか？

-------- PERLファイル TEST.PL
use DBI;

$db = DBI-&gt;connect('DBI:mysql:temp:172.16.86.87','root','12345');
$sth = $db-&gt;prepare(&quot;INSERT INTO MOI VALUES ('NULL','2003/05/23','19891','ASI3','RH7-
1472-000000','RH7-1472 12345','2003/03/20','2400','2');&quot;);
$sth-&gt;execute;

$sth = $db-&gt;prepare(&quot;SELECT * FROM MOI&quot;);
$sth-&gt;execute;

$num_rows = $sth-&gt;rows;
print &quot;$num_rows 件見つかりました。\n&quot;;

$sth-&gt;finish;
$db-&gt;disconnect;

--------- ＶＢ６．０ファイル

Private Sub Command1_Click()
    Dim I As Integer
    
    I = Shell(&quot;c:\perl\bin\perl test.pl&quot;, 3)
    MsgBox &quot;実行結果=&quot; &amp; I
End Sub

※Ｉはプログラムのタスクコードで、きちんとエラー以外（０以外）の
実行結果が代入されて返ってきます。

-------------
Sato Hiroyuki


</pre>
</div>
<p class="button"><a href="7907">[前]</a><a href="7909">[次]</a><a href="../list/7901-8000">[番号順一覧]</a><a href="../thread/7901-8000">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="7908">   7908 2003-06-17 12:19 [Sato Hiroyuki &lt;sato.] バッチファイルからの起動                </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7909">   7909 2003-06-17 12:25 ┣[&quot;TOYOSHIMA,Masayuki&quot;]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7910">   7910 2003-06-17 12:35 ┗[A.K.I. &lt;aki@xxxxxxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="7911">   7911 2003-06-17 13:32 　┗[Sato Hiroyuki &lt;sato.]                                     </a></span>
</pre>
</body>
</html>
