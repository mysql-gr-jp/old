<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5165</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5164.html">[前]</a><a href="5166.html">[次]</a><a href="../list/5101-5200.html">[番号順一覧]</a><a href="../thread/5101-5200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5165
</p>
<div class="header">
<p>
From: Kengo Jinno &lt;Kengo Jinno &lt;kengo@xxxxxxxxxx&gt;&gt;<br>
Date: Sun, 17 Feb 2002 09:10:29 +0900<br>
Subject: [mysql 05165] Re: MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？<br>

</p>
</div>
<div class="body">
<pre>
神野です。

Sat, 16 Feb 2002 16:11:18 +0900 ごろに
&lt;001101c1b6b9$2517b440$d54afea9@ot2&gt; の
&quot;<a href="05160.html">[mysql 05160]</a> MyODBC 経由・ Accessの DAO でロックはかけられるのでしょうか？&quot; のメールで
&quot;AN/NaNa_レディス_メンズ_ダンス&quot; &lt;an-nana@xxxxxxxxxx&gt; さんは書きました。

<span class="quote1">&gt; そこで質問なのですが、MyODBCを使ってDAOでテーブルに</span>
<span class="quote1">&gt; アクセスし、データの更新やレコードの新規追加をしよう</span>
<span class="quote1">&gt; とした場合、ロックはAccess既定のロックが適用されるの</span>
<span class="quote1">&gt; でしょうか？</span>
<span class="quote1">&gt; それともそれは無視されて、ロックがかからない状態</span>
<span class="quote1">&gt; になっているのでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 今現在、以下のコードでテーブルデータの更新等が可能だ</span>
<span class="quote1">&gt; ということまではわかりましたが、ロックが実際のところ</span>
<span class="quote1">&gt; どのようになっているかがわかりません。</span>

テストの結果を見る限り、ロックはかかっていないように思います。
「rs.LockEdits = True」が実際にどのように作用するのか
わかりませんが、少なくともmysqlに対しては期待通りには
機能していないようです。
＃他のオプション等でなんとかできるものなのかもしれませんが。

<span class="quote1">&gt; 何か良い判断方法、チェック方法がありましたら、何卒</span>
<span class="quote1">&gt; ご教授ください。また、正しいロックのかけ方が他にある</span>
<span class="quote1">&gt; のならそちらもお教え頂けませんでしょうか？</span>

mysqlの、LOCK TABLESを直接使えばいいのではないでしょうか？

<a href="http://www.mysql.gr.jp/jpdoc/3.23/manual.ja_toc.html#LOCK_TABLES">http://www.mysql.gr.jp/jpdoc/3.23/manual.ja_toc.html#LOCK_TABLES</a>

Access (DAO)でSQL文を直接実行する方法がわかりませんが、
仮にfooだとして、

    rs.foo( &quot;LOCK TABLES msg WRITE&quot; )
    
    rs.Edit
    
    rs!入庫 = 3
    
    rs.Update
    
    rs.foo( &quot;UNLOCK TABLES msg&quot; )

のような感じでしょうか。
＃SQL文の末尾にセミコロンが必要かも。

-- 
神野健吾 &lt;kengo@xxxxxxxxxx&gt;

</pre>
</div>
<p class="button"><a href="5164.html">[前]</a><a href="5166.html">[次]</a><a href="../list/5101-5200.html">[番号順一覧]</a><a href="../thread/5101-5200.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="5157.html">   5157 2002-02-15 22:34 [Shin-ichi Tsurunaga ] オフ会総括                              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5158.html">   5158 2002-02-16 00:10 ┣[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5159.html">   5159 2002-02-16 09:30 ┣[遠藤 俊裕 &lt;endo_t@xx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5160.html">   5160 2002-02-16 16:11 ┃┣[&quot;AN/NaNa_レディス_メ] MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span class="current">-&gt;&nbsp;<a href="5165.html">   5165 2002-02-17 09:10 ┃┃┗[Kengo Jinno &lt;kengo@x]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5184.html">   5184 2002-02-20 10:51 ┃┃　┗[&quot;AN/NaNa_レディス_メ] [ お礼 ]MyODBC  経由・ Access  の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5185.html">   5185 2002-02-20 16:39 ┃┃　　┗[&quot;AN/NaNa_レディス_メ] [ できました ]MyODBC 経由・ Access の DAO でロックはかけられるのでしょうか？</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5161.html">   5161 2002-02-16 17:50 ┃┗[&quot;Y. Tsutsui&quot; &lt;tutui@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5171.html">   5171 2002-02-17 14:16 ┃　┣[とみたまさひろ &lt;tomm]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5180.html">   5180 2002-02-18 13:01 ┃　┃┗[遠藤 俊裕 &lt;endo_t@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5172.html">   5172 2002-02-17 14:50 ┃　┗[Hidesuke Shimada &lt;hi]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5166.html">   5166 2002-02-17 10:23 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
</pre>
</body>
</html>
