<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8359</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="8358">[前]</a><a href="8360">[次]</a><a href="../list/8301-8400">[番号順一覧]</a><a href="../thread/8301-8400">[スレッド一覧]</a></p>
<p class="id">
mysql:8359
</p>
<div class="header">
<p>
From: &quot;HIROSE, Masaaki&quot; &lt;&quot;HIROSE, Masaaki&quot; &lt;hirose31@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 03 Nov 2003 18:08:37 +0900<br>
Subject: [mysql 08359] Re: レプリケーションの整合性チェック<br>

</p>
</div>
<div class="body">
<pre>
ひろせといいます

on &quot;<a href="08341">[mysql 08341]</a> レプリケーションの整合性チェック&quot;
   &lt;20031030074211.15709.ryo@xxxxxxxxxx&gt;
at Thu, 30 Oct 2003 16:42:11 +0900
   Okamoto RYO &lt;ryo@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; 現在、mysql 4.0.15a + InnoDB + FreeBSD を用いて</span>
<span class="quote1">&gt; レプリケーションのテストを行っています。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; レプリケーションが正しく運用されていることを定期的に</span>
<span class="quote1">&gt; チェックする仕組みが欲しいのですが、何を基準に</span>
<span class="quote1">&gt; 判別すべきかよくわかりません。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ひとつは、show slave status した際の Read_Master_Log_Pos</span>
<span class="quote1">&gt; カラムの数値と show master status した際の Position</span>
<span class="quote1">&gt; カラムの数値を比較し、合致していれば良いのかなと</span>
<span class="quote1">&gt; 考えているのですが、確証が持てません。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 1) そもそもこれらのキーを基に判別して良いのか</span>
<span class="quote1">&gt; 	（Exec_master_log_pos との違いは？）</span>
<span class="quote1">&gt; 2) 整合性が維持されていれば必ず一致するのかどうか</span>
<span class="quote1">&gt; 3) ネットワーク（その他の）遅延をどう考慮するか</span>

理想的には、master の Position、slave の Read_Master_Log_Pos,
Exec_Master_Log_Pos の 3 つの値が常に一致しているとよいのですが、
master に更新系のクエリが多かったり、master - slave 間のネットワークが
遅かったり、master に比べて貧弱だったり他の要因で負荷がかかったりして
いて slave の SQL スレッドの処理が遅れているなどなどの理由で、これら 3
つの値がいつも同一となるとは限らないと思いますし、同一でないからといっ
てレプリケーションが正常動作していないとは言えないと思います。

<span class="quote1">&gt; 同時に、show slave status した際の Slave_IO_Running</span>
<span class="quote1">&gt; カラムと Slave_SQL_Running カラムもチェック</span>
<span class="quote1">&gt; すべきかどうかも迷うところです。</span>

遅延があるかもしれませんが、これら両方が Yes ならばレプリケーションは
動作中と判断できると思います。

                                  //

O'REILLY の『High Performance MySQL』(12/1発売)が楽しみなんですが、どっ
かに目次とか出てないすかね。

ではでは

-- 
ひろせ

</pre>
</div>
<p class="button"><a href="8358">[前]</a><a href="8360">[次]</a><a href="../list/8301-8400">[番号順一覧]</a><a href="../thread/8301-8400">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="8341">   8341 2003-10-30 16:42 [Okamoto RYO &lt;ryo@xxx] レプリケーションの整合性チェック        </a></span>
<span class="current">-&gt;&nbsp;<a href="8359">   8359 2003-11-03 18:08 ┗[&quot;HIROSE, Masaaki&quot; &lt;h]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8360">   8360 2003-11-03 18:37 　┣[Okamoto RYO &lt;ryo@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8361">   8361 2003-11-03 21:52 　┗[とみたまさひろ &lt;tomm]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8375">   8375 2003-11-05 01:18 　　┗[Okamoto RYO &lt;ryo@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8379">   8379 2003-11-06 02:05 　　　┗[&quot;HIROSE, Masaaki&quot; &lt;h]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8380">   8380 2003-11-07 00:05 　　　　┗[とみたまさひろ &lt;tomm]                               </a></span>
</pre>
</body>
</html>
