<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:471</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="470.html">[前]</a><a href="472.html">[次]</a><a href="../list/401-500.html">[番号順一覧]</a><a href="../thread/401-500.html">[スレッド一覧]</a></p>
<p class="id">
mysql:471
</p>
<div class="header">
<p>
From: (遠藤　俊裕) &lt;&lt;endo@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 25 Dec 1998 18:31:40 +0900<br>
Subject: [mysql 471] Re: クロス集計の方法<br>

</p>
</div>
<div class="body">
<pre>

遠藤です。

<span class="quote2">&gt;&gt;やっぱり、それ専用のコマンドって無いんですね。</span>
<span class="quote2">&gt;&gt;# なんか、Oracle はあるそうで。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;うっそー、Oracleって私のメシのタネですけれど、DBエンジンではそんなコマンド</span>
<span class="quote1">&gt;知らない。PL/SQLかSQLにそんなのあるってことですか? 教えて教えて教えて教えて</span>

受け売りなんで、私に質問しないでね。^^;

--------- 以下、抜粋。（出典：Nifty FDELPHI）--------

<span class="quote1">&gt;２．いわゆるクロス集計を一発でやることは出来ないでしょうか？</span>

ターゲットＤＢがOracle以外の場合には使えませんが、
Oracle7をお使いであるなら、decode関数を使って可能です。
ただし、列の並びは決め打ちになりますが。

こういう売上テーブルがあったとします。

地区コード    売上金額

         1        1000
         1        2000
         2       15000
         3        3000
         3        5000
         4       30000
(以下続く)

で、これを地区コードが１のもの、２のもの、それ以外で、
集計します。

select 
       sum(decode(地区コード,1,売上金額,0)),
       sum(decode(地区コード,2,売上金額,0)),
       sum(decode(地区コード,1,0,2,0,売上金額))
from 売上テーブル

但しこれの難点は、その他の集計を書く時に、
その他以外の項目を全て列挙して０を戻すように書かなければいけない事です。

月別などのように、完全に区分けが固定化出来るのであれば便利です。

尚、「プログラマのためのＳＱＬ」という本に、クロス集計の作り方が
書いてあります。
もし宜しければ読んでみてください。

もし、この手のものが多いようであれば、ビューにしてしまうのも手ですね。
私はExcelのピボットテーブルに任せるようにしてますが(^^;

</pre>
</div>
<p class="button"><a href="470.html">[前]</a><a href="472.html">[次]</a><a href="../list/401-500.html">[番号順一覧]</a><a href="../thread/401-500.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="470.html">    470 1998-12-25 18:08 [Satoshi Koiwa &lt;koiwa] Re: クロス集計の方法                    </a></span>
<span class="current">-&gt;&nbsp;<a href="471.html">    471 1998-12-25 18:31 ┗[&lt;endo@xxxxxxxxxx&gt;   ]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="475.html">    475 1998-12-26 14:08 　┗[Tamon Nomura &lt;tamon@]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="476.html">    476 1998-12-26 17:35 　　┗[&lt;endo@xxxxxxxxxx&gt;   ]                                   </a></span>
</pre>
</body>
</html>
