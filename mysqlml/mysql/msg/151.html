<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:151</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="150.html">[前]</a><a href="152.html">[次]</a><a href="../list/101-200.html">[番号順一覧]</a><a href="../thread/101-200.html">[スレッド一覧]</a></p>
<p class="id">
mysql:151
</p>
<div class="header">
<p>
From: Kengo Jinno &lt;Kengo Jinno &lt;kengo@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 12 May 1998 16:36:29 +0900<br>
Subject: [mysql 151] MyODBC with MFC4.2<br>

</p>
</div>
<div class="body">
<pre>
はじめまして、神野と申します。

どなたか、MyODBCをMFC(Microsoft Foundation Class Library)から使って
いる方はいらっしゃいませんでしょうか？
VisualC++5.0のMFC4.2から、MyODBC経由でMySQLにアクセスしようとしています。

INSERTは何も考えずに普通にできるのですが、UPDATE DELETEがうまく
いません。実行されているのは、
  UPDATE foo SET bar = ? WHERE CURRENT OF cursor_name
  DELETE FROM foo WHERE CURRENT OF cursor_name
といったSQL文なのですが、SQLGetCusorName()に「NO_NAME」が返されるので
「カーソル名が無効です。」と言われてしまいます。

readmeの
<span class="quote1">&gt; 128   Force use of ODBC manager cursors (experimental)</span>
も試したのですが、この部分を通っていないようで効果ありませんでした。

仕方なく、Primary Keyの列名・型をSQLSpecialColumns()で取得して、
  UPDATE foo SET bar = ? WHERE ID = ?
  DELETE FROM foo WHERE ID = ?
といったSQL文になるように「騙して」処理させています。

もうちょっとうまい方法があれば知りたいです。

ソースがあるんですから、自分でカーソルをインプリメントできるだけの
技術力があれば解決するんですけど(^_^;。

-----------------------------
神野健吾 &lt;kengo@xxxxxxxxxx&gt;


</pre>
</div>
<p class="button"><a href="150.html">[前]</a><a href="152.html">[次]</a><a href="../list/101-200.html">[番号順一覧]</a><a href="../thread/101-200.html">[スレッド一覧]</a></p>


</body></html>