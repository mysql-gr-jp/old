<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:9924</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="9923.html">[前]</a><a href="9925.html">[次]</a><a href="../list/9901-10000.html">[番号順一覧]</a><a href="../thread/9901-10000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:9924
</p>
<div class="header">
<p>
From: Koichi Taniguchi &lt;Koichi Taniguchi &lt;taniguchi@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 29 Jul 2004 11:26:34 +0900<br>
Subject: [mysql 09924] Re: perl による検索処理での日本語取り扱い(Win32,S-JIS)<br>

</p>
</div>
<div class="body">
<pre>
谷口と申します。

On Thu, 29 Jul 2004 10:13:41 +0900
&quot;Mamiya Masataka&quot; &lt;xc8m-mmy@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; perl から DBD-mysql 経由で mySQL に接続、SELECT 文で日本語を使うのですが、</span>
<span class="quote1">&gt; 以下のような状況になります。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt;  $sth = $dbh-&gt;prepare (qq{ </span>
<span class="quote1">&gt;   SELECT Field1 FROM mamiya00 WHERE  Field5 like '%間宮%'</span>
<span class="quote1">&gt;   });</span>
<span class="quote1">&gt; #この SQL 文を実行するとエラー（Internal Server Error）となります。</span>
<span class="quote1">&gt;  $sth = $dbh-&gt;prepare (qq{ </span>
<span class="quote1">&gt;   SELECT Field1 FROM mamiya00 WHERE  Field5 like '%間%'</span>
<span class="quote1">&gt;   });</span>
<span class="quote1">&gt; #この SQL 文ではエラーとならず、間宮を抽出できます。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; %間宮% を jcode.pl で euc に変換して実行すれば、エラーとはなりません。</span>
<span class="quote1">&gt; しかし、データベースの文字コードが Shift-JIS のため、</span>
<span class="quote1">&gt; 合致するデータが無く、抽出できません。</span>

これは、MySQL 云々や、Win32 云々の問題ではないと思います。
そもそも、Shift_JIS で書く場合、Perl の基本的な文で、

print qq{間宮};

と

print qq|間宮|;

の両方を試してみると、上はダメだけど下はイケるはずです。
というのも、Shift_JIS の場合、「宮」の字の下位バイトが、0x7B
(&quot;{&quot;) にあたります。つまり上は、

print qq{間\x8B{};

と等価で、中括弧の対応が合いません。DBI を使われるという事で
あれば、プレースホルダを使われたほうが良いかと思います。


-- 
Koichi Taniguchi &lt;taniguchi@xxxxxxxxxx&gt;


</pre>
</div>
<p class="button"><a href="9923.html">[前]</a><a href="9925.html">[次]</a><a href="../list/9901-10000.html">[番号順一覧]</a><a href="../thread/9901-10000.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="9922.html">   9922 2004-07-29 10:13 [&quot;Mamiya Masataka&quot; &lt;x] perl による検索処理での日本語取り扱い(Win32,S-JIS)</a></span>
<span class="current">-&gt;&nbsp;<a href="9924.html">   9924 2004-07-29 11:26 ┗[Koichi Taniguchi &lt;ta]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9926.html">   9926 2004-07-29 13:44 　┗[&quot;Mamiya Masataka&quot; &lt;x]                                     </a></span>
</pre>
</body>
</html>
