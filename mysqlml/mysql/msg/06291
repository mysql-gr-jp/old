<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6291</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6290">[前]</a><a href="6292">[次]</a><a href="../list/6201-6300">[番号順一覧]</a><a href="../thread/6201-6300">[スレッド一覧]</a></p>
<p class="id">
mysql:6291
</p>
<div class="header">
<p>
From: &quot;Higashi Kanemitsu&quot; &lt;&quot;Higashi Kanemitsu&quot; &lt;kanemitsu@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 27 Sep 2002 11:31:17 +0900<br>
Subject: [mysql 06291] insert 後すぐにそのデータを select    でよびだすと autoincrement    のデータが読めないことがあります。<br>

</p>
</div>
<div class="body">
<pre>
皆様コメントありがとうございます。
（Reply-To解除しました。）
ヒガシです。長文で失礼します。

予約システムを作製しておりまして、ユーザーが予約すると
予約番号が自動生成(autoincrement)で発行されるようにつくったつもりです。
テーブルは
# テーブルの構造 `date_data`
#

CREATE TABLE date_data (
  data_no int(100) NOT NULL auto_increment,
  yoyakubi date NOT NULL default '0000-00-00',
  date date NOT NULL default '0000-00-00',
  time varchar(20) NOT NULL default '',
  name varchar(40) NOT NULL default '',
  age varchar(5) NOT NULL default '',
  sex varchar(5) NOT NULL default '',
  renraku varchar(10) NOT NULL default '',
  tel varchar(20) NOT NULL default '',
  e_mail varchar(40) NOT NULL default '',
  item varchar(20) NOT NULL default '',
  memo varchar(20) NOT NULL default '',
  bikou varchar(100) NOT NULL default '',
  pass varchar(10) NOT NULL default '',
  PRIMARY KEY  (data_no),
  KEY data_no (data_no)
) TYPE=MyISAM;

です。
プログラムは、PHPで書いています。
//データ登録
mysql_query(&quot;insert into
  date_data(
yoyakubi,date,time,name,age,sex,renraku,tel,e_mail,item,memo,bikou,pass)

values('$yoyakubi','$today1','$yoyakutime','$name','$age','$sex','$renraku',
'$tel','$e_mail','$item','$memo','$bikou','$pass')&quot;);

//データ番号　data_noはautoincrement機能を用いて、insert文には入っていませ
ん。

//登録した情報を呼び出す。
$result_touroku=mysql_query(&quot;select * from date_data
   where name = '$name' and date = '$yoyakubi' and time = '$yoyakutime' &quot;);
 while($row_touroku = mysql_fetch_array($result_touroku)){
$yoyaku_no=$row_touroku[&quot;data_no&quot;];
$yoyakubi=$row_touroku[&quot;yoyakubi&quot;];
$date=$row_touroku[&quot;date&quot;];
$yoyakutime=$row_touroku[&quot;time&quot;];
$name=$row_touroku[&quot;name&quot;];
$age=$row_touroku[&quot;age&quot;];
$sex=$row_touroku[&quot;sex&quot;];
$renraku=$row_touroku[&quot;renraku&quot;];
$tel=$row_touroku[&quot;tel&quot;];
$e_mail=$row_touroku[&quot;e_mail&quot;];
$item=$row_touroku[&quot;item&quot;];
$memo=$row_touroku[&quot;memo&quot;];
$bikou=$row_touroku[&quot;bikou&quot;];
$pass=$row_touroku[&quot;pass&quot;];
}

//後はこの呼び出したデータをhtmlで表示しています。
&lt;table border=1 width=80%&gt;
&lt;tr&gt;&lt;td colspan=3 bgcolor=blue align=center&gt;
&lt;font color=white&gt;予約情報　変更後画面 予約番号：&lt;? echo $yoyaku_no; ?&gt; 番
&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;日付
−−−−−
このようにしています。この時に予約番号のみ表示されません。（他のデータは表示
されます。）
データ番号は、後でみるときちんと記入されています。
&lt;last_insert_id() を使ってますよね？&gt;とのコメントをいただきましたが、これと
関連があるのでしょうか。

初歩的な質問で申し訳ありません。

ヒガシ




</pre>
</div>
<p class="button"><a href="6290">[前]</a><a href="6292">[次]</a><a href="../list/6201-6300">[番号順一覧]</a><a href="../thread/6201-6300">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="6290">   6290 2002-09-27 09:10 [&quot;山崎　昌裕&quot; &lt;yamaza] MySQL のインターフェイスを直接 VC++6.0 で使用する方法</a></span>
<span class="current">-&gt;&nbsp;<a href="6291">   6291 2002-09-27 11:31 ┣[&quot;Higashi Kanemitsu&quot; ] insert 後すぐにそのデータを select    でよびだすと autoincrement    のデータが読めないことがあります。</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6292">   6292 2002-09-27 11:58 ┃┣[&quot;kosugi&quot; &lt;kosugi@xxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6294">   6294 2002-09-27 12:54 ┃┃┗[&quot;Higashi Kanemitsu&quot; ]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6295">   6295 2002-09-27 14:09 ┃┃　┗[&quot;Takashi Yamashita&quot; ]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6293">   6293 2002-09-27 12:00 ┃┣[&quot;Takashi Yamashita&quot; ]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6299">   6299 2002-09-27 17:44 ┃┗[Daiju Azuma &lt;daiju_a]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6300">   6300 2002-09-27 21:45 ┃　┗[&lt;kanemitsu@xxxxxxxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6296">   6296 2002-09-27 14:31 ┗[Takeyuki Miyagawa &lt;m]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6297">   6297 2002-09-27 14:48 　┗[&quot;山崎　昌裕&quot; &lt;yamaza]                                     </a></span>
</pre>
</body>
</html>
