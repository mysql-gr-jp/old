<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6301</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6300.html">[前]</a><a href="6302.html">[次]</a><a href="../list/6301-6400.html">[番号順一覧]</a><a href="../thread/6301-6400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:6301
</p>
<div class="header">
<p>
From: Okamoto RYO &lt;Okamoto RYO &lt;ryo@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 27 Sep 2002 23:05:07 +0900<br>
Subject: [mysql 06301] ２バイト文字の境界を考慮したデータ格納の有無<br>

</p>
</div>
<div class="body">
<pre>
おかもとと申します。

mysqld-3.23 を --with-charset=ujis オプション付きでコンパイルして
運用しています。OS は主に FreeBSD 4.3R です。

この時、例えば varchar(255) のカラムに２バイト日本語 EUC 文字（例えば
「あ」など）を１２８個、つまり 256 バイト分インサートすると、最後の
文字は前半１バイト分のみ格納されるようです。結果として、プログラムを
通じて取得したデータの最後の文字は化けておかしくなります。

これまで、mysql 側で、マルチバイト文字が格納バイト数を越えて境界の
文字が分割？される場合はその文字が削除されて（もしくは半角スペースなどで
自動置換されて）登録されていると思い込んでいたのですが、実際には
境界は一切考慮されていないのでしょうか？

みなさまはこの問題をどのように回避されていますでしょうか。

例えば varchar(64) などとした場合、プログラム側で 60 バイト
以下であればエラーを出すなど、常に数バイトほど余裕を持ってチェックを
行う、などの方法しか無いのでしょうか。

LIKE 演算子を用いた SELECT 文などを発行した場合はきちんと
２バイト文字の境界を考慮してくれているのにもかかわらず、
データ格納の際は境界が考慮されていない（ように見える）のが謎です。

どなたか、ご存じの方がいらっしゃいましたら、この辺りの
事情を簡単にでもご教授頂けませんでしょうか。よろしく
お願い致します。

=================================
   @@  Squeeze Lab.  @@
 mail : ryo@xxxxxxxxxx
 web  : <a href="http://www.sqz.jp">http://www.sqz.jp</a>
 written by : Okamoto RYO  :-)
=================================

</pre>
</div>
<p class="button"><a href="6300.html">[前]</a><a href="6302.html">[次]</a><a href="../list/6301-6400.html">[番号順一覧]</a><a href="../thread/6301-6400.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="6301.html">   6301 2002-09-27 23:05 [Okamoto RYO &lt;ryo@xxx] ２バイト文字の境界を考慮したデータ格納の有無</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6302.html">   6302 2002-09-28 00:54 ┣[&lt;moeru@xxxxxxxxxx&gt;  ]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6304.html">   6304 2002-09-28 13:47 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6305.html">   6305 2002-09-29 10:04 　┗[Okamoto RYO &lt;ryo@xxx]                                     </a></span>
</pre>
</body>
</html>
