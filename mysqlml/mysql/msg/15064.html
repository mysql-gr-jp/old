<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15064</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15063.html">[前]</a><a href="15065.html">[次]</a><a href="../list/15001-15100.html">[番号順一覧]</a><a href="../thread/15001-15100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15064
</p>
<div class="header">
<p>
From: とみたまさひろ &lt;とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 13 Nov 2009 07:41:56 +0900<br>
Subject: [mysql 15064] Re: "Commands out of sync"エラー<br>

</p>
</div>
<div class="body">
<pre>とみたです。

On Fri, 13 Nov 2009 01:06:24 +0900
"YAMAKITA, naomichi" &lt;yamakita@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; MySQL 5.1でクライアントライブラリを作成しているのですが、</span>
<span class="quote1">&gt; クエリを発行後、稀に"Commands out of sync; you can't run this  </span>
<span class="quote1">&gt; command now"</span>
<span class="quote1">&gt; というエラーが発生する場合があります。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 何が原因か調べていたところ、</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 1.クエリAを発行：mysql_real_query()</span>
<span class="quote1">&gt; 2.Aの結果セットを取得：mysql_use_result()</span>
<span class="quote1">&gt; 3.Aの結果セットを解放：mysql_free_result()</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 2や3の処理が行われる前にクエリBが発行されたタイミ </span>
<span class="quote1">&gt; ングで発生するようです。</span>
<span class="quote1">&gt; エラーの内容は分かるのですが、どのように対応すれば良いのか</span>
<span class="quote1">&gt; いまいち対策が分かりませんでした。</span>
<span class="quote1">&gt; 2-3の間をロックする、といった手法になるのでしょうか。</span>

mysql_real_query() の後は mysql_store_result() を行うか、
mysql_use_result() &amp; mysql_fetch_row() ですべての行を取り出すまで、他の
クエリを実行することはできません。

何の言語を使用しているのかわかりませんが、ライブラリ側で制御できないと
いうことは、マルチスレッドとかでしょうか。

おっしゃる通りロックするのが一番確実だと思います。ちょっと複雑な処理が
必要になりますが、プリペアドステートメントを使用するのもありかもしれま
せん。

-- 
とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;
日本MySQLユーザ会 <a href="http://www.mysql.gr.jp">http://www.mysql.gr.jp</a>

</pre>
</div>
<p class="button"><a href="15063.html">[前]</a><a href="15065.html">[次]</a><a href="../list/15001-15100.html">[番号順一覧]</a><a href="../thread/15001-15100.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="15063.html">  15063 2009-11-13 01:06 ["YAMAKITA, naomichi"] &amp;quot;Commands out of sync&amp;quot;エラー  </a></span>
<span class="current">-&gt;&nbsp;<a href="15064.html">  15064 2009-11-13 07:41 ┗[とみたまさひろ &lt;tomm]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15065.html">  15065 2009-11-13 16:51 　┗["YAMAKITA, naomichi"]                                     </a></span>
</pre>


</body></html>