<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:4936</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="4935">[前]</a><a href="4937">[次]</a><a href="../list/4901-5000">[番号順一覧]</a><a href="../thread/4901-5000">[スレッド一覧]</a></p>
<p class="id">
mysql:4936
</p>
<div class="header">
<p>
From: (山内　條生) &lt;&lt;yamauchi@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 16 Jan 2002 20:04:48 +0900<br>
Subject: [mysql 04936] Re: delete の繰り返し<br>

</p>
</div>
<div class="body">
<pre>
山内＠ＪＲ四国です。

goudo さん wrote at 2002/01/16 15:35:31:
<span class="quote1">&gt;２．delete、updateは、数件で作業が終わり、最後まで実行しない。</span>
<span class="quote1">&gt;    このときのプログラムは、While文でデータを次々に読み込み</span>
<span class="quote1">&gt;　　deleteしている。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;３．ブラウザ（Explorer）に、作業の結果を書かしているが、やはり</span>
<span class="quote1">&gt;　　数件で終わり、エラーは表示しない。</span>
<span class="quote1">&gt;　　最後まで実行し正常終了しているように見える。</span>

とりあえず、ループの状態はどうなんでしょう？

 $test_num = 0;
 while ($buf=fgets($fp,500)) {
      $buf=substr($buf,0,10);
      $state=mysql_query(&quot;delete from nouki 
                 where 注文番号='$buf'&quot;);
      print(&quot;$test_num , $buf , $state &lt;BR&gt;\n&quot;);
      $test_num++; 
 }

とでもしてみて、while の条件文が成立していて、クエリーが失敗しているのか、
そもそも、while の条件文が失敗しているのか、あたりを切り分けてもらった方
が、分かりやすいのではないかと。

ループは数千件分ちゃんとしているのに、クエリーの失敗であれば、MySQL ネタ
ですが、ループ自体が数十件で終わるのであれば、それは PHP 側の問題ですよね。

先のメールに「最後まで実行している」とありますが、その時の、上記の $test_num 
っていくつになりますか？

それと、開いているファイルの中身って、１０桁ですか？
場合によっては、上の３行目を 
	$buf = rtrim($buf);
なんてしてみるとどうでしょう？fgets は改行まで読み込んでいるので、それをカット
するという手もアリかな、と。
 

−−−−−−−−−−−−−−−−−−−−−−−−−−−−−
　　　ＪＲ　四国旅客鉄道株式会社　工務部電気課　山内　條生
      ＪＲ四国ホームページ　<a href="http://www.jr-shikoku.co.jp/">http://www.jr-shikoku.co.jp/</a>
      ５枚でご入学 学駅入場券 <a href="http://www.yumeshikoku.com/">http://www.yumeshikoku.com/</a>

</pre>
</div>
<p class="button"><a href="4935">[前]</a><a href="4937">[次]</a><a href="../list/4901-5000">[番号順一覧]</a><a href="../thread/4901-5000">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="4878">   4878 2002-01-09 08:50 [Yukihiro KAWADA &lt;kaw] MyODBC conv_ujis                        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4879">   4879 2002-01-09 08:55 ┗[Yukihiro KAWADA &lt;kaw]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4881">   4881 2002-01-09 12:14 　┗[&quot;goudo&quot; &lt;goudo@xxxxx] delete の繰り返し                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4882">   4882 2002-01-09 13:36 　　┗[&quot;f.t&quot; &lt;fujiyama@xxxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4883">   4883 2002-01-09 16:17 　　　┣[&quot;goudo&quot; &lt;goudo@xxxxx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4932">   4932 2002-01-16 13:42 　　　┃┗[&quot;f.t&quot; &lt;fujiyama@xxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4934">   4934 2002-01-16 15:35 　　　┃　┗[&quot;goudo&quot; &lt;goudo@xxxxx]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4935">   4935 2002-01-16 15:48 　　　┃　　┣[&quot;yu-ji.takahashi&quot; &lt;y]                           </a></span>
<span class="current">-&gt;&nbsp;<a href="4936">   4936 2002-01-16 20:04 　　　┃　　┗[&lt;yamauchi@xxxxxxxxxx]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4886">   4886 2002-01-09 17:40 　　　┗[&quot;T.Yamamoto&quot; &lt;yamamo] データ形式について              </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4887">   4887 2002-01-09 19:34 　　　　┣[Daiju Azuma &lt;daiju_a]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4888">   4888 2002-01-09 20:34 　　　　┃┗[&quot;T.Yamamoto&quot; &lt;yamamo]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4889">   4889 2002-01-09 20:47 　　　　┣[&quot;yu-ji.takahashi&quot; &lt;y]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4890">   4890 2002-01-09 22:26 　　　　┗[&lt;donald@xxxxxxxxxx&gt; ]                               </a></span>
</pre>
</body>
</html>
