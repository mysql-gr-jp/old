<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:3271</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="3270.html">[前]</a><a href="3272.html">[次]</a><a href="../list/3201-3300.html">[番号順一覧]</a><a href="../thread/3201-3300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:3271
</p>
<div class="header">
<p>
From: "岩田　雅人" &lt;"岩田　雅人" &lt;iwata@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 16 Feb 2001 09:52:53 +0900<br>
Subject: [mysql 03271] コネクション<br>

</p>
</div>
<div class="body">
<pre>岩田です、初心者ですので宜しくお願い致します！

データベースから読み込んだ値をブラウザで表示しているのですが
プログラムでは…

　：
$dbh = DBI-&gt;connect('DBI:mysql:database1','admin','admin')
       or die "Could'nt connect to database: " . DBI-&gt;errstr;
$sth = $dbh-&gt;prepare('select * from db1')
       or die "Could'nt prepare statement: " . $dbh-&gt;errstr;
$sth-&gt;execute;
$db1_data = $sth-&gt;fetchrow();
$sth-&gt;finish;

if(エラーの場合) {
エラー表示処理関数Error_html()
}
　：
ｈｔｍｌ表示処理
　：
$dbh-&gt;disconnect;

エラー表示処理関数
Error_html {
　：
ｈｔｍｌ表示処理
　：
}

とほとんどのPGはこのような処理をしています。しかし、条件式でhtml表示を分
けて処理する場合、最後にdisconnectせずに処理を終わっています。しかし通っ
てしまい、エラー表示されます。

一応通ってしまうのでこのままでいたのですが、disconnectしていないため
このコネクションのプロセスがいつまでも残ってしまうため、エラーを起こして
しまいます。しかもDBへアクセスする処理をしているプログラムは全てエラー
になってしまいました。エラー症状を発生させることができないためエラー内容
がコネクションのプロセスが原因なのかわかりません。

サーバーをrebootしたところ残っていたコネクションは消えて正常に戻りまし
た。

今は、エラー処理の場合もdisconnectして終了するようにし、コネクションは
残らなくなったのですが。まれにコネクションのプロセスが残ってしまいます。
この先もし、コネクションのプロセスが残って同じよう
なことがあった場合、対処法としてrebootしか方法はないのでしょうか？

サーバーはLinux、使ってるCGI言語はperl 5.005です。


</pre>
</div>
<p class="button"><a href="3270.html">[前]</a><a href="3272.html">[次]</a><a href="../list/3201-3300.html">[番号順一覧]</a><a href="../thread/3201-3300.html">[スレッド一覧]</a></p>


</body></html>