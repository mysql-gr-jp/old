<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13501</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13500.html">[前]</a><a href="13502.html">[次]</a><a href="../list/13501-13600.html">[番号順一覧]</a><a href="../thread/13501-13600.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13501
</p>
<div class="header">
<p>
From: &quot;kondo kondo&quot; &lt;&quot;kondo kondo&quot; &lt;umiushi_00@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 14 Nov 2006 14:05:55 +0000<br>
Subject: [mysql 13501] Re: MYSQL+VB6.0*ADODCについて<br>

</p>
</div>
<div class="body">
<pre>
SELECTの対象になったレコードを削除したいんですよね？
SQLだけでやってみたらどうでしょうか？

DELETE 
FROM　
      A_DB
WHERE　
      PLANT IN (SELECT PLANT FROM A_DB WHERE PLANT = 'A');

こんな感じ？（ひさびさなのでちょっと自信が・・・＾＾；）


<span class="quote1">&gt;From: mew101 &lt;mew101@xxxxxxxxxx&gt;</span>
<span class="quote1">&gt;Reply-To: ml@xxxxxxxxxx</span>
<span class="quote1">&gt;To: ml@xxxxxxxxxx</span>
<span class="quote1">&gt;Subject: <a href="13500.html">[mysql 13500]</a> Re: MYSQL+VB6.0*ADODCについて</span>
<span class="quote1">&gt;Date: Tue, 14 Nov 2006 17:35:36 +0900</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt; &gt; 永坂です。</span>
<span class="quote2">&gt; &gt; 最近触ってないので古いソース引っ張ってきましたが</span>
<span class="quote2">&gt; &gt;     My_Db.ConnectionString = &quot;DRIVER={MySQL ODBC 3.51 Driver};Server=[</span>
サーバIP];PORT=[使用ポート];DATABASE=[データベース];UID=[ユーザ
ID];PASSWORD=[ユーザパスワード];OPTION=3&quot;
<span class="quote2">&gt; &gt;     My_Db.Open</span>
<span class="quote2">&gt; &gt; という形でＤＢ接続しています。</span>
<span class="quote2">&gt; &gt; ODBCドライバ部分はODBCデータソースアドミニストレータなどで確認してくださ</span>
い。
<span class="quote2">&gt; &gt; Openしなくても接続できるんでしょうか？</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;永坂さん　近藤さん</span>
<span class="quote1">&gt;どうもありがとうございます</span>
<span class="quote1">&gt;コントロールパネルで設定したＯＤＢＣを使わず</span>
<span class="quote1">&gt;上記のとおり、やってみたらメッセージが出ませんでした</span>
<span class="quote1">&gt;ありがとうございました</span>
<span class="quote1">&gt;思うにＯＰＥＮしなくともデータを持ってくるようです</span>
<span class="quote1">&gt;しかし</span>
<span class="quote1">&gt;  Adodc1.RecordSource = &quot;SELECT PLANT FROM A_DB WHERE PLANT = 'A'&quot;</span>
<span class="quote1">&gt;  If Adodc1.Recordset.EOF Then</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;この構文ではどうもうまくなく、</span>
<span class="quote1">&gt;ＳＥＬＥＣＴ文に関係なく先頭が削除されてしまうようです</span>
<span class="quote1">&gt;まずはエラーが出なくなったので</span>
<span class="quote1">&gt;ありがとうございました</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote3">&gt; &gt; &gt; 鈴木＠宮城といいます</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; かなり古い技術かもしれませんが</span>
<span class="quote3">&gt; &gt; &gt; VB6.0+ADODC+ODBC接続でのプログラムを作成しています</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; MYSQLのデータベースを１度アクセス２０００でリンク（ＯＤＢＣ接続）させ</span>
<span class="quote3">&gt; &gt; &gt; 　データの更新をします</span>
<span class="quote3">&gt; &gt; &gt; 　（ここでは'A'というデータを削除する）</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; Adodc1.ConnectionString = &quot;Provider=Microsoft.Jet.OLEDB.4.0;Data </span>
Source=&quot;
<span class="quote3">&gt; &gt; &gt; &amp;      App.Path &amp; &quot;\AC2000.mdb;&quot; &amp; &quot;Mode=Share Deny None;Persist </span>
Security
<span class="quote3">&gt; &gt; &gt; Info=False&quot;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; Adodc1.RecordSource = &quot;SELECT PLANT FROM A_DB WHERE PLANT = 'A'&quot;</span>
<span class="quote3">&gt; &gt; &gt; If Adodc1.Recordset.EOF Then</span>
<span class="quote3">&gt; &gt; &gt;        MsgBox (&quot;データが無い&quot;)</span>
<span class="quote3">&gt; &gt; &gt; Else</span>
<span class="quote3">&gt; &gt; &gt;     If Text1.Text &lt;&gt; &quot;&quot; Then</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Recordset.Delete</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Recordset.Update</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Refresh</span>
<span class="quote3">&gt; &gt; &gt;     End If</span>
<span class="quote3">&gt; &gt; &gt; End If</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; これはうまく削除できますが</span>
<span class="quote3">&gt; &gt; &gt; 　アクセス２０００をかまさないでできないかと思い</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; 　Adodc1.ConnectionString = &quot;ODBC_DB&quot;</span>
<span class="quote3">&gt; &gt; &gt;  (MYSQL とＯＤＢＣ接続）</span>
<span class="quote3">&gt; &gt; &gt; 　Adodc1.RecordSource = &quot;SELECT PLANT FROM A_DB WHERE PLANT = 'A'</span>
<span class="quote3">&gt; &gt; &gt; If Adodc1.Recordset.EOF Then</span>
<span class="quote3">&gt; &gt; &gt;        MsgBox (&quot;データが無い&quot;)</span>
<span class="quote3">&gt; &gt; &gt; Else</span>
<span class="quote3">&gt; &gt; &gt;     If Text1.Text &lt;&gt; &quot;&quot; Then</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Recordset.Delete</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Recordset.Update</span>
<span class="quote3">&gt; &gt; &gt;         Adodc1.Refresh</span>
<span class="quote3">&gt; &gt; &gt;     End If</span>
<span class="quote3">&gt; &gt; &gt; End If</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; とすると</span>
<span class="quote3">&gt; &gt; &gt; DELETEのところで</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; 実行時エラー（−２１４７４６７２５９）（８０００４００５）</span>
<span class="quote3">&gt; &gt; &gt; 更新に必要なベーステーブル情報が足りません</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; とでます</span>
<span class="quote3">&gt; &gt; &gt; データは持ってくるようなのですが</span>
<span class="quote3">&gt; &gt; &gt; 更新しようとするとエラーとなります</span>
<span class="quote3">&gt; &gt; &gt; 何が足りないのでしょうか？</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; ADODCを使う理由はDATAGRIDとの連携がいいからなんですが</span>
<span class="quote3">&gt; &gt; &gt; MYSQLには使えないのでしょうか？</span>
<span class="quote3">&gt; &gt; &gt; MYSQLの問題と思い投稿させていただきました</span>
<span class="quote3">&gt; &gt; &gt; よろしくお願いします</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>

_________________________________________________________________
Hotmail に直接アクセス！MSN がさらに使いやすく <a href="http://jp.msn.com/">http://jp.msn.com/</a> 


</pre>
</div>
<p class="button"><a href="13500.html">[前]</a><a href="13502.html">[次]</a><a href="../list/13501-13600.html">[番号順一覧]</a><a href="../thread/13501-13600.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="13485.html">  13485 2006-11-13 18:38 [mew101 &lt;mew101@xxxxx] MYSQL+VB6.0*ADODCについて               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13493.html">  13493 2006-11-14 11:17 ┣[&quot;kondo kondo&quot; &lt;umius]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13494.html">  13494 2006-11-14 11:28 ┗[Hiroshi Nagasaka &lt;h-]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13500.html">  13500 2006-11-14 17:35 　┗[mew101 &lt;mew101@xxxxx]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="13501.html">  13501 2006-11-14 23:05 　　┗[&quot;kondo kondo&quot; &lt;umius]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13502.html">  13502 2006-11-15 10:41 　　　┗[mew101 &lt;mew101@xxxxx]                                 </a></span>
</pre>
</body>
</html>
