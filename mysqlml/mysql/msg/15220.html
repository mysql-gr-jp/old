<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15220</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15219.html">[前]</a><a href="15221.html">[次]</a><a href="../list/15201-15300.html">[番号順一覧]</a><a href="../thread/15201-15300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15220
</p>
<div class="header">
<p>
From: &lt;sydney@xxxxxxxxxx&gt;<br>
Date: Thu, 25 Mar 2010 13:53:58 +1100<br>
Subject: [mysql 15220] Re: レコードの存在チェック<br>

</p>
</div>
<div class="body">
<pre>
坂本と申します。

ご質問の回答は出来ませんが、ロジック的に考えてみました。
id　はプライマリーキーですか？
ユニークなキーな場合、そもそもCOUNTの必要はないと思います。
もし、idがユニークではない場合は、COUNTが正しいかと思います。
私もどちらが正しいとか適正だとかは分かりませんが、データの意味的な
ことで言えば、上記の住み分けになるような気がします。

ポイントはWHEREで利用するカラムがindexテーブル上でどうなっているか
だと思います。

以上です。


----- Original Message ----- 
From: &quot;Hiroshi Hashibata&quot; &lt;hashibata@xxxxxxxxxx&gt;
To: &lt;ml@xxxxxxxxxx&gt;
Sent: Thursday, March 25, 2010 1:05 PM
Subject: <a href="15219.html">[mysql 15219]</a> レコードの存在チェック


<span class="quote1">&gt; 橋端と申します。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; InnoDBのテーブルにレコードが存在するかを</span>
<span class="quote1">&gt; 確認する方法について質問させていただきます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; これまでは</span>
<span class="quote1">&gt; #1</span>
<span class="quote1">&gt; SELECT COUNT(*) FROM tableA WHERE id = xxxx;(xxxxは指定したID）</span>
<span class="quote1">&gt; としてプログラムに返った値に件数があるか0かで判断してきました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; しかし先日の案件で上のコードは</span>
<span class="quote1">&gt; 上位のプログラマによって下記のコードに直されました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; #2</span>
<span class="quote1">&gt; SELECT id FROM tableA WHERE id = xxxx;</span>
<span class="quote1">&gt; 返されたResult[0]のidに値が入っているか空かで判断。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 変更理由を聞いたところ</span>
<span class="quote1">&gt; ・tableAは頻繁に更新されるため#1のクエリーがたくさんプロセステーブルに残っている時がある</span>
<span class="quote1">&gt; ・MySQLはよく分からないが、前のオラクル案件では*はNGだった</span>
<span class="quote1">&gt; ・tableAの更新頻度は変えられないため、苦肉の策</span>
<span class="quote1">&gt; ということでした。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; そこで疑問に思ったのですが2点あります。</span>
<span class="quote1">&gt; (1)#1はWHEREで該当するIDのレコードを選び出し、COUNTでその件数を数えるというクエリですよね。</span>
<span class="quote1">&gt;   *からカラム名に変えることでMySQLの動作はどう変わりますか？</span>
<span class="quote1">&gt; (2)InnoDBは行レベルロックなのでtableAの更新中に#1のレコードが止まるということは</span>
<span class="quote1">&gt;   同じレコードの更新/読み込みが発生しているからでは？だとしたら#2も同じではないか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 既に#2に変更はしたのですが</span>
<span class="quote1">&gt; 自分の疑問を晴らすために</span>
<span class="quote1">&gt; 皆様のお返事をお待ちしています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; </span>


</pre>
</div>
<p class="button"><a href="15219.html">[前]</a><a href="15221.html">[次]</a><a href="../list/15201-15300.html">[番号順一覧]</a><a href="../thread/15201-15300.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15219.html">  15219 2010-03-25 11:05 [Hiroshi Hashibata &lt;h] レコードの存在チェック                  </a></span>
<span class="current">-&gt;&nbsp;<a href="15220.html">  15220 2010-03-25 11:53 ┗[&lt;sydney@xxxxxxxxxx&gt; ]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15221.html">  15221 2010-03-25 12:15 　┗[Hiroshi Hashibata &lt;h]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15222.html">  15222 2010-03-25 12:25 　　┣[Mikiya Okuno &lt;Mikiya]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15223.html">  15223 2010-03-25 12:26 　　┣[Akio Imai &lt;suzuro204] Re: [mysql 15221] Re: レコードの存在チェック</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15224.html">  15224 2010-03-25 13:09 　　┃┣[Mikiya Okuno &lt;Mikiya] Re: レコードの存在チェック      </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15226.html">  15226 2010-03-25 13:20 　　┃┗[宮田 昌紀 &lt;moyata@xx] Re: レコードの存在チェック      </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15227.html">  15227 2010-03-25 14:39 　　┃　┗[Akio Imai &lt;suzuro204] Re: [mysql 15226] Re: レコードの存在チェック</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15228.html">  15228 2010-03-25 17:02 　　┃　　┗[&quot;Tadayuki Abraham HA] MySQLの公共システムへの利用率について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15225.html">  15225 2010-03-25 13:12 　　┗[&quot;EBIHARA, Yuichiro&quot; ]                                   </a></span>
</pre>
</body>
</html>
