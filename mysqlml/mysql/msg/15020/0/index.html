<div>おはようございます。神原です。</div>
<div> </div>
<div>早期の返信ありがとうございます。</div>
<div> </div>
<div>追加の質問に対する回答を下記に記載致します。</div>
<div> </div>
<div>(1)</div>
<div>&gt; ・DROP DATABASE または DELETE をしていますか？<br>&gt; ・「・1万件程度のデータを取り込む」の作業を再度していると<br>&gt;    推測しますが、あってますか？</div>
<div><br>推測していただいたとおり、DELETE後に再度1万件程度のデータを</div>
<div>取り込んでおります。</div>
<div> </div>
<div>（２）<br></div>
<div class="im">&gt; ・my.iniに「max_allowed_packet=128M 」と追記<br>&gt;  ↓   ★<br>&gt; ・10万件のデータで動作確認(先述のレスポンス問題が発生)<br>&gt;</div>
<div>&gt; この部分でも同様に「データの削除」「再取込」作業の有無</div>
<div> </div>
<div>my.iniに追記後、MySQLを再起動して、「データの削除」「再取込」を</div>
<div>行いました。</div>
<div> </div>
<div>（３）mysqldump で作成したファイルの中身の INSERT 文</div>
<div> </div>
<div>&gt;INSERT INTO xxx VALUES (xxx, xxx, ....),(xxx, xxx, ....),(xxx, xxx, ....)...</div>
<div>のように並んでおります。</div>
<div> </div>
<div>（４）テーブルのストレージエンジンは何ですか？</div>
<div> </div>
<div>InnoDBを使用しております。</div>
<div> </div>
<div>（５）現在(再インストール後)の my.ini の内容は、</div>
<div>        skip-character-set-client-handshake</div>
<div>        max_allowed_packet=128M<br>     が記述されたものですか？<br>     (アンインストール時に削除されずに残っている可能性)<br>     ついでにその my.ini のある場所（windows または windows/system32 でしょうか)</div>
<div> </div>
<div>アンインストール後にMySQLのフォルダは削除しましたので、</div>
<div>
<div>&gt;        skip-character-set-client-handshake</div>
<div>&gt;        max_allowed_packet=128M</div>
<div>は記述されておりません。</div>
<div> </div>
<div>my.iniのある場所はC:\Program Files\MySQL\MySQL Server 5.0にあります。</div>
<div> </div>
<div>ご指摘の通り、私自身DBの知識が皆無で必要な情報が何かが全然分からない</div>
<div>ですので、やり取りの中で必要な情報を教えていただけると助かります。</div>
<div> </div>
<div>&gt;＃すごく無根拠に書いてしまうと、インポートの失敗時に何か爆弾を踏んだん<br>&gt;＃じゃないかなーという予感がしています。</div>
<div> </div>
<div>とはどういうことなのでしょうか？</div>
<div> </div></div>
<div> </div>
<div class="gmail_quote">2009年9月8日2:10 SAKAI Kei <span dir="ltr">&lt;<a href="mailto:sak2@artry.co.jp">sak2@artry.co.jp</a>&gt;</span>:<br>
<blockquote class="gmail_quote" style="PADDING-LEFT: 1ex; MARGIN: 0px 0px 0px 0.8ex; BORDER-LEFT: #ccc 1px solid">坂井です<br><br> 神原さん、早速の追加情報ありがとうございます。<br><br> あといくつか追加で教えていただきたいのですが<br><br>（１）<br>
<div class="im">&gt; ・文字化けが発生<br>&gt;  ↓<br>&gt; ・my.iniに「skip-character-set-client-handshake」を追記<br>&gt;  ↓   ★<br>&gt; ・1万件程度のデータで動作確認(さすがにレスポンスも問題はありませんでした)<br>&gt;  ↓<br><br></div> ★のところで、<br> ・DROP DATABASE または DELETE をしていますか？<br>
 ・「・1万件程度のデータを取り込む」の作業を再度していると<br>     推測しますが、あってますか？<br><br>（２）<br>
<div class="im">&gt; ・my.iniに「max_allowed_packet=128M 」と追記<br>&gt;  ↓   ★<br>&gt; ・10万件のデータで動作確認(先述のレスポンス問題が発生)<br>&gt;  ↓<br><br></div> この部分でも同様に「データの削除」「再取込」作業の有無<br><br><br>（３）mysqldump で作成したファイルの中身の INSERT 文は<br>   INSERT INTO xxx VALUES (xxx, xxx, ....);<br>
   INSERT INTO xxx VALUES (xxx, xxx, ....);<br>   INSERT INTO xxx VALUES (xxx, xxx, ....);<br>     :<br>   のように並んでいるものか、あるいは<br>   INSERT INTO xxx VALUES (xxx, xxx, ....),(xxx, xxx, ....),(xxx, xxx, ....)...<br>   のように並んでいるか。<br>
<br>（４）テーブルのストレージエンジンは何ですか？<br><br><br>（５）現在(再インストール後)の my.ini の内容は、<br>
<div class="im">        skip-character-set-client-handshake<br></div>        max_allowed_packet=128M<br>     が記述されたものですか？<br>     (アンインストール時に削除されずに残っている可能性)<br>     ついでにその my.ini のある場所（windows または windows/system32 でしょうか)<br>
<br>&gt; 先ほどは詳細を記載できておらず、すみませんでした。<br><br> いえいえ。おそらくどんな情報が必要かが判断つきかねたのだと思います。<br> まずはMLでお尋ねいただいた上で、やりとりの中で今回のように情報教え<br> ていただければ大丈夫ですよ(^^)<br><br><br>＃すごく無根拠に書いてしまうと、インポートの失敗時に何か爆弾を踏んだん<br>＃じゃないかなーという予感がしています。<br><br><br>
Thank you<br>On Mon, 7 Sep 2009 23:18:08 +0900<br>
<div>
<div></div>
<div class="h5">Yusuke Kambara &lt;<a href="mailto:forecastresearchclub@gmail.com">forecastresearchclub@gmail.com</a>&gt; wrote:<br>&gt; ご回答ありがとうございます。<br>&gt;<br>&gt; EXPLAINの結果、テーブル定義は現在手元に導入端末がないため即答はできないのですが、<br>&gt; 行った作業内容を下記に記載します。<br>
&gt;<br>&gt; ※下記の作業で使用するデータはすべてmysqldumpで作成したものを取り込んでおります。<br>&gt;<br>&gt; ・complete でインストール<br>&gt;  ↓<br>&gt; ・1万件程度のデータを取り込む<br>&gt;  ↓<br>&gt; ・文字化けが発生<br>&gt;  ↓<br>&gt; ・my.iniに「skip-character-set-client-handshake」を追記<br>
&gt;  ↓<br>&gt; ・1万件程度のデータで動作確認(さすがにレスポンスも問題はありませんでした)<br>&gt;  ↓<br>&gt; ・10万件のデータを取り込む<br>&gt;  ↓<br>&gt; ・「Got a packet bigger than ‘max_allowed_packet’ bytes」のエラーが発生<br>&gt;  ↓<br>&gt; ・my.iniに「max_allowed_packet=128M 」と追記<br>
&gt;  ↓<br>&gt; ・10万件のデータで動作確認(先述のレスポンス問題が発生)<br>&gt;  ↓<br>&gt; ・mysqlのアンインストール<br>&gt;  ↓<br>&gt; ・mysqlの再インストール(typical)<br>&gt;  ↓<br>&gt; ・10万件のデータを取り込む(「Got a packet bigger than ‘max_allowed_packet’<br>&gt; bytes」は発生しませんでした)<br>
&gt;  ↓<br>&gt; ・10万件のデータで動作確認(レスポンス問題が改善)<br>&gt;<br>&gt; 行った作業は以上となります。<br>&gt;<br>&gt; 再インストール後は最大利用バイト数のエラー、文字化けが発生しなかったため、my.iniは変更しておりません。<br>&gt;<br>&gt; 先ほどは詳細を記載できておらず、すみませんでした。<br>&gt;<br>&gt;<br>&gt;<br>&gt; 2009年9月7日22:13 SAKAI Kei &lt;<a href="mailto:sak2@artry.co.jp">sak2@artry.co.jp</a>&gt;:<br>
&gt;<br>&gt; &gt; 坂井です<br>&gt; &gt;<br>&gt; &gt;  神原さんこんにちは。<br>&gt; &gt;  もうちょっと情報が欲しいところですね。<br>&gt; &gt;<br>&gt; &gt; ・complete でインストールした 5.0.45 で遅かった<br>&gt; &gt;    ↓<br>&gt; &gt; ・（何かをした－たとえばデータのダンプ）<br>&gt; &gt;    ↓<br>
&gt; &gt; ・（何かをした－たとえばMySQLのアンインストール）<br>&gt; &gt;    ↓<br>&gt; &gt; ・typical で5.0.45を再インストールした<br>&gt; &gt;    ↓<br>&gt; &gt; ・（何かをした－たとえばmy.iniの記述等設定変更）<br>&gt; &gt;    ↓<br>&gt; &gt; ・（何かをした－たとえばダンプデータのインポート）<br>&gt; &gt;<br>
&gt; &gt;  くらいのステップがあるのでは？と推察します。<br>&gt; &gt;<br>&gt; &gt;  ちなみに 「超極めるMySQL」という本を書いた頃なので 5.0.22時点<br>&gt; &gt;  の情報ですが、typical では complete に比べて以下のディレクトリ<br>&gt; &gt;  下のファイルがコピーされません。<br>&gt; &gt;    excamples\<br>&gt; &gt;    include\<br>
&gt; &gt;    lib\<br>&gt; &gt;    scripts\<br>&gt; &gt;    sql-bench\<br>&gt; &gt;  （どれも実行速度に影響を与えるものとは思えないので、上記フロー<br>&gt; &gt;    での「何かをした」の部分次第の効果と思いますが）<br>&gt; &gt;<br>&gt; &gt; Thank you<br>&gt; &gt;  On Mon, 7 Sep 2009 19:27:28 +0900<br>
&gt; &gt; Yusuke Kambara &lt;<a href="mailto:forecastresearchclub@gmail.com">forecastresearchclub@gmail.com</a>&gt; wrote:<br>&gt; &gt; &gt; こんばんは。神原と申します。<br>&gt; &gt; &gt;<br>&gt; &gt; &gt; レスポンスが改善した理由について教えていただきたく思い投稿致しました。<br>
&gt; &gt; &gt;<br>&gt; &gt; &gt; MySQL5.0.45を使用したシステムで検索を行った際に10万件のデータから500件程度を抽出する検索で<br>&gt; &gt; &gt; 4分程度の時間がかかっていました。<br>&gt; &gt; &gt;<br>&gt; &gt; &gt; あまりにレスポンスが悪いので再インストールしてみようとして、たまたまsetup typeをcompleteから<br>&gt; &gt; &gt; typicalにしてインストールしたのですが、4分かかっていた検索が4秒程度になりました。<br>
&gt; &gt; &gt;<br>&gt; &gt; &gt; 問題自体は解決したので良かったのですが、原因が知りたいのです。<br>&gt; &gt; &gt;<br>&gt; &gt; &gt; とても曖昧な質問になってしまい、申し訳ございませんが宜しくお願い致します。<br>&gt; &gt;<br>&gt; &gt;<br>&gt; &gt;<br>&gt; &gt;<br><br><br><br></div></div></blockquote>
</div><br>
