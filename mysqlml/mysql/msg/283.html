<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:283</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="282.html">[前]</a><a href="284.html">[次]</a><a href="../list/201-300.html">[番号順一覧]</a><a href="../thread/201-300.html">[スレッド一覧]</a></p>
<p class="id">
mysql:283
</p>
<div class="header">
<p>
From: Shogo Hamamoto &lt;Shogo Hamamoto &lt;KHC01210@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 19 Oct 1998 00:22:18 +0900<br>
Subject: [mysql 283] Re:SQL<br>

</p>
</div>
<div class="body">
<pre>

tommy@xxxxxxxxxx wrote:

<span class="quote1">&gt; Date: Sun, 18 Oct 1998 05:21:52 +0900</span>
<span class="quote1">&gt; From: 民斗 &lt;tommy@xxxxxxxxxx&gt;</span>
<span class="quote1">&gt; Reply-To: mysql@xxxxxxxxxx</span>
<span class="quote1">&gt; Errors-To: mysql-return-280-KHC01210=nifty.ne.jp@xxxxxxxxxx</span>
<span class="quote1">&gt; To: mysql@xxxxxxxxxx</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; MySQL を使った日本語文書検索システムを作ってみました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; が、会社の業務で作ったので、残念ながら公開できません…(^^;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; あらかじめ、chasen で文書を単語毎に区切り、名詞だけを抜き出して、</span>
<span class="quote1">&gt; MySQL で作ったキーワードテーブルに登録しておき、そのテーブルを検索する</span>

<span class="quote1">&gt; という方式です。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; まだサンプルデータの数が少ないですが、期待通り(期待以上かも)の速度で</span>
<span class="quote1">&gt; 動いてくれてます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; で、一つ質問があります。MySQL というか SQL についての質問なんですが</span>
…。
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 次のようなテーブル(T)に、文書番号(id)とキーワード(str)を登録してあると</span>

<span class="quote1">&gt; します。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;         create table T (id int not null, str char(32) not null);</span>
<span class="quote1">&gt;         # index は省略</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 1) &quot;hoge&quot; というキーワードと &quot;fuga&quot; というキーワードの両方を含む文書を</span>

<span class="quote1">&gt;   検索する時は、次のようにできます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;         select a.id from T as a left join T as b using (id)</span>
<span class="quote1">&gt;         where a.str=&quot;hoge&quot; and b.str=&quot;fuga&quot;;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 2) &quot;hoge&quot; または &quot;fuga&quot; を含むという場合は、次でできます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;         select id from T where str=&quot;hoge&quot; or str=&quot;fuga&quot;;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ここまではいいんですが、もっと複雑な条件の時にどうすればいいのか</span>
<span class="quote1">&gt; わかりません。例えば、</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;         「&quot;hoge&quot; または &quot;fuga&quot; を含み、かつ &quot;herohero&quot; も含む」</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; とか…。しかもそれをプログラムから自動的に生成したいのです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; どうも、1) と 2) の文法が違いすぎて、SQL では１行で書くのは無理のよう</span>
な
<span class="quote1">&gt; 気がしてるのですが…。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; なんかうまい方法があるでしょうか？</span>
<span class="quote1">&gt; --</span>
<span class="quote1">&gt; 民斗 &lt;tommy@xxxxxxxxxx&gt;</span>

  2)の構文の方がはるかに効率が良いのですが、プログラム的には
UNIONを使って、検索結果のテーブルを結合する方法が、1)の構文に
近い形で記述できると思います。
 UNIONは、複数のテーブルを(論理的に)結合する命令です。
ちなみに、MySQLのcrash-me(takeshiさんありがとう！)を見ると、MySQL
ではサポートされていない機能でした。(残念)

 参考までに、UNIONは、
 AというテーブルとBというテーブル(テーブルはasで作った仮想テーブル
でも良い)を結合する場合、
table A UNION table B
と記述できます。AとBのテーブルの形式(フィールドの数等)は必ずしも一致して

いなくても構いません。

(すみません。Netscapeの設定がうまくいってないのでおかしな表示になってい
る
かもしれません)


</pre>
</div>
<p class="button"><a href="282.html">[前]</a><a href="284.html">[次]</a><a href="../list/201-300.html">[番号順一覧]</a><a href="../thread/201-300.html">[スレッド一覧]</a></p>
</body>
</html>
