<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13055</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13054">[前]</a><a href="13056">[次]</a><a href="../list/13001-13100">[番号順一覧]</a><a href="../thread/13001-13100">[スレッド一覧]</a></p>
<p class="id">
mysql:13055
</p>
<div class="header">
<p>
From: 関　俊夫 &lt;関　俊夫 &lt;to-seki@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 16 May 1938 13:05:31 +0900<br>
Subject: [mysql 13055] 同一テーブルから階層別に分けるＳＱＬ文をつくりたい<br>

</p>
</div>
<div class="body">
<pre>
はじめての投稿です。
ＳＱＬ文が作れなく困っています。よろしくお願いします。
会社の組織階層を格納するテーブルがあります。
テーブル構造は
+------------------------------+
<span class="quote1">| sections                     |</span>
+------------------------------+
<span class="quote1">| id               int     (8) |</span>
<span class="quote1">| name             varchar (50)|</span>
<span class="quote1">| upper_section_id int     (8) |</span>
+------------------------------+
そのデータは
+----------------------------------+
<span class="quote1">| id |   name   | upper_section_id |</span>
+----------------------------------+
<span class="quote1">| 1  | 本社     |     0            |</span>
<span class="quote1">| 2  | Ａ事業部 |     1            |</span>
<span class="quote1">| 3  | 東京支店 |     2            |</span>
<span class="quote1">| 4  |  営業部  |     3            |</span>
<span class="quote1">| 5  | Ｂ事業部 |     1            |</span>
<span class="quote1">| 6  | 大阪支店 |     5            |</span>
+----------------------------------+
希望する結果
+---------------------------------------+
<span class="quote1">| t1.name | t2.name | t3.name | t4.name |</span>
+---------------------------------------+
<span class="quote1">|本社     |         |         |         |</span>
<span class="quote1">|本社     |Ａ事業部 |         |         |</span>
<span class="quote1">|本社     |Ａ事業部 |東京支店 |         |</span>
<span class="quote1">|本社     |Ａ事業部 |東京支店 |営業部   |</span>
<span class="quote1">|本社     |Ｂ事業部 |         |         |</span>
<span class="quote1">|本社     |Ｂ事業部 |大阪支店 |         |</span>
+---------------------------------------+
私がためしたＳＱＬ文は
SELECT t1.name, t2.name, t3.name, t4.name
FROM `sections` AS t1
INNER JOIN `sections` AS t2 ON t2.upper_section_id = t1.id
INNER JOIN `sections` AS t3 ON t3.upper_section_id = t2.id
INNER JOIN `sections` AS t4 ON t4.upper_section_id = t3.id
ORDER BY t1.name, t2.name, t3.name, t4.name
私がためした結果
+---------------------------------------+
<span class="quote1">| t1.name | t2.name | t3.name | t4.name |</span>
+---------------------------------------+
<span class="quote1">|本社     |Ａ事業部 |東京支店 |営業部   |</span>
+---------------------------------------+ 
以上のように４つの階層関係が出来ているデータのみが表示してします。

------------------------
関　俊夫
<a href="http://www.dancers-online.com/">http://www.dancers-online.com/</a>


</pre>
</div>
<p class="button"><a href="13054">[前]</a><a href="13056">[次]</a><a href="../list/13001-13100">[番号順一覧]</a><a href="../thread/13001-13100">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="12277">  12277 2005-10-25 09:10 [&quot;fujita&quot; &lt;t-fujita@x] MySQL5.0でシンボリックが有効にならない  </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12278">  12278 2005-10-26 08:14 ┣[Tetsuro IKEDA &lt;tetsu]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12279">  12279 2005-10-26 09:49 ┃┗[&quot;fujita&quot; &lt;t-fujita@x]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12280">  12280 2005-10-26 09:57 ┃　┗[Tetsuro IKEDA &lt;tetsu]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="12281">  12281 2005-10-26 10:30 ┃　　┗[&quot;fujita&quot; &lt;t-fujita@x]                                 </a></span>
<span class="current">-&gt;&nbsp;<a href="13055">  13055 1938-05-16 13:05 ┗[関　俊夫 &lt;to-seki@xx] 同一テーブルから階層別に分けるＳＱＬ文をつくりたい</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13057">  13057 2006-06-03 21:06 　┣[&quot;F.Y&quot; &lt;fumi_sby@xxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13059">  13059 2006-06-04 06:36 　┃┗[関　俊夫 &lt;to-seki@xx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13060">  13060 2006-06-04 08:15 　┃　┗[関　俊夫 &lt;to-seki@xx]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13061">  13061 2006-06-04 10:30 　┃　　┗[関　俊夫 &lt;to-seki@xx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13058">  13058 2006-06-04 06:31 　┣[関　俊夫 &lt;to-seki@xx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13180">  13180 2006-07-23 03:25 　┗[demanotto &lt;demanotto]                                     </a></span>
</pre>
</body>
</html>
