<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:12761</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="12760">[前]</a><a href="12762">[次]</a><a href="../list/12701-12800">[番号順一覧]</a><a href="../thread/12701-12800">[スレッド一覧]</a></p>
<p class="id">
mysql:12761
</p>
<div class="header">
<p>
From: baya &lt;baya &lt;bayapbayap@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 16 Feb 2006 01:39:23 +0900<br>
Subject: [mysql 12761] Re: MySQL のバックアップ・復元について<br>

</p>
</div>
<div class="body">
<pre>
大林です。

松信さん、回答ありがとうございます。

<span class="quote1">&gt; mysqldumpによってオンラインバックアップを行なう場合、</span>
<span class="quote1">&gt; 以下のどちらかの方法を使うと良いと思います。</span>

早速、ご教授頂いたコマンドを試してみました。
--lock-all-tables というオプションではエラーとなりましたので
恐らく同じと思われる --lock-tables のオプションを使用した所

%mysqldump -u*** -p*** --all-databases --lock-tables --flush-logs &gt; ***.sql

バイナリログは以前と同じく複数作成されておりました。

試しに、２．の方法にても試してみましたが、同様にバイナリログは
複数作成されるようです。

もう少し色々と試してみたいと思いますが、MySQLのバージョン等で
動作が変化する事はありえるのでしょうか・・？


&lt;Yoshinori.Matsunobu@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; 大林さん</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 松信です。</span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt; &gt;% mysqldump ---all-databases --flush-logs &gt; ***.sql</span>
<span class="quote2">&gt; &gt;を行い、フルバックアップとバイナリログにて、</span>
<span class="quote2">&gt; &gt;データの復元を行う形かと思います。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; mysqldumpによってオンラインバックアップを行なう場合、</span>
<span class="quote1">&gt; 以下のどちらかの方法を使うと良いと思います。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; １．MyISAMなどの非InnoDBテーブルに対して途中で更新が入る可能性がある場合</span>
<span class="quote1">&gt; バックアップデータの一貫性を保つために、バックアップの間中共有ロックをかける必要があります。</span>
<span class="quote1">&gt; 以下のように実行します。</span>
<span class="quote1">&gt; % mysqldump ---all-databases  --lock-all-tables --flush-logs &gt; ***.sql</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ２．権限テーブルを除くすべてのテーブルがInnoDBの場合</span>
<span class="quote1">&gt; この場合、「バックアップの開始時にほんの一瞬だけ共有ロックをかければ、</span>
<span class="quote1">&gt; バックアップデータの一貫性が保たれる」というバックアップ方法があります。以下のように実行します。</span>
<span class="quote1">&gt; % mysqldump ---all-databases  --master-data=2 --single-transaction --flush-logs &gt; ***.sql</span>
<span class="quote1">&gt; １との違いは、バックアップの最中に更新を行なうことができるということです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; １，２のどちらの場合でも、データベースの数に関わらず、</span>
<span class="quote1">&gt; バイナリログは1個しか作成されませんので試してみてください。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; --master-data=2とか、--single-transactionとかいったパラメータの意味は、</span>
<span class="quote1">&gt; 英語版のマニュアルに書いてあるので、こっちを見てみてください。</span>
<span class="quote1">&gt; <a href="http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html">http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html</a></span>
<span class="quote1">&gt; もう1年以上前に出たパラメータなのですが、日本語版にはまだ反映されてない…。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>


***************************
[Awakiti]　大林
E-Mail:bayapbayap@xxxxxxxxxx

</pre>
</div>
<p class="button"><a href="12760">[前]</a><a href="12762">[次]</a><a href="../list/12701-12800">[番号順一覧]</a><a href="../thread/12701-12800">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="12752">  12752 2006-02-14 21:22 [&quot;Matsunobu, Yoshinor] Re: MySQL のバックアップ・復元について  </a></span>
<span class="current">-&gt;&nbsp;<a href="12761">  12761 2006-02-16 01:39 ┗[baya &lt;bayapbayap@xxx]                                       </a></span>
</pre>
</body>
</html>
