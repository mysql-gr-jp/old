<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6834</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6833">[前]</a><a href="6835">[次]</a><a href="../list/6801-6900">[番号順一覧]</a><a href="../thread/6801-6900">[スレッド一覧]</a></p>
<p class="id">
mysql:6834
</p>
<div class="header">
<p>
From: &quot;K-A&quot; &lt;&quot;K-A&quot; &lt;k-anzai@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 10 Jan 2003 12:59:20 +0900<br>
Subject: [mysql 06834] Re: MySQL での SQL    文について<br>

</p>
</div>
<div class="body">
<pre>
お世話になっております、安齋です。

大変申し訳ないのですが、
上手く行ったと喜んだのも束の間、
もう少し複雑なSQLの方はエラーが返って来てしまいました。

少し頭を整理して、「Date」に「”」を付けたり
Format関数のフィールド名にテーブル名を付けたり
と少し変えてみたのですが、エラーでした。

下記がSQL文です。
-------------------------------------------
SELECT tbLesson_Access_D.Intime,
tbLesson_Access_D.Outtime,
tbUser.UID,
tbUser.UserID,
tbUser.Name,
tbLesson.LID,
tbLesson.LName,
tbCourse.CID,
tbCourse.CName,
DateDiff(&quot;s&quot;,tbLesson_Access_D.Intime,tbLesson_Access_D.Outtime) AS
TotalSec,
Format(tbLesson_Access_D.Intime,&quot;yyyymmdd&quot;) AS &quot;Date&quot;,
tbLesson_Access_D.SchoolID,tbSchool.Name AS SName

FROM (tbCourse INNER JOIN (tbLesson INNER JOIN
 (tbUser INNER JOIN tbLesson_Access_D ON tbUser.UID =
 tbLesson_Access_D.UserID) ON tbLesson.LID = tbLesson_Access_D.LessonID)
 ON tbCourse.CID = tbLesson_Access_D.CourseID)
 INNER JOIN tbSchool ON tblLesson_Access_D.SchoolID = tbSchool.ID;

-------------------------------------------

それで返ってきたエラーです。

-------------------------------------------
ERROR 1064: You have an error in your SQL syntax.  Check the manual that
corresp
onds to your MySQL server version for the right syntax to use near
'(&quot;s&quot;,tbLesso
n_Access_D.Intime,tbLesson_Access_D.Outtime) AS Tot

-------------------------------------------

TotalSecと言うのは、IntimeとOuttimeを使って
入室していた時間（秒）を取っているんですが
その辺がエラーの原因だと思うのですが。

書き方がおかしかったり、
別のやり方で入室していた時間を取る方法など
知っている方などいらっしゃいましたら、なんでも結構ですので
ご教授ください。お願いします。


株式会社ビーアーティスト
安齋勝恵


</pre>
</div>
<p class="button"><a href="6833">[前]</a><a href="6835">[次]</a><a href="../list/6801-6900">[番号順一覧]</a><a href="../thread/6801-6900">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="6834">   6834 2003-01-10 12:59 [&quot;K-A&quot; &lt;k-anzai@xxxxx] Re: MySQL での SQL    文について        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6835">   6835 2003-01-10 13:27 ┗[UNO Shintaro &lt;uno@xx]                                       </a></span>
</pre>
</body>
</html>
