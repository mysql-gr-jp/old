<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:710</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="709.html">[前]</a><a href="711.html">[次]</a><a href="../list/701-800.html">[番号順一覧]</a><a href="../thread/701-800.html">[スレッド一覧]</a></p>
<p class="id">
mysql:710
</p>
<div class="header">
<p>
From: Shogo Hamamoto &lt;Shogo Hamamoto &lt;KHC01210@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 19 Feb 1999 19:37:47 +0900<br>
Subject: [mysql 00710] Re: 登録時のチェック<br>

</p>
</div>
<div class="body">
<pre>
民斗 wrote:

<span class="quote1">&gt; 民斗です。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; MySQL を使ってて、登録時の項目の厳密なチェックがあったらいいのに…</span>
<span class="quote1">&gt; と思うことがあります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 1) 数値項目に数字以外の文字を含む文字列を登録してしまった場合</span>
<span class="quote1">&gt;    文字列の先頭の数字部分の数値（文字列が数字以外で始まっている場合は0）が</span>
<span class="quote1">&gt;    登録される。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 2) 項目の長さ以上の文字列を登録してしまった場合</span>
<span class="quote1">&gt;    余計な部分が黙って切り捨てられる。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; どちらの場合も、アプリケーションで事前にチェックすることで防ぐことは</span>
<span class="quote1">&gt; できますが、面倒です。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 上記のような場合は素直にエラーになってくれた方が嬉しいことがあります。</span>
<span class="quote1">&gt; 特に 2) の場合、エラーにならないから成功したと思ってたのに、検索すると</span>
<span class="quote1">&gt; 引っ掛からないということが起こり得ますし…。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; みなさんはどうしてます？ また、他の RDB ではどうなんでしょう…？</span>

 MySQLのマニュアルでは、INSERT構文の節で、
・NOT NULL 定義去れた項目へのNULLの挿入
・数値項目の範囲を超える値のセット
・数値項目への10.34 aのような値のセット
・CHAR、VARCHAR、TEXT、又はBLOB項目への最大長を超える文字列の挿入
・日付又は時刻項目への項目属性に反した挿入
を警告レベルでは引っかけているようです。C APIのmysql_info()関数
でチェックできるらしいのですが、民斗さんの言うように、事前にチェック
したり、素直にエラーにすることはできないようですね。
 警告レベルのエラーの振舞いを変更できる命令があればいいですね。
警告レベルのエラーの時に、
・強制的に変更してでも登録するか
・登録する場合、変更前のデータと変更後のデータをログに出すかどうか
とでもできれば良いのではないしょうか。

とりあえず、現状では、
１.多くのデータを一辺にロードするような時
 ディスクに余裕があれば、同じ構成のチェック用のワーク
テーブルを用意して、そちらで試してからmysql_info()関数の結果を
見る。
2.プログラムで１件１件書くような場合
 その度にmysql_info()関数でチェックする

というようなところでしょうか。


</pre>
</div>
<p class="button"><a href="709.html">[前]</a><a href="711.html">[次]</a><a href="../list/701-800.html">[番号順一覧]</a><a href="../thread/701-800.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="703.html">    703 1999-02-19 01:34 [民斗 &lt;tommy@xxxxxxxx] 登録時のチェック                        </a></span>
<span class="current">-&gt;&nbsp;<a href="710.html">    710 1999-02-19 19:37 ┗[Shogo Hamamoto &lt;KHC0]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="716.html">    716 1999-02-21 05:31 　┗[民斗 &lt;tommy@xxxxxxxx]                                     </a></span>
</pre>
</body>
</html>
