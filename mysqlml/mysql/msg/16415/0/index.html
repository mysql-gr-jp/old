<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head><meta content="text/html;charset=ISO-2022-JP" http-equiv="Content-Type"></head><body ><div style='font-size:10pt;'><table cellpadding="0" cellspacing="0" border="0" style="min-width: 100%; color: rgb(0, 0, 0); font-family: Lato; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><tbody><tr><td style="font-family: Lato; font-size: 14px;"><div style="font-size: 10pt;"><div>＜メール送信に失敗していたので再送しています、複数届いた方おられましたらすみません＞</div><div><br></div><div>明智さん<br></div><div><br></div><div>波多野と申します。<br></div><div><br></div><div>ユーザー変数評価順の面白い挙動を見つけましたのでご参考にして頂けると幸いです。<br></div><div><br></div><div>SELECT @a:=0; SELECT @a FROM (SELECT 1) t WHERE @a:=1 AND @a = 1;<span>&nbsp;</span><br></div><div>と<br></div><div>SELECT @a:=1; SELECT @a FROM (SELECT 1) t WHERE @a:=1 AND @a = 1;<br></div><div><br></div><div>上の方は２つめの SELECT は Empty でしたが、<br></div><div>下の方は２つめの SELECT は 1 でした<br></div><div>一つ目のクエリでの代入で、２つ目のクエリの WHERE が True になるかどうか影響を受けました<br></div><div><br></div><div>それではということで WHERE での代入を 0 にすると、先行する SELECT @a:=1 はあっても<br></div><div>True にならなくなりました<br></div><div><br></div><div>SELECT @a:=1; SELECT @a FROM (SELECT 1) t WHERE @a:=0 AND @a = 1;<br></div><div><br></div><div>さらに WHERE での代入を @a:=2 にしてみますと<br></div><div><br></div><div>mysql&gt; SELECT @a:=1; SELECT @a FROM (SELECT 1) t WHERE @a:=2 AND @a = 1;<span>&nbsp;</span><br></div><div>+-------+<br></div><div>| @a:=1 |<br></div><div>+-------+<br></div><div>|&nbsp;&nbsp;&nbsp;&nbsp; 1 |<br></div><div>+-------+<br></div><div>1 row in set (0.00 sec)<br></div><div><br></div><div>+------+<br></div><div>| @a&nbsp;&nbsp; |<br></div><div>+------+<br></div><div>|&nbsp;&nbsp;&nbsp; 1 |<br></div><div>+------+<br></div><div>1 row in set (0.00 sec)<br></div><div><br></div><div>成立するようになります。（@a:=2 関係ないのなら何故 := 0 で挙動が変わったのかw）<br></div><div>このようなクエリを現実で書くことはないと思われますが、直観では結果を事前に予測することは難しかったです。<br></div><div><br></div><div>今手元で使ってみたバージョンはこちらでした<br></div><div><br></div><div>mysql&nbsp; Ver 14.14 Distrib 5.6.25, for Linux (x86_64)<br></div></div></td></tr></tbody></table><div><br></div></div></body></html>
