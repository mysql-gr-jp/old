<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13682</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13681.html">[前]</a><a href="13683.html">[次]</a><a href="../list/13601-13700.html">[番号順一覧]</a><a href="../thread/13601-13700.html">[スレッド一覧]</a></p>
<p class="id">
mysql:13682
</p>
<div class="header">
<p>
From: kubo &lt;kubo &lt;jazzflute@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 22 Jan 2007 01:03:57 +0900<br>
Subject: [mysql 13682] Re: トランザクション中のオートインクリメント値<br>

</p>
</div>
<div class="body">
<pre>久保と申します。
(このMLへの投稿は初めてです)

<span class="quote1">&gt; トランザクション中のオートインクリメント値について、疑問点がありご質問いたします。</span>
<span class="quote1">&gt; 例えば、トランザクションを開始後</span>
<span class="quote1">&gt; １．steatment1:オートインクリメント値を含むテーブルにインサート処理を実行</span>
<span class="quote1">&gt; ２．steatment2:last_insert_id()を使ってsteatment1でインサートされたオートインクリメント値を取得</span>
<span class="quote1">&gt; ３．steatment3:steatment2で取得したオートインクリメント値を他のテーブルにインサート</span>
<span class="quote1">&gt; 4.全てインサートされればコミットする</span>
<span class="quote1">&gt; というような処理を行いたいのですが、steatment2 でsteatment1のオートインクリメント値を取得する事は可能なのでしょうか？</span>
<span class="quote1">&gt; （つまりコミットする前でもlast_insert_id()が目的の値を返すか、それとも、トランザクション開始前の値を返すかという意味です。）</span>

環境が特殊なので、参考になるかわかりませんが、
上記の1/2/3/4が全て1プロセスの中の同トランザクションであれば、
問題ないかと思います。

実際、同トランザクションにてINSERTしてすぐ直後に
SELECT LAST_INSERT_ID()した際に、INSERTされた
オートインクリメント値を取得できています。



#
# MySQL-5.0で、Javaからのアクセスです。
# transaction-isolationは「Read-Committed」に設定しており、
# FrameworkはSeasar+S2Dao+DBFluteを利用しています。
#


-- 
_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/
kubo   &lt;jazzflute@xxxxxxxxxx&gt;
jflute &lt;<a href="http://d.hatena.ne.jp/jflute">http://d.hatena.ne.jp/jflute</a>&gt;
株式会社ビルドシステム &lt;<a href="http://www.buildsystem.co.jp">http://www.buildsystem.co.jp</a>&gt;
_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/_/



</pre>
</div>
<p class="button"><a href="13681.html">[前]</a><a href="13683.html">[次]</a><a href="../list/13601-13700.html">[番号順一覧]</a><a href="../thread/13601-13700.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="13681.html">  13681 2007-01-22 00:00 ["Mitsuru Araki" &lt;gun] トランザクション中のオートインクリメント値</a></span>
<span class="current">-&gt;&nbsp;<a href="13682.html">  13682 2007-01-22 01:03 ┣[kubo &lt;jazzflute@xxxx]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13683.html">  13683 2007-01-22 10:42 ┗["T.Hirotsu" &lt;hirotsu]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13694.html">  13694 2007-01-25 20:37 　┗["Mitsuru Araki" &lt;gun]                                     </a></span>
</pre>


</body></html>