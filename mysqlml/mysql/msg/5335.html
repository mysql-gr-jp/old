<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5335</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="5334.html">[前]</a><a href="5336.html">[次]</a><a href="../list/5301-5400.html">[番号順一覧]</a><a href="../thread/5301-5400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5335
</p>
<div class="header">
<p>
From: &quot;TAKAHASHI, Tomohiro&quot; &lt;&quot;TAKAHASHI, Tomohiro&quot; &lt;t_takahashi@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 10 Apr 2002 23:30:10 +0900<br>
Subject: [mysql 05335] Re: sjis サーバの BLOB 項目に画像を登録 ( たぶん解決)<br>

</p>
</div>
<div class="body">
<pre>
  高橋(智)です。
  下記の件ですが、Delphi6のUpdate2を施した環境ではいかがでしょうか?
  私が実験してみた限りでは問題は解決されたように思うのですが...。

-- 
高橋智宏
  Java読書会( <a href="http://www.t3-jpn.com/bof/">http://www.t3-jpn.com/bof/</a> )
  T3-Japan( <a href="http://www.t3-jpn.com/">http://www.t3-jpn.com/</a> )

前田 剛 wrote:
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　前田＠ワコムアイティと申します。</span>
<span class="quote1">&gt; 　3ヶ月ほど前からMySQLを使い始めました。どうぞよろしくお願いいた</span>
<span class="quote1">&gt; します。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　MySQL 3.23.47のsjisサーバのBLOB項目に画像を登録しようとしてここ</span>
<span class="quote1">&gt; 数日試行錯誤していましたが、libmysql.dllを修正することによりなん</span>
<span class="quote1">&gt; とかうまく行きました。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　過去ログではこの問題への対応方法が見つかりませんでしたので、一</span>
<span class="quote1">&gt; 応報告しておきます。</span>
<span class="quote1">&gt; 　テストした範囲ではうまくいっているようですが、おかしな点があり</span>
<span class="quote1">&gt; ましたらご指摘下さるようお願いいたします。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 【開発環境】</span>
<span class="quote1">&gt; Borland Delphi 6 Professional(UpdatePack 1)のdbExpressを利用。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; ※dbExpressは、MySQLに接続するためにlibmysql.dllを使用します。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 【発生していた問題】</span>
<span class="quote1">&gt; 　sjisサーバのBLOB項目に特定のバイトパターンを含む画像を登録しよ</span>
<span class="quote1">&gt; うとすると、データが化けるか登録に失敗してしまう。使用していた</span>
<span class="quote1">&gt; libmysql.dllはsjis対応版。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 例：</span>
<span class="quote1">&gt; (元のパターン) 95 5C 27 →  (登録される内容) 95 5C 27 ... OK</span>
<span class="quote1">&gt; (元のパターン) 95 27    →  (登録される内容) 95 5C 27 ... ???</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 【原因】</span>
<span class="quote1">&gt; 　クライアント側でescape処理したものが、サーバ側ではマルチバイト</span>
<span class="quote1">&gt; 文字として誤認識され、結果としてunescapeされない状態でテーブルが</span>
<span class="quote1">&gt; 登録されてしまう（または登録に失敗する）。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　うまく説明できませんので、過去ログで<a href="03156.html">[mysql 03156]</a>から始まるスレッ</span>
<span class="quote1">&gt; ドの議論をご覧下さい。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; <a href="../../msg.cgi%3Fml=mysql&amp;id=3156.html">http://www.mysql.gr.jp/mysqlml/msg.cgi?ml=mysql&amp;id=3156</a></span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 【解決方法】</span>
<span class="quote1">&gt; 　MySQL 3.23.47のソースを取得し、libmysql.cの</span>
<span class="quote1">&gt; mysql_sub_escape_string関数を以下のように修正してビルドした</span>
<span class="quote1">&gt; libmysql.dllを使用することにより解決しました。</span>
[略]

</pre>
</div>
<p class="button"><a href="5334.html">[前]</a><a href="5336.html">[次]</a><a href="../list/5301-5400.html">[番号順一覧]</a><a href="../thread/5301-5400.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="4955.html">   4955 2002-01-18 01:50 [前田 剛 &lt;maeda@xxxxx] sjis サーバの BLOB 項目に画像を登録 ( たぶん解決)</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4956.html">   4956 2002-01-18 02:25 ┣[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="4957.html">   4957 2002-01-18 02:48 ┃┣[&quot;TAKAHASHI, Tomohiro]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5002.html">   5002 2002-01-21 21:25 ┃┗[前田 剛 &lt;maeda@xxxxx]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5003.html">   5003 2002-01-21 21:39 ┃　┗[&quot;TAKAHASHI, Tomohiro]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="5335.html">   5335 2002-04-10 23:30 ┗[&quot;TAKAHASHI, Tomohiro]                                       </a></span>
</pre>
</body>
</html>
