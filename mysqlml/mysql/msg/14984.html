<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:14984</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="14983.html">[前]</a><a href="14985.html">[次]</a><a href="../list/14901-15000.html">[番号順一覧]</a><a href="../thread/14901-15000.html">[スレッド一覧]</a></p>
<p class="id">
mysql:14984
</p>
<div class="header">
<p>
From: Kota Hada &lt;Kota Hada &lt;kthd.wing@xxxxxxxxxx&gt;&gt;<br>
Date: Sat, 18 Jul 2009 12:42:36 +0900<br>
Subject: [mysql 14984] Re: MySQL Clusterのチューニング方法<br>

</p>
</div>
<div class="body">
<pre>
奥野さん

度々、ありがとうございます。

<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; テストでこのようなクエリを実行しておりました。</span>
<span class="quote2">&gt;&gt; 実際には、WHERE句を使い条件をしぼるようにしてます。</span>
<span class="quote2">&gt;&gt; ただ、それでも5〜6秒もかかってしまっています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; それも遅いですね。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ・何行程度の結果を取得するクエリなのでしょうか？</span>

９００行程度返すクエリです。
これを改善した方がよいのかもしれませんね。

<span class="quote1">&gt; ・インデックスは利用していますか？</span>

これもインデックスを使っていなかったので、
まずは、インデックスを使うように変えてみます。

<span class="quote1">&gt; ・テーブルの定義はどのようになっていますか？（SHOW CREATE TABLE）</span>
<span class="quote1">&gt; ・EXPLAINコマンドの実行結果はどうなっていますか？</span>
<span class="quote1">&gt;</span>

こちらは、今手元で確認できませんので、
後日確認しておきます。

付加情報なのですが、同じクエリを以前使っていたMySQL4.0系で実施したとき、
ほぼ同じ内容のテーブルで実行しても１秒程度でレスポンスが返ってきていました。

ほぼ同じというか、そのサーバで使っていたデータをダンプして、
エンジン指定をNDBに変えてインポートしただけなんですが。
この辺りも、影響しているのでは？と若干疑っているんですが、
よくわかっていません。

<span class="quote2">&gt;&gt; 一応、1GbpsのNICでつながっているのですが、</span>
<span class="quote2">&gt;&gt; このれでもボトルネックの可能性はありますでしょうか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 場合によってはボトルネックになります。本当に性能が欲しい場合は、</span>
<span class="quote1">&gt; SCIや10GbEなどを利用するといいでしょう。</span>

なるほど。
すぐにどうこうできる部分ではないので検討してみますが、
今直面している問題とはちょっと別な気がしていたりします。

<span class="quote1">&gt;</span>
<span class="quote1">&gt; ちなみにデータノードは何台ぐらいあるのでしょうか。</span>
<span class="quote1">&gt; また、NoOfReplicasはいくつでしょうか。</span>
<span class="quote1">&gt;</span>

データノードは２台です。
NoOfReplicasは２で設定しています。

<span class="quote2">&gt;&gt; なるほど。</span>
<span class="quote2">&gt;&gt; ただ、特にディスク型を設定した覚えがありません。</span>
<span class="quote2">&gt;&gt; これが原因なのか？？な気がしています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 特に指定した記憶がないのであればインメモリ型でしょう。</span>
<span class="quote1">&gt; これは遅くなる原因とは関係なさそうです。</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; キャッシュサイズについては、少し調べて試しに設定してみることにします。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; DiskPageBufferMemoryで設定できます。</span>
<span class="quote1">&gt; <a href="http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-ndbd-definition.html">http://dev.mysql.com/doc/refman/5.1/en/mysql-cluster-ndbd-definition.html</a></span>
<span class="quote1">&gt;</span>

ありがとうございます。

Clusterの設定についても、もう一度見直してみることにします。

</pre>
</div>
<p class="button"><a href="14983.html">[前]</a><a href="14985.html">[次]</a><a href="../list/14901-15000.html">[番号順一覧]</a><a href="../thread/14901-15000.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="14975.html">  14975 2009-07-17 22:13 [Kota Hada &lt;kthd.wing] MySQL Clusterのチューニング方法         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14976.html">  14976 2009-07-17 23:00 ┗[Mikiya Okuno &lt;Mikiya]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14977.html">  14977 2009-07-18 01:16 　┗[Kota Hada &lt;kthd.wing]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="14978.html">  14978 2009-07-18 11:14 　　┗[Mikiya Okuno &lt;Mikiya]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="14984.html">  14984 2009-07-18 12:42 　　　┗[Kota Hada &lt;kthd.wing]                                 </a></span>
</pre>
</body>
</html>
