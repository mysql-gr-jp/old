<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:16400</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="16399.html">[前]</a><a href="16401.html">[次]</a><a href="../list/16301-16400.html">[番号順一覧]</a><a href="../thread/16301-16400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:16400
</p>
<div class="header">
<p>
From: "yoku ts." &lt;"yoku ts." &lt;yoku0825@xxxxxxxxxx&gt;&gt;<br>
Date: Fri, 14 Apr 2017 10:43:33 +0900<br>
Subject: [mysql 16400] Re: [mysql 16399] Re: [mysql 16393] [告知] MySQL勉強会 in 大阪(第10回)：4/11(火)<br>

</p>
</div>
<div class="body">
<pre>yoku0825といいます。
もともとの宿題がわからないのですが、JSON型にキャストすると上手くいくのではないでしょうか？
（微妙にカラム名とテーブル名が違うのはご容赦ください）


```
mysql57&gt; SELECT  json_insert(j,'$.authority.DC2',
CAST('{"DC2":{"rack":["A01"]}}' AS JSON)) FROM t;
+------------------------------------------------------------------------------+
<span class="quote1">| json_insert(j,'$.authority.DC2', CAST('{"DC2":{"rack":["A01"]}}' AS JSON))   |
</span>
+------------------------------------------------------------------------------+
<span class="quote1">| {"authority": {"DC1": {"rack": ["A01"]}, "DC2": {"DC2": {"rack": ["A01"]}}}} |
</span>
+------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```

あってますかね？


yoku0825,

2017年4月14日 10:11 aoike &lt;masahiro.aoike@xxxxxxxxxx&gt;:
<span class="quote1">&gt; 先日はありがとうございました、あおいけです。
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt; 宿題（？）だったJSON型の件です。
</span>
<span class="quote1">&gt; jsonを扱う関数にjson文字列をjsonObjectとして使えないか…という問いに対して
</span>
<span class="quote1">&gt; 「json_extract使えばいいんじゃない？」とのことだったので試してみました。
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt; JSON型のcolumn(authority)がupdate前には
</span>
<span class="quote1">&gt;   {"authority": {"DC1": {"rack": ["A01"]}}}
</span>
<span class="quote1">&gt; となっている状態から
</span>
<span class="quote1">&gt;   {"authority": {"DC1": {"rack": ["A01"]},"DC2":{"rack":["A01"]}}}
</span>
<span class="quote1">&gt; に変更したい（{"DC2":{"rack":["A01"]}}をinsert）ので、json_unquoteにJson文字列を放り込んで
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt; update u_group set authority =
</span>
<span class="quote1">&gt; json_insert(authority,'$.authority.DC2',json_unquote("{\"DC2\":{\"rack\":[\"A01\"]}}"));
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt; とすると
</span>
<span class="quote1">&gt; {"authority": {"DC1": {"rack": ["A01"]},"DC2":
</span>
<span class="quote1">&gt; "{\"DC2\":{\"rack\":[\"A01\"]}}"}}
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt; と文字列扱いされてしまい、NGでした。
</span>
<span class="quote1">&gt;
</span>
<span class="quote1">&gt;
</span>

</pre>
</div>
<p class="button"><a href="16399.html">[前]</a><a href="16401.html">[次]</a><a href="../list/16301-16400.html">[番号順一覧]</a><a href="../thread/16301-16400.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="16393.html">  16393 2017-04-05 18:30 ["YAMASAKI, Yoshiaki"] [告知] MySQL勉強会 in 大阪(第10回)：4/11(火)</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16399.html">  16399 2017-04-14 10:11 ┗[aoike &lt;masahiro.aoik] Re: [mysql 16393] [告知] MySQL勉強会 in 大阪(第10回)：4/11(火)</a></span>
<span class="current">-&gt;&nbsp;<a href="16400.html">  16400 2017-04-14 10:43 　┗["yoku ts." &lt;yoku0825] Re: [mysql 16399] Re: [mysql 16393] [告知] MySQL勉強会 in 大阪(第10回)：4/11(火)</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="16401.html">  16401 2017-04-14 11:19 　　┗[aoike &lt;masahiro.aoik] Re: [mysql 16400] Re: [mysql 16399] Re: [mysql 16393] [告知] MySQL勉強会 in 大阪(第10回)：4/11(火)</a></span>
</pre>


</body></html>