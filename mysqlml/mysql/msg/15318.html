<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15318</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="15317.html">[前]</a><a href="15319.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:15318
</p>
<div class="header">
<p>
From: Yasufumi Kinoshita &lt;Yasufumi Kinoshita &lt;kinoyasu@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 13 May 2010 14:10:29 +0900<br>
Subject: [mysql 15318] Re: InnoDBのfrmとibdのみでのデータ移行<br>

</p>
</div>
<div class="body">
<pre>
木下です。

以下の話は一般ユーザーにとってはとても複雑なので、
正直、普通の上級者にもお勧めしません。。。
（何かあった場合に自分で.ibdのバイナリを読めるくらいじゃないと対処できないし、
　私はフォローできません。利用はあくまで自己責任で。。。）

私の１年前の記事です。
<a href="http://buildup-db.blogspot.com/2009/05/import-tablespace.html">http://buildup-db.blogspot.com/2009/05/import-tablespace.html</a>

XtraBackup で必要な情報を作成し、XtraDBで拡張された
&quot;import tablespace&quot;コマンドで取り込みます。
書いてあることが一箇所でも判らないならば、
悪いことは言いません。諦めましょう。
（最近は機能追加が多くて、
　XtraBackup-XtraDBのバージョンの組み合わせの問題も発生するかも。。。）

ソースが読めるなら、XtraDB の innodb_expand_import.patch
の該当部分を利用して、汎用の変換ツールを作っても良いと思います。
そちらにしても、普通のInnoDBでやるには、
内部テーブルをibdataから読み出す（場合によっては書く）腕前が必要です。
オフラインのibdataなら、同時に更新されることはないので
ファイルフォーマットさえ判れば必要な情報を取り出すことは
一貫性を気にしなくて良いぶんだけ簡単でしょう。

<span class="quote1">&gt; 松永です。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; On Tue, May 11, 2010 at 03:54:29PM +0900, Mikiya Okuno wrote:</span>
<span class="quote3">&gt; &gt; &gt; にもibdataと.ibdをコピーせよと書かれています。</span>
<span class="quote3">&gt; &gt; &gt; ibdataが無い状態では、InnoDBはテーブルの復活はさせられないのでしょうか。</span>
<span class="quote2">&gt; &gt; .ibdファイルだけだと移行は無理です。というのも、InnoDBの各データファイルには</span>
<span class="quote2">&gt; &gt; 連番がつけられており、共有テーブルスペース（ibdata1）とセットではじめて</span>
<span class="quote2">&gt; &gt; 正常に動作するからです。ibdata1内に記録された各.ibdファイルの番号と、</span>
<span class="quote2">&gt; &gt; .ibdファイル内に記録された番号が一致していなければなりません。</span>
<span class="quote1">&gt; なるほど。ありがとうございます。</span>
<span class="quote1">&gt; </span>
<span class="quote2">&gt; &gt; 未だ移行のメカニズムは（公式には）確立されていません。</span>
<span class="quote1">&gt; 非公式というか有志によるというかには、なにか魔術めいたbad</span>
<span class="quote1">&gt; knowhowがあるのでしょうか?</span>
<span class="quote1">&gt; もしよろしければポインタ等を教示いただけるとありがたいです。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; </span>

--
木下 靖文
kinoyasu@xxxxxxxxxx

</pre>
</div>
<p class="button"><a href="15317.html">[前]</a><a href="15319.html">[次]</a><a href="../list/15301-15400.html">[番号順一覧]</a><a href="../thread/15301-15400.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15315.html">@ 15315 2010-05-11 15:43 [MATSUNAGA Ichiro &lt;vi] InnoDBのfrmとibdのみでのデータ移行      </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15316.html">  15316 2010-05-11 15:54 ┗[Mikiya Okuno &lt;Mikiya]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15317.html">@ 15317 2010-05-11 17:01 　┗[MATSUNAGA Ichiro &lt;vi]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="15318.html">  15318 2010-05-13 14:10 　　┗[Yasufumi Kinoshita &lt;]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15320.html">@ 15320 2010-05-16 19:32 　　　┗[MATSUNAGA Ichiro &lt;vi]                                 </a></span>
</pre>
</body>
</html>
