<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:9782</title>
<link rel="stylesheet" type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="9781.html">[前]</a><a href="9783.html">[次]</a><a href="../list/9701-9800.html">[番号順一覧]</a><a href="../thread/9701-9800.html">[スレッド一覧]</a></p>
<p class="id">
mysql:9782
</p>
<div class="header">
<p>
From: "福田　晃章" &lt;"福田　晃章" &lt;t.fukuta@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 6 Jul 2004 18:51:01 +0900<br>
Subject: [mysql 09782] Re: MySQLのデータをAccessから修正するとデータの競合となる<br>

</p>
</div>
<div class="body">
<pre>福田です。

「つちや」さん
MySQL Manual 11.2.5 MyODBC と連動して動作することが知られている
プログラムより．．．TIMESTAMPフィールドを追加する事で問題解決しました。

「藤澤」さん
パススルークエリの件、教えて頂きありがとうございます。

たいへん勉強になりました。

----- Original Message ----- 
From: "ＪＳＤ藤澤知弥" &lt;fujisawa-tomoya@xxxxxxxxxx&gt;
To: &lt;ml@xxxxxxxxxx&gt;
Sent: Tuesday, July 06, 2004 8:03 AM
Subject: <a href="09780.html">[mysql 09780]</a> Re: MySQLのデータをAccessから修正するとデータの競合と
なる


<span class="quote1">&gt; ふじさわです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; （Accessの話になってしまい恐縮です。）</span>
<span class="quote1">&gt; パススルークエリは、</span>
<span class="quote1">&gt;   1.オブジェクトからクエリを選択 {テーブル,クエリ,フォーム,レポート,ページ</span>
,,,,}
<span class="quote1">&gt;   2.「クエリの新規作成」で[デザインビュー]を選択した状態で、[OK]</span>
<span class="quote1">&gt;   3.「テーブルの表示」が出るので、[閉じる] (何も選択しない)</span>
<span class="quote1">&gt;   4. メニューバーの[クエリ]-[SQL]-[パススルー]</span>
<span class="quote1">&gt; と、ここまで来ると、SQL文を入力できる状態というか、エディタが開いた</span>
<span class="quote1">&gt; 状態になります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; パススルークエリは「パスをスルーさせるクエリ(???)」ですので、繋ぎ</span>
<span class="quote1">&gt; 先のDBが理解できるSQL文、つまり、MySQLが理解できるSQL文を記述しま</span>
<span class="quote1">&gt; す。</span>
<span class="quote1">&gt; 「mysql&gt;」というプロンプトで発行できるSQL文を、ここで記述すればOK</span>
<span class="quote1">&gt; ということです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; ＊つちやさんのレスの方が的を得ているようですが、ご参考まで。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 以上</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; &lt;000a01c46263$6a71be20$190a0ac0@EIGYOU1&gt; の、</span>
<span class="quote1">&gt;    "<a href="09777.html">[mysql 09777]</a> Re: MySQLのデータをAccessから修正するとデータの競合とな</span>
る" において、
<span class="quote1">&gt;    ""福田　晃章" &lt;t.fukuta@xxxxxxxxxx&gt;"さんは書きました：</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt; &gt; 福田です。</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; ”ふじさわ”さん早速の回答ありがとうございます。</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; Accessのバススルークエリを使った事がないのですが、CSE でSQLが通った文</span>
<span class="quote2">&gt; &gt; を実行してみましたが、エラーが返ってきました。</span>
<span class="quote2">&gt; &gt; ．．．実行方法がよく分かっていません。</span>
<span class="quote2">&gt; &gt; 　　　SQL文：UPDATE TBL_Keiyaky_Main SET Setu_Kanri_Cd = 5 WHERE</span>
PrimaryKey
<span class="quote2">&gt; &gt; = 1;</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; 新たな発見がありました。</span>
<span class="quote2">&gt; &gt; Accessの更新クエリを実行すると、「データの競合」メッセージも出ず正しく処</span>
理で
<span class="quote2">&gt; &gt; きました。</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; という事は、Access のデータシートビューと、フォームでデータを修正すると</span>
エ
<span class="quote2">&gt; &gt; ラーとなって</span>
<span class="quote2">&gt; &gt; いるようです。</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; ----- Original Message ----- </span>
<span class="quote2">&gt; &gt; From: "ＪＳＤ藤澤知弥" &lt;fujisawa-tomoya@xxxxxxxxxx&gt;</span>
<span class="quote2">&gt; &gt; To: &lt;ml@xxxxxxxxxx&gt;</span>
<span class="quote2">&gt; &gt; Sent: Monday, July 05, 2004 4:06 PM</span>
<span class="quote2">&gt; &gt; Subject: <a href="09776.html">[mysql 09776]</a> Re: MySQLのデータをAccessから修正するとデータの競</span>
合と
<span class="quote2">&gt; &gt; なる</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; ふじさわです。</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; 「Accessからリンクする際に、リンクテーブル上で主キーを</span>
<span class="quote3">&gt; &gt; &gt;   設定できていない」</span>
<span class="quote3">&gt; &gt; &gt; かと思いましたが、レコードによって修正できたりできなか</span>
<span class="quote3">&gt; &gt; &gt; ったりするのであれば、問題無いのでしょうね。。。</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; 「CSE (Common SQL Environment)」から更新のSQLが実行で</span>
<span class="quote3">&gt; &gt; &gt; きるということは、Accessのパススルークエリでも同じSQL</span>
<span class="quote3">&gt; &gt; &gt; 文が実行出来そうです。今も状況を再現できるのであれば、</span>
<span class="quote3">&gt; &gt; &gt; 試してみては如何ですか？</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; ＊できれば、エラーメッセが出る時の操作手順、エラーコー</span>
<span class="quote3">&gt; &gt; &gt;   ド、正確なエラーメッセージ本文などがあると、今後の参</span>
<span class="quote3">&gt; &gt; &gt;   考にできるのですが。。。</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; 不十分なレスですみません。。。</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt; &lt;001f01c4625c$c616e900$190a0ac0@EIGYOU1&gt; の、</span>
<span class="quote3">&gt; &gt; &gt;    "<a href="09775.html">[mysql 09775]</a> MySQLのデータをAccessから修正するとデータの競合とな</span>
る"
<span class="quote2">&gt; &gt; において、</span>
<span class="quote3">&gt; &gt; &gt;    ""福田　晃章" &lt;t.fukuta@xxxxxxxxxx&gt;"さんは書きました：</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; This is a multi-part message in MIME format.</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; 福田といいます。</span>
<span class="quote4">&gt; &gt; &gt; &gt; 先日より MySQL を利用し始めました。</span>
<span class="quote4">&gt; &gt; &gt; &gt; 環境は、サーバに MySQL を設置して、ODBC を経由して、Access</span>
<span class="quote4">&gt; &gt; &gt; &gt; にリンクしてデータ操作をしています。</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; トラブルの内容は、Access にリンクしたテーブルのレコードの修正する</span>
と、
<span class="quote4">&gt; &gt; &gt; &gt; Access からデータの競合メッセージが表示されて、データが修正できませ</span>
ん。
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; しかし、すべてのデータが修正できない訳ではなくて、修正できるレコード</span>
も
<span class="quote4">&gt; &gt; &gt; &gt; 存在します。</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; データが修正できない現象は、Access に限っているようです。</span>
<span class="quote4">&gt; &gt; &gt; &gt; フリーソフトの CSE より MySQL に接続して、</span>
<span class="quote4">&gt; &gt; &gt; &gt; update テーブル名 set フィールド名 = XXXX where 条件;</span>
<span class="quote4">&gt; &gt; &gt; &gt; を実行すると、データは更新できました。</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; 質問．１</span>
<span class="quote4">&gt; &gt; &gt; &gt;   MySQL 単体では update できますが、Access に接続するとデータの</span>
<span class="quote4">&gt; &gt; &gt; &gt;   競合メッセージがでるのでしょうか？</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; 質問．２</span>
<span class="quote4">&gt; &gt; &gt; &gt;   Access 上で、データの修正ができるものと、データの競合が出て修正</span>
<span class="quote4">&gt; &gt; &gt; &gt;   できない場合の違いは何ですか？</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt; まだ初心者ですので、よく理解できていない為、どなたか教えて頂けないで</span>
しょ
<span class="quote2">&gt; &gt; う</span>
<span class="quote4">&gt; &gt; &gt; &gt; か。</span>
<span class="quote4">&gt; &gt; &gt; &gt; よろしくお願い致します。</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote4">&gt; &gt; &gt; &gt;</span>
<span class="quote3">&gt; &gt; &gt;</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote1">&gt;</span>


</pre>
</div>
<p class="button"><a href="9781.html">[前]</a><a href="9783.html">[次]</a><a href="../list/9701-9800.html">[番号順一覧]</a><a href="../thread/9701-9800.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="9775.html">@  9775 2004-07-05 15:53 ["福田　晃章" &lt;t.fuku] MySQLのデータをAccessから修正するとデータの競合となる</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9776.html">   9776 2004-07-05 16:06 ┣[ＪＳＤ藤澤知弥 &lt;fuji]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9777.html">   9777 2004-07-05 16:40 ┃┗["福田　晃章" &lt;t.fuku]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9780.html">   9780 2004-07-06 08:03 ┃　┗[ＪＳＤ藤澤知弥 &lt;fuji]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="9782.html">   9782 2004-07-06 18:51 ┃　　┗["福田　晃章" &lt;t.fuku]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9778.html">   9778 2004-07-05 16:46 ┣["MIKAHOSI" &lt;mikahosi]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="9779.html">   9779 2004-07-05 21:03 ┗[つちや &lt;kajika@xxxxx]                                       </a></span>
</pre>


</body></html>