<html><head></head><body><div dir="ltr">こんばんは。<div><br></div><div>解決なさったようでよかったです！</div><div>フィードバックありがとうございました :)</div><div><br></div><div>yoku0825,</div></div><div class="gmail_extra"><br><div class="gmail_quote">2014年11月2日 18:16 香田昌俊 <span dir="ltr">&lt;<a href="mailto:m.kouda@verve-inc.jp" target="_blank">m.kouda@verve-inc.jp</a>&gt;</span>:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>yoku0825様</div><div><br></div><div>ご回答頂きありがとうございます。</div><div><br></div><div>ご教授頂いた内容を元に再度見直したところ、</div><div>LVS側のiptablesにmysqlの許可設定でNEWステートが入っている影響で、</div><div>MySQL側にFINが届いておらず、LVS側でドロップされておりました。</div><div><br></div><div>LVS側のiptablesを下記の様に変更し問題は解決しました。</div><div><br></div><div>-----</div><div>from</div><div>-A RH-Firewall-1-INPUT -s xxxx -p tcp -m state --state NEW -m tcp --dport xxxx -j ACCEPT</div><div>to</div><div>-A RH-Firewall-1-INPUT -s xxxx -p tcp -m tcp --dport xxxx -j ACCEPT</div><div>-----</div><div><br></div><div>ありがとうございました!!</div><div class="gmail_extra"><br></div><div class="gmail_extra"><br><div class="gmail_quote">2014年11月2日 17:21 yoku ts. <span dir="ltr">&lt;<a href="mailto:yoku0825@gmail.com" target="_blank">yoku0825@gmail.com</a>&gt;</span>:<div><div class="h5"><br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><p dir="ltr">こんにちは、yoku0825といいます。</p>
<p dir="ltr">このあたり、参考にならないでしょうか。</p>
<p dir="ltr">LVS が FIN を落とす | <a href="http://3.1415.jp" target="_blank">3.1415.jp</a> <br>
<a href="http://3.1415.jp/node/226" target="_blank">http://3.1415.jp/node/226</a><br></p>
<p dir="ltr">yoku0825, <br>
</p>
<div class="gmail_quote">2014/11/01 23:26 "香田昌俊" &lt;<a href="mailto:m.kouda@verve-inc.jp" target="_blank">m.kouda@verve-inc.jp</a>&gt;:<div><div><br type="attribution"><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir="ltr"><div>香田と申します。初めて投稿させて頂きます。</div><div></div><div>MySQLの負荷分散としてLVS(DSR)を利用し、Postfix(クライアント)からMySQLを</div><div>参照させメール配信を行う検証を行っております。</div><div><br></div><div>--------</div><div>構成</div><div>- Postfix (クライアント) ---&gt; LVS(DSR) ---&gt; MySQL</div><div><br></div><div>バージョン</div><div>- Keepalived 1.2.7</div><div>- MySQL 5.5.36</div><div>- Postfix 2.6.6-6</div><div>--------</div><div><br></div><div>Postfix側でMySQLを参照させ、メール送信を行うと</div><div>送信完了後も、MySQLにconnectionが残り続けるという事象が発生しました。</div><div></div><div>メール配信をする度にconnectionが残り続け、</div><div>最終的にMySQL でmax connectionに到達してしまうという状況です。</div><div><br></div><div>netstatを見ると、MySQL側にESTABLISHEDが残り続け、</div><div>Postfix側にFIN_WAIT1が多発している状況です。</div><div><br></div><div>何か考えられる要因等、アドバイスいただけると幸いです。</div><div>宜しくお願いします。</div><div><br></div></div>
</blockquote></div></div></div>
</blockquote></div></div></div><br></div></div>
</blockquote></div><br></div>
</body></html>