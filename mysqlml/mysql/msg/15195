<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15195</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15194">[前]</a><a href="15196">[次]</a><a href="../list/15101-15200">[番号順一覧]</a><a href="../thread/15101-15200">[スレッド一覧]</a></p>
<p class="id">
mysql:15195
</p>
<div class="header">
<p>
From: &quot;EBIHARA, Yuichiro&quot; &lt;&quot;EBIHARA, Yuichiro&quot; &lt;ebihara@xxxxxxxxxx&gt;&gt;<br>
Date: Wed, 24 Feb 2010 14:06:38 +0900<br>
Subject: [mysql 15195] Re: 指定地点までレプリケート<br>

</p>
</div>
<div class="body">
<pre>
こんにちは、海老原です。
自分で引き続き調べていたところ、次の文書を見つけました。

<a href="http://assets.en.oreilly.com/1/event/21/Replication%20Tutorial%20Paper.pdf">http://assets.en.oreilly.com/1/event/21/Replication%20Tutorial%20Paper.pdf</a>

この文書そのものがどういう位置づけのものなのかはよく分かりませんが、著者はどうやらMySQLのレプリケーションチームの方のようなので、内容は信頼できそうです。

で、これの14ページ目の&quot;How to clone a slave&quot;に、START SLAVE
UNTILの使用例が記載されており、最初に自分で考えた手順で恐らく問題ないだろうと思っていますが、1つよく分からないのは、SHOW
MASTER STATUSの実行前にFLUSH TABLESで全テーブルをロックしている点です。

別にポジションを確認するだけならロックしなくてもいいんじゃないかとも思うんですが。

どなたか、この手順の意味が分かる方がいらっしゃれば教えてください。
よろしくお願いします。

海老原 雄一郎

2010年2月24日2:43 EBIHARA, Yuichiro &lt;ebihara@xxxxxxxxxx&gt;:
<span class="quote1">&gt; MyNAの皆さま</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; こんにちは、海老原と申します。</span>
<span class="quote1">&gt; レプリケーションについて質問があります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; マスター/スレーブ型のレプリケーション構成で、スレーブを常にマスターに追随させるのではなく、スレーブの状態をマスターのある時点のスナップショットとして固定しておきたいと思っています。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; マスターには継続的に更新が発生するものとし、たとえば1日に1回、(おおよそ)00:00時点のマスターの状態をスレーブにレプリケートするとします。</span>
<span class="quote1">&gt; この場合、次のような手順を考えているのですが、もし問題や注意点などがあればご指摘いただけないでしょうか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 前提1)スレーブ側でCHNAGE MASTER TOコマンドは適切に実行完了している</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 前提2)START SLAVE IO_THREADコマンドで I/Oスレッドだけは起動され、バイナリログの転送は常時行われている</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 1)00:00にマスター側でSHOW MASTER STATUSコマンドを実行</span>
<span class="quote1">&gt; FileとPositionを確認する。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 2)スレーブ側でSTART SLAVE SQL_THREAD UNTILコマンドを実行</span>
<span class="quote1">&gt; MASTER_LOG_FILEとMASTER_LOG_POSパラメータに、1)で確認した値を指定する。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 後は毎日1)と2)を繰り返す。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 意外とシンプルに実装できそうな気がしていますが、何か勘違いしている点などあれば、ご指摘いただけると助かります。</span>
<span class="quote1">&gt; (または、勘違いがなければないと言っていただけるのも同じくらい助かります)</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; どうぞよろしくお願いします。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 海老原 雄一郎</span>
<span class="quote1">&gt;</span>

</pre>
</div>
<p class="button"><a href="15194">[前]</a><a href="15196">[次]</a><a href="../list/15101-15200">[番号順一覧]</a><a href="../thread/15101-15200">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15194">  15194 2010-02-24 02:43 [&quot;EBIHARA, Yuichiro&quot; ] 指定地点までレプリケート                </a></span>
<span class="current">-&gt;&nbsp;<a href="15195">  15195 2010-02-24 14:06 ┗[&quot;EBIHARA, Yuichiro&quot; ]                                       </a></span>
</pre>
</body>
</html>
