<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13382</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13381">[前]</a><a href="13383">[次]</a><a href="../list/13301-13400">[番号順一覧]</a><a href="../thread/13301-13400">[スレッド一覧]</a></p>
<p class="id">
mysql:13382
</p>
<div class="header">
<p>
From: &quot;Yoshio Kawano&quot; &lt;&quot;Yoshio Kawano&quot; &lt;kawano@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 28 Sep 2006 23:09:03 +0900<br>
Subject: [mysql 13382] Re: mysqlが起動しない（4.0.26⇒5.0.24a）<br>

</p>
</div>
<div class="body">
<pre>
お世話になっております。
ｙｋａｗａです。

早間様へ
ご教示頂き、ありがとうございました。

報告が遅くなりまして、誠に申し訳けありませんでした。

ご教示いただいた内容で試してみましたが、結果がダメでした。

また、色々調べ＆試した結果、キーに元々文字化けしているコードが含まれていると
何故かしら何をやってもダメでした。
多分、サーバー側の文字コードに変換できない文字は、統一的に別の文字に変換され
るのでしょう。
その為、キーが重複していると判断されている様な気がします。

そこで、しょうがないので
mysqldumpで、データのみをダンプするモードを使い、テーブル毎のテキストダンプ
を出力し
mysqlimportを使って、上書きインポートを行う事にしました。

文字化けしているコードについては、目をツブッテしまいました。

----- Original Message ----- 
From: &quot;早間&quot; &lt;hayama@xxxxxxxxxx&gt;
To: &lt;ml@xxxxxxxxxx&gt;
Sent: Thursday, September 21, 2006 12:00 PM
Subject: <a href="13375">[mysql 13375]</a> Re: mysqlが起動しない（4.0.26⇒5.0.24a）


<span class="quote1">&gt; From: &quot;Yoshio Kawano&quot; &lt;kawano@xxxxxxxxxx&gt;</span>
<span class="quote1">&gt; Subject: <a href="13374">[mysql 13374]</a> Re: mysqlが起動しない（4.0.26⇒5.0.24a）</span>
<span class="quote1">&gt; Date: Thu, 21 Sep 2006 11:21:13 +0900</span>
<span class="quote1">&gt; Message-ID: &lt;002901c6dd24$9c590a40$0300aac0@yoshio4889b59a&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; ◆インポートした時のコマンド</span>
<span class="quote2">&gt; &gt;     $mysql -u xxx db_name　&lt; db_name.schema　←これは成功</span>
<span class="quote2">&gt; &gt;     $mysql -u xxx db_name　&lt; db_name.insert　←失敗</span>
<span class="quote2">&gt; &gt;     エラー内容は、</span>
<span class="quote2">&gt; &gt;         ERROR 1062(23000) at line 367：Duplicate entry 'ｘｘｘｘｘ'　fro</span>
key 1
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt; ◎キーに対して同じ値を登録しようとしているので失敗していると思われる。</span>
（mysqldumpの素のデータなのに、何故？）
<span class="quote2">&gt; &gt;     そこで、二重登録が発生したら無視する様な指定で実行すれば良いかと思っ</span>
たのですが
<span class="quote2">&gt; &gt;     mysqlコマンドに、ignoreオプションが無い。『-i』は、あるが、これは少</span>
し意味合いが違うみたい。
<span class="quote2">&gt; &gt;</span>
<span class="quote2">&gt; &gt;     しょうがないので、mysqlimportを使ってみた。　←これを使う事が有って</span>
いるのか解らず。
<span class="quote2">&gt; &gt;     しかし、結果はダメでした。</span>
<span class="quote2">&gt; &gt;         mysqlimport：Error:Table　'db_name.db_name' doesn't　exist when</span>
using table：　db_name
<span class="quote2">&gt; &gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; mysql 5.0.x は使用していないのですが、データ(キー)に漢字が含まれて</span>
<span class="quote1">&gt; いるのではないでしょうか。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; 4.0.21 から 4.1.21 に変更するときに(my.conf も異なっていたのですが)</span>
<span class="quote1">&gt; 漢字キーのデータがエラーになりました。</span>
<span class="quote1">&gt; 設定ファイルに(何カ所も)</span>
<span class="quote1">&gt;   default-character-set=utf8</span>
<span class="quote1">&gt; の設定が入っていました。これをすべて</span>
<span class="quote1">&gt;   default-character-set=ujis</span>
<span class="quote1">&gt; に変えたのですが、成功しませんでした。</span>
<span class="quote1">&gt;   character_set_client = ujis</span>
<span class="quote1">&gt; を設定した結果インポートに成功しました。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; db そのままの時は内部コードが異なっていたのではないかと思います。</span>
<span class="quote1">&gt;   character-set-server</span>
<span class="quote1">&gt; で対応できたかも知れません。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; -- 早間 義博</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>


</pre>
</div>
<p class="button"><a href="13381">[前]</a><a href="13383">[次]</a><a href="../list/13301-13400">[番号順一覧]</a><a href="../thread/13301-13400">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="13371">@ 13371 2006-09-20 18:28 [&quot;Yoshio Kawano&quot; &lt;kaw] mysqlが起動しない（4.0.26⇒5.0.24a）    </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13374">@ 13374 2006-09-21 11:21 ┗[&quot;Yoshio Kawano&quot; &lt;kaw]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13375">  13375 2006-09-21 12:00 　┗[早間 &lt;hayama@xxxxxxx]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="13382">  13382 2006-09-28 23:09 　　┗[&quot;Yoshio Kawano&quot; &lt;kaw]                                   </a></span>
</pre>
</body>
</html>
