<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:15286</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="15285">[前]</a><a href="15287">[次]</a><a href="../list/15201-15300">[番号順一覧]</a><a href="../thread/15201-15300">[スレッド一覧]</a></p>
<p class="id">
mysql:15286
</p>
<div class="header">
<p>
From: 関口一心 &lt;関口一心 &lt;8888.saleen.s7@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 22 Apr 2010 17:37:53 +0900<br>
Subject: [mysql 15286] Re: ibdata1の初期値とメモリーの関係について<br>

</p>
</div>
<div class="body">
<pre>
奥野さん

ご返信有難う御座います。
不要の部分も御座いますが、InnoDBが有効にならずにmysqlが起動した時に吐かれているエラーログです。

100422 17:24:23 mysqld_safe Starting mysqld daemon with databases from
/mysql/var
100422 17:24:24 [Warning] The syntax '--log_slow_queries' is
deprecated and will be removed in MySQL 7.0. Please use
'--slow_query_log'/'--slow_query_log_file' instead.
100422 17:24:24 [Warning] No argument was provided to --log-bin, and
--log-bin-index was not used; so replication may break when this MySQL
server acts as a master and has his hostname changed!! Please use
'--log-bin=maildb-bin' to avoid this problem.
100422 17:24:24 [ERROR] Function 'mecab' already exists
100422 17:24:24 [ERROR] Couldn't load plugin named 'mecab' with soname
'libftmecab.so.0.0.0'.
InnoDB: The first specified data file /mysql/var/ibdata1 did not exist:
InnoDB: a new database to be created!
100422 17:24:24  InnoDB: Setting file /mysql/var/ibdata1 size to 3072 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Progress in MB: 100 200 300 400 500 600 700 800 900 1000 1100
1200 1300 1400 1500 1600 1700 1800 1900 2000 2100 2200 2300 2400 2500
2600 2700 2800 2900 3000
100422 17:26:14  InnoDB: Log file ./ib_logfile0 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile0 size to 256 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Progress in MB:100422 17:26:14 mysqld_safe Starting mysqld
daemon with databases from /mysql/var/
100422 17:26:14 [Warning] The syntax '--log_slow_queries' is
deprecated and will be removed in MySQL 7.0. Please use
'--slow_query_log'/'--slow_query_log_file' instead.
 100100422 17:26:14 [Warning] No argument was provided to --log-bin,
and --log-bin-index was not used; so replication may break when this
MySQL server acts as a master and has his hostname changed!! Please
use '--log-bin=maildb-bin' to avoid this problem.
 200100422 17:26:14 [ERROR] Function 'mecab' already exists
100422 17:26:14 [ERROR] Couldn't load plugin named 'mecab' with soname
'libftmecab.so.0.0.0'.
InnoDB: Unable to lock ./ib_logfile0, error: 11
InnoDB: Check that you do not already have another mysqld process
InnoDB: using the same InnoDB data or log files.
InnoDB: Error in opening ./ib_logfile0
100422 17:26:22 [ERROR] Plugin 'InnoDB' init function returned error.
100422 17:26:22 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGINE failed.
100422 17:26:22  InnoDB: Log file ./ib_logfile1 did not exist: new to be created
InnoDB: Setting log file ./ib_logfile1 size to 256 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Progress in MB:100422 17:26:22 [Note] Event Scheduler: Loaded 0 events
 100100422 17:26:22 [Note] /usr/local/libexec/mysqld: ready for connections.
Version: '5.1.35-log'  socket: '/tmp/mysql.sock'  port: 3306  Source
distribution
 200
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: Creating foreign key constraint system tables
InnoDB: Foreign key constraint system tables created
100422 17:26:31  InnoDB: Started; log sequence number 0 0
100422 17:26:31 [ERROR] Can't start server: Bind on TCP/IP port:
Address already in use
100422 17:26:31 [ERROR] Do you already have another mysqld server
running on port: 3306 ?
100422 17:26:31 [ERROR] Aborting
100422 17:26:31  InnoDB: Starting shutdown...
100422 17:26:33  InnoDB: Shutdown completed; log sequence number 0 46410
100422 17:26:33 [Note] /usr/local/libexec/mysqld: Shutdown complete

アドバイスを宜しくお願い致します。


2010年4月22日17:11 Mikiya Okuno &lt;Mikiya.Okuno@xxxxxxxxxx&gt;:
<span class="quote1">&gt; 関口さん、</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; InnoDBが起動しない場合、その理由はエラーログに記述されています。</span>
<span class="quote1">&gt; なのでエラーログの内容を拝見させて頂かないと何とも言えません。</span>
<span class="quote1">&gt; もし宜しければ該当部分のログを見せて頂けますか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; よろしくお願いします。</span>
<span class="quote1">&gt; --</span>
<span class="quote1">&gt; 奥野 幹也</span>
<span class="quote1">&gt; <a href="http://www.google.com/profiles/mikiya.okuno">http://www.google.com/profiles/mikiya.okuno</a></span>
<span class="quote1">&gt; <a href="http://nippondanji.blogspot.com/">http://nippondanji.blogspot.com/</a></span>
<span class="quote1">&gt; <a href="http://twitter.com/nippondanji">http://twitter.com/nippondanji</a></span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt; On 22/04/2010, at 4:50 PM, 関口一心 wrote:</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; 平塚さん</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 関口です。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; アドバイス有難うございます。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 前任者が設定を行っていたmy.cnf だったのでその他の設定値を良く見ずに設定をしてしまったせいで、</span>
<span class="quote2">&gt;&gt; そもそも</span>
<span class="quote2">&gt;&gt; innodb_buffer_pool + key_buffer + max_connections * (sort_buffer +</span>
<span class="quote2">&gt;&gt; read_buffer + read_rnd_buffer) + max_connections * 2 MB</span>
<span class="quote2">&gt;&gt; この値が2Gを大きく上回っていました。</span>
<span class="quote2">&gt;&gt; innodb_buffer_pool_size = 1536M</span>
<span class="quote2">&gt;&gt; この値では当然のようにNGでした。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; アドバイスをきっかけに見直すことが出来ました。</span>
<span class="quote2">&gt;&gt; 有難う御座います。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 上記作業後、疑問が生まれました。</span>
<span class="quote2">&gt;&gt; innodb_buffer_pool + key_buffer + max_connections * (sort_buffer +</span>
<span class="quote2">&gt;&gt; read_buffer + read_rnd_buffer) + max_connections * 2 MB</span>
<span class="quote2">&gt;&gt; この値を2G以内に抑え、</span>
<span class="quote2">&gt;&gt; innodb_data_file_path = ibdata1:3G:autoextend</span>
<span class="quote2">&gt;&gt; にしてもInnoDBが有効にならない状態で起動してしまいます。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; この状態になるのは何故なのか？</span>
<span class="quote2">&gt;&gt; 私個人の疑問を晴らすために、皆様からのご回答をお待ちしています。</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote2">&gt;&gt; 2010年4月22日12:27 HIRATSUKA Sadao &lt;hiratsuka.sadao@xxxxxxxxxx&gt;:</span>
<span class="quote3">&gt;&gt;&gt; ひらつかです。</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; On Thu, 22 Apr 2010 11:37:08 +0900</span>
<span class="quote3">&gt;&gt;&gt; 関口一心 &lt;8888.saleen.s7@xxxxxxxxxx&gt; wrote:</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote4">&gt;&gt;&gt;&gt; 現在、linux、CentOS5.2（32ビット）、mysql5.1.35の構築を行っており、my.cnfの設定値で悩んでいます。</span>
<span class="quote4">&gt;&gt;&gt;&gt; innodb_data_file_path = ibdata1:2G:autoextend</span>
<span class="quote4">&gt;&gt;&gt;&gt; innodb_buffer_pool_size = 1536M</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; 32ビット環境でinnodb_buffer_pool_size = 1536Mは厳しいと思います。</span>
<span class="quote3">&gt;&gt;&gt; innodb_data_file_pathは2Gのままで、</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; innodb_data_file_path = ibdata1:2G:autoextend</span>
<span class="quote3">&gt;&gt;&gt; innodb_buffer_pool_size = 512M</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; とするといかがでしょうか。</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote4">&gt;&gt;&gt;&gt; ibdata1の初期値と起動時に使用するメモリーは、</span>
<span class="quote4">&gt;&gt;&gt;&gt; どの様な依存関係にあるのかアドバイスが頂ければと思い投稿しました。</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; ソースを読んで確認したわけではないですが、</span>
<span class="quote3">&gt;&gt;&gt; あまり関係ないと思います。</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt; --</span>
<span class="quote3">&gt;&gt;&gt; 平塚貞夫 hiratsuka.sadao@xxxxxxxxxx</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote3">&gt;&gt;&gt;</span>
<span class="quote2">&gt;&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>

</pre>
</div>
<p class="button"><a href="15285">[前]</a><a href="15287">[次]</a><a href="../list/15201-15300">[番号順一覧]</a><a href="../thread/15201-15300">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="15273">  15273 2010-04-22 11:37 [関口一心 &lt;8888.salee] ibdata1の初期値とメモリーの関係について </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15277">  15277 2010-04-22 12:27 ┗[HIRATSUKA Sadao &lt;hir]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15282">  15282 2010-04-22 16:50 　┗[関口一心 &lt;8888.salee]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15283">  15283 2010-04-22 17:00 　　┣[Akio Imai &lt;suzuro204] Re: [mysql 15282] Re: ibdata1の初期値とメモリーの関係について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15285">  15285 2010-04-22 17:23 　　┃┗[関口一心 &lt;8888.salee] Re: ibdata1の初期値とメモリーの関係について</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15284">  15284 2010-04-22 17:11 　　┗[Mikiya Okuno &lt;Mikiya]                                   </a></span>
<span class="current">-&gt;&nbsp;<a href="15286">  15286 2010-04-22 17:37 　　　┗[関口一心 &lt;8888.salee]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15287">  15287 2010-04-22 17:52 　　　　┗[Mikiya Okuno &lt;Mikiya]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15288">  15288 2010-04-22 18:29 　　　　　┗[関口一心 &lt;8888.salee]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15289">  15289 2010-04-22 18:58 　　　　　　┗[Mikiya Okuno &lt;Mikiya]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15290">  15290 2010-04-22 19:05 　　　　　　　┗[HIRATSUKA Sadao &lt;hir]                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15291">  15291 2010-04-22 21:36 　　　　　　　　┗[Mikiya Okuno &lt;Mikiya]                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="15292">  15292 2010-04-23 18:12 　　　　　　　　　┗[関口一心 &lt;8888.salee]                     </a></span>
</pre>
</body>
</html>
