<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:8361</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css.html">
</head>
<body>
<p class="button"><a href="8360.html">[前]</a><a href="8362.html">[次]</a><a href="../list/8301-8400.html">[番号順一覧]</a><a href="../thread/8301-8400.html">[スレッド一覧]</a></p>
<p class="id">
mysql:8361
</p>
<div class="header">
<p>
From: とみたまさひろ &lt;とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 3 Nov 2003 21:52:43 +0900<br>
Subject: [mysql 08361] Re: レプリケーションの整合性チェック<br>

</p>
</div>
<div class="body">
<pre>
とみたです。

On Mon, 03 Nov 2003 18:08:37 +0900
&quot;HIROSE, Masaaki&quot; &lt;hirose31@xxxxxxxxxx&gt; wrote:

<span class="quote2">&gt; &gt; ひとつは、show slave status した際の Read_Master_Log_Pos</span>
<span class="quote2">&gt; &gt; カラムの数値と show master status した際の Position</span>
<span class="quote2">&gt; &gt; カラムの数値を比較し、合致していれば良いのかなと</span>
<span class="quote2">&gt; &gt; 考えているのですが、確証が持てません。</span>
<span class="quote2">&gt; &gt; </span>
<span class="quote2">&gt; &gt; 1) そもそもこれらのキーを基に判別して良いのか</span>
<span class="quote2">&gt; &gt; 	（Exec_master_log_pos との違いは？）</span>
<span class="quote2">&gt; &gt; 2) 整合性が維持されていれば必ず一致するのかどうか</span>
<span class="quote2">&gt; &gt; 3) ネットワーク（その他の）遅延をどう考慮するか</span>

<span class="quote1">&gt; 理想的には、master の Position、slave の Read_Master_Log_Pos,</span>
<span class="quote1">&gt; Exec_Master_Log_Pos の 3 つの値が常に一致しているとよいのですが、</span>
<span class="quote1">&gt; master に更新系のクエリが多かったり、master - slave 間のネットワークが</span>
<span class="quote1">&gt; 遅かったり、master に比べて貧弱だったり他の要因で負荷がかかったりして</span>
<span class="quote1">&gt; いて slave の SQL スレッドの処理が遅れているなどなどの理由で、これら 3</span>
<span class="quote1">&gt; つの値がいつも同一となるとは限らないと思いますし、同一でないからといっ</span>
<span class="quote1">&gt; てレプリケーションが正常動作していないとは言えないと思います。</span>

次のようなロジックのスクリプトを書いたことがあります。

1. log_file と log_pos の値がマスタとスレーブで一致していれば ＯＫ
2. でなければ、数秒待って log_pos が更新されていれば ＯＫ
3. でなければ、ＮＧ

これで本当にいいのかわかりませんが (^^;

<span class="quote1">&gt; O'REILLY の『High Performance MySQL』(12/1発売)が楽しみなんですが、どっ</span>
<span class="quote1">&gt; かに目次とか出てないすかね。</span>

お、そんな本が出るんですか。楽しみですね。

-- 
とみたまさひろ &lt;tommy@xxxxxxxxxx&gt;
日本MySQLユーザ会 <a href="../../../index.html">http://www.mysql.gr.jp</a>

</pre>
</div>
<p class="button"><a href="8360.html">[前]</a><a href="8362.html">[次]</a><a href="../list/8301-8400.html">[番号順一覧]</a><a href="../thread/8301-8400.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="8341.html">   8341 2003-10-30 16:42 [Okamoto RYO &lt;ryo@xxx] レプリケーションの整合性チェック        </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8359.html">   8359 2003-11-03 18:08 ┗[&quot;HIROSE, Masaaki&quot; &lt;h]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8360.html">   8360 2003-11-03 18:37 　┣[Okamoto RYO &lt;ryo@xxx]                                     </a></span>
<span class="current">-&gt;&nbsp;<a href="8361.html">   8361 2003-11-03 21:52 　┗[とみたまさひろ &lt;tomm]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8375.html">   8375 2003-11-05 01:18 　　┗[Okamoto RYO &lt;ryo@xxx]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8379.html">   8379 2003-11-06 02:05 　　　┗[&quot;HIROSE, Masaaki&quot; &lt;h]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="8380.html">   8380 2003-11-07 00:05 　　　　┗[とみたまさひろ &lt;tomm]                               </a></span>
</pre>
</body>
</html>
