<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6019</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="6018.html">[前]</a><a href="6020.html">[次]</a><a href="../list/6001-6100.html">[番号順一覧]</a><a href="../thread/6001-6100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:6019
</p>
<div class="header">
<p>
From: &quot;MIYATSU Kazunari&quot; &lt;&quot;MIYATSU Kazunari&quot; &lt;mid@xxxxxxxxxx&gt;&gt;<br>
Date: Thu, 29 Aug 2002 12:32:20 +0900<br>
Subject: [mysql 06019] Re: ファイルの保存（その２）<br>

</p>
</div>
<div class="body">
<pre>
FSでの管理が楽というのが一つの落とし穴になったことがあります。

さる企業の社内LAN向けに標準文書管理システムとして納品しましたが、数年後不明
瞭なディスクスペース不足が起こりました。

そのスクリプトでは階層化した保存ディレクトリとファイルへのパスをMySQLに収録
し、呼び出し時にはスクリプトからリダイレクトする構造をとっていたのですが、原
因を追ってゆくとスクリプトが書込み操作できない権限属性のファイルとフォルダが
多量に蓄積されていました。

よくよく聞いてみると、大量にファイルを登録する際、登録スクリプトを介さず保存
フォルダに直接コピーし、後でMySQLにそれを一括挿入するという運用を行っていた
ようです。

ファイルが不要になりスクリプト側から消去操作を行っても権限不足として扱われ、
実ファイルは残り、DBからは消去された状態となり、不要なデットファイルでディス
クが埋まってしまった訳です。

その後はこの運用はイレギュラーである旨を説明し、ファイル消去の段階で操作完了
しなければエラーとして管理者に報告するトラップを設け、ユーザ・グループの権限
を見直し、複数一括登録のオプションを新設するなどの対応を行いました。

また、保存スクリプトを通過する際に元ファイル名をDBに収録し、ユニークな数字を
付加したファイル名にリネームして保存し、呼び出し時にはスクリプト経由で元ファ
イル名を添付し送り出すようにしました。PDFなどがサポートするPartialcontentは
使用不能になりましたが…。

要は利便性と説明の不足だった訳ですが。


</pre>
</div>
<p class="button"><a href="6018.html">[前]</a><a href="6020.html">[次]</a><a href="../list/6001-6100.html">[番号順一覧]</a><a href="../thread/6001-6100.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="6011.html">   6011 2002-08-28 14:02 [&lt;m-kanata@xxxxxxxxxx] ファイルの保存（その２）                </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6015.html">   6015 2002-08-28 18:48 ┗[&quot;Hiroaki,Sakuma&quot; &lt;sa]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="6019.html">   6019 2002-08-29 12:32 　┗[&quot;MIYATSU Kazunari&quot; &lt;]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6020.html">   6020 2002-08-29 13:10 　　┗[&quot;Hiroaki,Sakuma&quot; &lt;sa]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="6021.html">   6021 2002-08-29 14:01 　　　┗[&quot;MIYATSU Kazunari&quot; &lt;]                                 </a></span>
</pre>
</body>
</html>
