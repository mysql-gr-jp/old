<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:13540</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="13539">[前]</a><a href="13541">[次]</a><a href="../list/13501-13600">[番号順一覧]</a><a href="../thread/13501-13600">[スレッド一覧]</a></p>
<p class="id">
mysql:13540
</p>
<div class="header">
<p>
From: &lt;xbox@xxxxxxxxxx&gt;<br>
Date: 22 Nov 2006 15:52:58 +0900<br>
Subject: [mysql 13540] Re: [質問]突如データベース接続不能となってしまいました。<br>

</p>
</div>
<div class="body">
<pre>
さとうふみやすさん はじめまして！
レスポンスありがとうございます。

<span class="quote2">&gt; &gt; 1./var/runの下にmysqldのディレクトリが無いのは正常なのか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 異常です。</span>

うっ・・・やはりですか。

 
<span class="quote2">&gt; &gt; 2./usr/share/の下にmysqlのディレクトリが無いのは正常なのか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 異常です。</span>

くぅ苦しすぎる。やはりそうなのですね。


<span class="quote1">&gt; パッケージが remove されているか purge されてしまって</span>
<span class="quote1">&gt; いるんじゃないでしょうか? `dpkg -l 'mysql*'` で何と表示されますか?</span>

上記のご質問をさせていただいたのが、同じくパッケージから破損
したか、削除されてしまったのでは無いかと、なんとなく想像して
いたからだったのですが、少しパニックぎみで、パッケージを確認
せずにMLへの投稿を行ってしまいました。
誠に申し訳ありません。

実際に行ってみました。

要望=(U)不明/(I)インストール/(R)削除/(P)完全削除/(H)維持
<span class="quote1">| 状態=(N)無/(I)インストール済/(C)設定/(U)展開/(F)設定失敗/(H)半インストール</span>
<span class="quote1">|/ エラー=(空欄)無/(H)維持/(R)要再インストール/X=両方(状態,エラーの大文字=異常)</span>
<span class="quote2">||/ 名前             バージョン       説明</span>
+++-================-================-================================================
un  mysql            &lt;なし&gt;           (説明(description)がありません)
pn  mysql-admin      &lt;なし&gt;           (説明(description)がありません)
pn  mysql-admin-comm &lt;なし&gt;           (説明(description)がありません)
un  mysql-base       &lt;なし&gt;           (説明(description)がありません)
pn  mysql-client     &lt;なし&gt;           (説明(description)がありません)
ii  mysql-client-4.1 4.1.15-0.dotdeb. mysql database client binaries
pn  mysql-client-5.0 &lt;なし&gt;           (説明(description)がありません)
ii  mysql-common     5.0.24a-2.dotdeb mysql database common files (e.g. /etc/mysql/my.
rc  mysql-common-4.1 4.1.11a-4sarge7  mysql database common files (e.g. /etc/mysql/my.
un  mysql-dev        &lt;なし&gt;           (説明(description)がありません)
un  mysql-devel      &lt;なし&gt;           (説明(description)がありません)
un  mysql-doc        &lt;なし&gt;           (説明(description)がありません)
un  mysql-gpl-client &lt;なし&gt;           (説明(description)がありません)
un  mysql-gpl-dev    &lt;なし&gt;           (説明(description)がありません)
pn  mysql-navigator  &lt;なし&gt;           (説明(description)がありません)
pn  mysql-query-brow &lt;なし&gt;           (説明(description)がありません)
pn  mysql-query-brow &lt;なし&gt;           (説明(description)がありません)
pn  mysql-server     &lt;なし&gt;           (説明(description)がありません)
rc  mysql-server-4.1 4.1.15-0.dotdeb. mysql database server binaries
pn  mysql-server-5.0 &lt;なし&gt;           (説明(description)がありません)
pn  mysqltcl         &lt;なし&gt;           (説明(description)がありません)



すみません。
mysqlを起動するに最低限必要なものが何かがわからなくなってき
ました。

現状では
mysql-client-4.1
mysql-common
しか入っていないですね・・・

そもそも、最初に投稿させていただいた中では
Mysql4.0.24 と書かせていただいたのですが、これの確認は
phpinfoからの情報でした。
バージョン情報がおかしいこともさることながら、
mysql-server-4.1がrc（削除）になっていますね・・・

なぜこのような事態になったのかが、イメージできないのですが。

依存関係で必要なものは出てくるとは思うのですが、最低限必要な
ものはどれなのでしょうか。

 
<span class="quote2">&gt; &gt; 3.mysqldが起動していない状態での、データベースの保存（バッ</span>
<span class="quote2">&gt; &gt; クアップ手段があるのか？）は可能でしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; datadir で指定していあるディレクトリ (Debian の mysql-server なら</span>
<span class="quote1">&gt; デフォルトは /var/lib/mysql) があるなら、そいつをそのまま</span>
<span class="quote1">&gt; コピーすればバックアップになります。</span>

ありがとうございます。

このデータのリストア方法は、mysqlの再インストール後、必要な
データベースを作成し、その上に上書きインストールで可能なので
しょうか？

 
<span class="quote1">&gt; もし mysql-server パッケージが purge されているなら、</span>
<span class="quote1">&gt; インストール時に debconf に聞かれる「Remove the databases from</span>
<span class="quote1">&gt; all MySQL versions?」に yes と設定してあると /var/lib/mysql は</span>
<span class="quote1">&gt; 削除されているはずです。(デフォルトは no)</span>

この度はパッケージの操作を行っていないのですが、通常はNOを選
択しています。ただ、パージのフラグが多数たっていますね。
謎です。



<span class="quote1">&gt; # debconf-show mysql-server |grep postrm_remove_databases</span>
<span class="quote1">&gt; mysql-server/postrm_remove_databases: false</span>
<span class="quote1">&gt; </span>

既に登録してあるデータを再利用できるように、mysqlをdebパッケー
ジからインストールするには、どのような方法が良いのかを再質問
させていただいてもよろしいでしょうか。

最後に再インストールを行おうと考えますが、何か注意点とかあり
ますでしょうか。

よろしくお願いいたします。


<span class="quote1">&gt;さとうふみやす @ OSS テクノロジです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;At 22 Nov 2006 14:00:51 +0900,</span>
<span class="quote1">&gt;&lt;xbox@xxxxxxxxxx&gt; wrote:</span>
<span class="quote2">&gt;&gt; 現在Debian Sage上にてMysql4.0.24 をインストールし、CMSとし</span>
<span class="quote2">&gt;&gt; てXoopsを利用していたのですが、昨晩より下記のエラーが発生</span>
<span class="quote2">&gt;&gt; し、データーベースへの接続が不能となってしまいました。</span>
<span class="quote1">&gt;   *** snip ***</span>
<span class="quote2">&gt;&gt; 1./var/runの下にmysqldのディレクトリが無いのは正常なのか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;異常です。</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; 2./usr/share/の下にmysqlのディレクトリが無いのは正常なのか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;異常です。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;パッケージが remove されているか purge されてしまって</span>
<span class="quote1">&gt;いるんじゃないでしょうか? `dpkg -l 'mysql*'` で何と表示されますか?</span>
<span class="quote1">&gt;</span>
<span class="quote2">&gt;&gt; 3.mysqldが起動していない状態での、データベースの保存（バッ</span>
<span class="quote2">&gt;&gt;   クアップ手段があるのか？）は可能でしょうか？</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;datadir で指定していあるディレクトリ (Debian の mysql-server なら</span>
<span class="quote1">&gt;デフォルトは /var/lib/mysql) があるなら、そいつをそのまま</span>
<span class="quote1">&gt;コピーすればバックアップになります。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;もし mysql-server パッケージが purge されているなら、</span>
<span class="quote1">&gt;インストール時に debconf に聞かれる「Remove the databases from</span>
<span class="quote1">&gt;all MySQL versions?」に yes と設定してあると /var/lib/mysql は</span>
<span class="quote1">&gt;削除されているはずです。(デフォルトは no)</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;  # debconf-show mysql-server |grep postrm_remove_databases</span>
<span class="quote1">&gt;    mysql-server/postrm_remove_databases: false</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;-- </span>
<span class="quote1">&gt;-- Name: SATOH Fumiyasu / fumiyas @ osstech.co.jp</span>
<span class="quote1">&gt;-- Business Home: <a href="http://www.OSSTech.co.jp">http://www.OSSTech.co.jp</a></span>
<span class="quote1">&gt;-- Personal Home: <a href="http://www.SFO.jp/blog/">http://www.SFO.jp/blog/</a></span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>

</pre>
</div>
<p class="button"><a href="13539">[前]</a><a href="13541">[次]</a><a href="../list/13501-13600">[番号順一覧]</a><a href="../thread/13501-13600">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="13540">  13540 2006-11-22 15:52 [&lt;xbox@xxxxxxxxxx&gt;   ] Re: [質問]突如データベース接続不能となってしまいました。</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="13543">  13543 2006-11-22 16:27 ┗[SATOH Fumiyasu &lt;fumi]                                       </a></span>
</pre>
</body>
</html>
