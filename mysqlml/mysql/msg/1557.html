<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:1557</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="1556.html">[前]</a><a href="1558.html">[次]</a><a href="../list/1501-1600.html">[番号順一覧]</a><a href="../thread/1501-1600.html">[スレッド一覧]</a></p>
<p class="id">
mysql:1557
</p>
<div class="header">
<p>
From: &quot;yuki&quot; &lt;&quot;yuki&quot; &lt;yuki@xxxxxxxxxx&gt;&gt;<br>
Date: Tue, 8 Feb 2000 09:03:36 +0900<br>
Subject: [mysql 01557] NT 認証について<br>

</p>
</div>
<div class="body">
<pre>
みなさん、はじめまして。
YUKIといいます。どうぞよろしくお願いします。

-------------------------------------------------------------------

NT4Server（SP5）+SQL-Server（SP1）+IISVer4（SP5）+IE5
の環境で、Web（ASP）をつかった社内DBシステムを構築しております。

ASPの書き方＋認証についての質問です。
ASPでNT認証アクセスするにはどうすればいいのでしょうか？


以下、詳細
-------------------------------------------------------------------

SQL Serverへアクセスする際の認証ですが、現在はServer認証で

 set db = Server.CreateObject(&quot;ADODB.Connection&quot;)
 db.Open &quot;provider=sqloledb;User ID=yuki;PassWord=yuki; data source=yukiDB&quot;

とやりまして、問題なくいきました。
この方法だとIDとPASSWORDの入力ダイアログを、どこかで作らなければなりません。
そこで、NT認証をつかって決まったユーザからのアクセスだけ許可しようとしたので
す。

マニュアルにはIDを空にするとNT認証モードに自動でなるとかあるので、

 set db = Server.CreateObject(&quot;ADODB.Connection&quot;)
 db.Open &quot;provider=sqloledb;User ID=;PassWord=; data source=yukiDB&quot;

そうすると
Microsoft OLE DB Provider for SQL Server エラー '80040e4d'
ユーザー 'IUSR_yukiDB' はログインできませんでした。

とエラーがでてきます。
'IUSR_yukiDB'は匿名ログイン名に気付き、IISの匿名ログイン許可がいけないのかな
と思い

IISの「規定のWebサイトのプロパティ」-「ディレクトリ セキュリティ」-「匿名ア
クセスと認証制御」
で匿名アクセスの許可のチェックをはずしました。
その際、基本認証とWindowsNTチャレンジ/レスポンスっていうのがあり後者は？？？
だったので基本認証にチェックをつけ、ドメイン名を選択しました。

そうすると
「ネットワーク　パスワードの入力」ダイアログが表示され
しかもドメインに登録されているはずのユーザIDとパスワードを入力しても
なにをしても拒否されます。

（ちなみにNTチャレンジ/レスポンスでもやってみましたが、
401.2 権限がありません: サーバーの設定のためログオンに失敗しました。
でこけます。）
-------------------------------------------------------------------

上記のように色々やってみましたが、結局ダメでした。
なんとなく私としてはNT認証の仕組みと、ASPのログイン記述・・・
 db.Open &quot;provider=sqloledb;User ID=;PassWord=yuki; data source=yukiDB&quot;
自体間違っているような気もしています。

ASPでNT認証モードでログインするにはどうすればいいのでしょうか？
どうぞ、ご教示願います。


YUKI

-------------------------------------------------------------------
※補足
HELPをみるとセキュリティには４段階あり、、、

WindowsNTドメインレベルのセキュリティ
↓
WindowsNTコンピュータレベルのセキュリティ
↓
SQL Serverログインのセキュリティ
↓
データベースのユーザーと権限

とあります。
おそらくSQL Serverのログインで失敗しているように思うのですが・・・
もうどこでひっかかっているのか分かりません。




</pre>
</div>
<p class="button"><a href="1556.html">[前]</a><a href="1558.html">[次]</a><a href="../list/1501-1600.html">[番号順一覧]</a><a href="../thread/1501-1600.html">[スレッド一覧]</a></p>
<pre class="list">
<span class="current">-&gt;&nbsp;<a href="1557.html">   1557 2000-02-08 09:03 [&quot;yuki&quot; &lt;yuki@xxxxxxx] NT 認証について                         </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="1582.html">@  1582 2000-02-15 11:32 ┗[&quot;yuki&quot; &lt;yuki@xxxxxxx] システム DB を非表示に                </a></span>
</pre>
</body>
</html>
