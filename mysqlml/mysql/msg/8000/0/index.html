<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-2022-jp">
<TITLE>メッセージ</TITLE>

<META content="MSHTML 6.00.2800.1170" name=GENERATOR></HEAD>
<BODY>
<DIV><FONT size=2>こんにちは、熊田と申します。</FONT></DIV>
<DIV><FONT size=2>現在、ＶＣ＋＋で開発を行っているのですが、次のようなことを実現するのに失敗しています。</FONT></DIV>
<DIV><FONT size=2>　</FONT></DIV>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>/---------------------------------------------------------------------/</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>ある、当日レコード　"IDTable 当日日付のレコード" 
を複数のアプリケーションから更新する為、</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>ＬＯＣＫ／ＵＮＬＯＣＫを使用しようと考えています。</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>strSQL = _T("LOCK TABLES 
IDTable WRITE") ;<BR>mysql_real_query( mysqlMAGConn, strSQL, strSQL.GetLength() 
) ;&nbsp;&nbsp;</FONT></SPAN><SPAN class=001345710-08072003><FONT 
size=2>&nbsp;----&gt;</FONT></SPAN><SPAN class=001345710-08072003><FONT 
size=2>&nbsp;読み書きロック</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>　　　</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>"IDTable" 
の当日レコードを読み込みフィールドを更新<BR></FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>UPDATE 
にてレコード更新</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>&nbsp;strSQL = _T("UNLOCK 
TABLES") ;<BR>&nbsp;mysql_real_query( mysqlMAGConn, strSQL, strSQL.GetLength() ) 
; -----&gt; ロック解除</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>/---------------------------------------------------------------------/</FONT></SPAN></DIV></FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>のようなことをしています。</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>しかし、データを見てみると更新したフィールドが何も変わっていません．．．．</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT 
size=2>どのように　LOCK/UNLOCK　するのが正しいのでしょうか？</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>よろしくお願いします。</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>■環境</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>　　Windows XP Pro + .NET Stadio 
2003 VC++</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp; MySQL 
Ver.4.0.13</FONT></SPAN></DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=001345710-08072003><FONT size=2>
<DIV><FONT 
size=2>/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/<BR>　熊田　十志之&nbsp;&nbsp; 
　　　　　　 E-mail : </FONT><A href="mailto:kumada@goodf.co.jp"><FONT 
size=2>kumada@goodf.co.jp</FONT></A><FONT size=2>&nbsp; 
<BR>/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/~/_/<BR></FONT></DIV></DIV></FONT></SPAN></BODY></HTML>

