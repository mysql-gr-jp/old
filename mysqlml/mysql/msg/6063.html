<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:6063</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="6062.html">[前]</a><a href="6064.html">[次]</a><a href="../list/6001-6100.html">[番号順一覧]</a><a href="../thread/6001-6100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:6063
</p>
<div class="header">
<p>
From: "Y.Higashi" &lt;"Y.Higashi" &lt;Y.Higashi@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 02 Sep 2002 18:27:22 +0900<br>
Subject: [mysql 06063] Re: クラスが認識されない？<br>

</p>
</div>
<div class="body">
<pre>ヒガシです。

$modeが"show"で渡された場合、$metaが生成されないのでは、、、、？
MySQLとは全然関係ないですが、、、、。


<span class="quote1">&gt;こんにちは、萩原と申します。</span>
<span class="quote1">&gt;MYSQL&amp;PHP4.0.6で、PHPクラスを利用したDB検索ページを作成しているのですが、検</span>
<span class="quote1">&gt;索フォームの入力後にボタンを押すと、下記のようなエラーが出ます。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;Fatal error: Call to a member function on a non-object in </span>
<span class="quote1">&gt;/home/virtual/site4/fst/var/www/・・・・・/ex5.php on line 30</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;ex5.phpのソースは次の通りで、</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;&lt;?php</span>
<span class="quote1">&gt;$include_path=".";</span>
<span class="quote1">&gt;require("$include_path/dbconnect.ini");</span>
<span class="quote1">&gt;require("$include_path/pgmetadata.ini");</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$d = new DbConnect;</span>
<span class="quote1">&gt;if(!isset($mode)){	</span>
<span class="quote1">&gt;  @session_destroy();</span>
<span class="quote1">&gt;  $meta = new PgMetadata;</span>
<span class="quote1">&gt;  $mode = "search";</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;session_register("meta");</span>
<span class="quote1">&gt;?&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;&lt;html&gt;</span>
<span class="quote1">&gt;&lt;head&gt;&lt;title&gt;Example 5&lt;/title&gt;</span>
<span class="quote1">&gt;&lt;/head&gt;</span>
<span class="quote1">&gt;&lt;body&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;&lt;?php</span>
<span class="quote1">&gt;if($mode == "search"){</span>
<span class="quote1">&gt;$meta-&gt;printForm();　// 検索フォームを表示</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;elseif($mode == "show"){</span>
<span class="quote1">&gt;$meta-&gt;makeSQL();　//　検索結果を表示　←30行目</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;$d-&gt;doClose();</span>
<span class="quote1">&gt;?&gt;</span>
<span class="quote1">&gt;&lt;/body&gt;</span>
<span class="quote1">&gt;&lt;/html&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;$meta-&gt;printForm();　は認識されて、検索フォームが表示するのに、</span>
<span class="quote1">&gt;$meta-&gt;makeSQL();　は認識されないみたいで、原因が判りかねて困っています。</span>
<span class="quote1">&gt;もし、原因が判る方が居ましたら、是非ご教授いただきたく思います。</span>
<span class="quote1">&gt;よろしくお願いします。</span>
<span class="quote1">&gt;ちなみに、pgmetadata.iniのソースは下記の通りです。</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;&lt;?php</span>
<span class="quote1">&gt;class PgMetaData {</span>
<span class="quote1">&gt;function printForm(){</span>
<span class="quote1">&gt;$str = &lt;&lt;&lt; EOF</span>
<span class="quote1">&gt;&lt;form name="form1" method="post" action="$PHP_SELF?mode=show"&gt;</span>
<span class="quote1">&gt;  日付　&lt;input type="text" name="day"&gt;&lt;p&gt;</span>
<span class="quote1">&gt;　天気　&lt;input type="text" name="tenki"&gt;&lt;p&gt;</span>
<span class="quote1">&gt;  温度　&lt;input type="text" name="ondo"&gt;&lt;p&gt;</span>
<span class="quote1">&gt;  雨量　&lt;input type="text" name="uryou"&gt;&lt;p&gt;</span>
<span class="quote1">&gt;  &lt;input type="submit" name="submit" value="検索開始"&gt;    　</span>
<span class="quote1">&gt;  &lt;input type="reset" name="submit2" value="クリア"&gt;</span>
<span class="quote1">&gt;&lt;/form&gt;</span>
<span class="quote1">&gt;EOF;</span>
<span class="quote1">&gt;print($str);</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;function makeSQL(){</span>
<span class="quote1">&gt;if($day == "" &amp;&amp; $tenki == "" &amp;&amp; $ondo == "" &amp;&amp; $uryou == ""){</span>
<span class="quote1">&gt;echo; "検索したい事項を入力してください";}</span>
<span class="quote1">&gt;else{</span>
<span class="quote1">&gt;if($day == ""){</span>
<span class="quote1">&gt;$day = '%';</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;if($tenki == ""){</span>
<span class="quote1">&gt;$tenki = '%';</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;if($ondo == ""){</span>
<span class="quote1">&gt;$ondo = '%';</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;if($uryou == ""){</span>
<span class="quote1">&gt;$uryou = '%';</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;$result02 = mysql_query("select * from OTENKI where DAY like '$day'</span>
<span class="quote1">&gt;and TENKI like '$tenki' and ONDO like '$ondo' and RYOU like '$uryou'");</span>
<span class="quote1">&gt;$rows = mysql_num_rows($result02);</span>
<span class="quote1">&gt;echo $rows,</span>
<span class="quote1">&gt;"件のデータがあります。&lt;P&gt;";</span>
<span class="quote1">&gt;while($row =mysql_fetch_array($result02)){</span>
<span class="quote1">&gt;echo $row["DAY"],</span>
<span class="quote1">&gt;     " ",</span>
<span class="quote1">&gt;     $row["TENKI"],</span>
<span class="quote1">&gt;     " ",</span>
<span class="quote1">&gt;	 $row["ONDO"],</span>
<span class="quote1">&gt;     " ",	 </span>
<span class="quote1">&gt;	 $row["RYOU"],</span>
<span class="quote1">&gt;     "&lt;p&gt;";</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;}</span>
<span class="quote1">&gt;?&gt;</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;-------------------------</span>
<span class="quote1">&gt;萩原亘</span>
<span class="quote1">&gt;todorokeitiban@xxxxxxxxxx</span>
<span class="quote1">&gt;</span>
<span class="quote1">&gt;_________________________________________________________________</span>
<span class="quote1">&gt;会員登録は無料・充実した出品アイテムなら MSN オークション </span>
<span class="quote1">&gt;<a href="http://auction.msn.co.jp/">http://auction.msn.co.jp/</a></span>

</pre>
</div>
<p class="button"><a href="6062.html">[前]</a><a href="6064.html">[次]</a><a href="../list/6001-6100.html">[番号順一覧]</a><a href="../thread/6001-6100.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="6062.html">   6062 2002-09-02 17:57 ["hagi wata" &lt;todorok] クラスが認識されない？                  </a></span>
<span class="current">-&gt;&nbsp;<a href="6063.html">   6063 2002-09-02 18:27 ┗["Y.Higashi" &lt;Y.Higas]                                       </a></span>
</pre>


</body></html>