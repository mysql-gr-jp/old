<html>
<head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:10047</title>
<link rel=stylesheet type="text/css" href="../../../css/w3ml.css">
</head>
<body>
<p class="button"><a href="10046.html">[前]</a><a href="10048.html">[次]</a><a href="../list/10001-10100.html">[番号順一覧]</a><a href="../thread/10001-10100.html">[スレッド一覧]</a></p>
<p class="id">
mysql:10047
</p>
<div class="header">
<p>
From: Kouichi Matsumoto &lt;Kouichi Matsumoto &lt;matchori@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 23 Aug 2004 16:14:19 +0900<br>
Subject: [mysql 10047] Re: MySQLにカレンダーテーブルはありますか？<br>

</p>
</div>
<div class="body">
<pre>
片寄さん、はじめまして。松本です。

<span class="quote1">&gt; 平均値を求める評価式は、何日間？</span>
週間、月間、年間を予定しています。

<span class="quote1">&gt; 　過去すべてですか？移動平均のように区間を決めないのですか？</span>
できたら株のように移動平均も面白いと思います。ただまずは
その日までの平均が毎日表示できればと思ってます。

少し投稿内容が間違っていましたのでやりたいことを説明します。
SQLで取得したいのは、
「範囲指定したカレンダーと、その日毎の平均点」のリストです。

取得までできれば、あとはプログラム側で計算しようと思っています。
現在はレコードがある日しかカレンダーが取得できず困っています。

■仕様
・最初にプログラムで公開価格を任意に指定します。
・評価は日本になじんだ？5段階評価で各自がつけられます。
  つまり平均値3とします。
・評価により価格が毎日変動します。
  ※その日の評価が平均値3(普通)なら変動はありません。
・上記結果を週間、月間、年間でグラフ表示します。

■例
○8/20  初値 100,000円
○8/20  評価は2人で、4点と5点(平均 4.5点)
○8/20  グラフには102,000円を表示(４捨５入）
○8/21  評価は0人 102,000円を表示(現状維持)

<span class="quote1">&gt; 平均値は以下の式ですか？</span>
<span class="quote1">&gt; 　SUM(評価点）／COUNT(評価した回数)</span>
はい。レコードは評価毎に記録されますので、以下の8/20は、4.5点になります。
8/20 4点 Aさん
8/20 5点 Bさん
現在は、日付でGROUP BYしています。

ただ、現在は評価されない日があると歯抜け状態になって困っています。
例えば上のように8/20だけ登録されている場合、
今日までの日全てに4.5と表示したいのです。
■理想
8/20 4.5
8/21 4.5
8/22 4.5
8/23 4.5

■現在
8/20 4.5 と表示されます。

週間グラフは本日より1週間前のレコードでWHERE句に絞り込みSQLを
書いていいる為、今日が8/28だとしたら、
グラフには何も表示されない寂しい結果になってしまい悩んでいます。
これがLEFT JOIN カレンダーテーブルとかにできると評価のない日の
日付も取得でき理想的な表示にするのも簡単と思います。

<span class="quote1">&gt; 分母は経過日数ではないのですね？</span>
はい。

<span class="quote1">&gt; グラフ化ツールの機能は、全く考えないのですか？</span>
これは、JPGraphというツールを使う予定です。
しかし、SQL一発で結果が一覧にできると嬉しいです。

///* Kouichi.Matsumoto */



</pre>
</div>
<p class="button"><a href="10046.html">[前]</a><a href="10048.html">[次]</a><a href="../list/10001-10100.html">[番号順一覧]</a><a href="../thread/10001-10100.html">[スレッド一覧]</a></p>
<pre class="list">
<span>&nbsp;&nbsp;&nbsp;<a href="10045.html">  10045 2004-08-23 13:04 [Kouichi Matsumoto &lt;m] MySQLにカレンダーテーブルはありますか？ </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10046.html">  10046 2004-08-23 15:21 ┣[&quot;片寄白王&quot; &lt;katayose]                                       </a></span>
<span class="current">-&gt;&nbsp;<a href="10047.html">  10047 2004-08-23 16:14 ┃┗[Kouichi Matsumoto &lt;m]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10048.html">  10048 2004-08-23 18:34 ┃　┗[&quot;片寄白王&quot; &lt;katayose]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10049.html">  10049 2004-08-23 19:07 ┗[Naomasa Numajiri &lt;na]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10050.html">  10050 2004-08-23 21:41 　┗[Kouichi Matsumoto &lt;m]                                     </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="10053.html">  10053 2004-08-23 22:54 　　┗[深海水草 &lt;VYG01106@x]                                   </a></span>
</pre>
</body>
</html>
