<html><head>
<meta http-equiv="Content-Style-Type" context="text/css">
<title>mysql:5826</title>
<link rel="stylesheet" type="text/css" href="/css/w3ml.css">
</head>
<body>
<p class="button"><a href="5825.html">[前]</a><a href="5827.html">[次]</a><a href="../list/5801-5900.html">[番号順一覧]</a><a href="../thread/5801-5900.html">[スレッド一覧]</a></p>
<p class="id">
mysql:5826
</p>
<div class="header">
<p>
From: Daiju Azuma &lt;Daiju Azuma &lt;daiju_azuma@xxxxxxxxxx&gt;&gt;<br>
Date: Mon, 22 Jul 2002 13:58:11 +0900<br>
Subject: [mysql 05826] Re: INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方法<br>

</p>
</div>
<div class="body">
<pre>　前略

On Thu, 18 Jul 2002 10:42:06 +0900
Sugiyama &lt;sugiyama@xxxxxxxxxx&gt; wrote:

<span class="quote1">&gt; 　みなさん初めまして、杉山と申します。</span>
<span class="quote1">&gt; 　ＭｙＳＱＬで掲示板を作成中です。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　早速ですが、以下のようなテーブルがあります。</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; create table BBS (</span>
<span class="quote1">&gt; 	bbsno		bigint UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,</span>
<span class="quote1">&gt; 	refno		bigint UNSIGNED NOT NULL DEFAULT '0',</span>
<span class="quote1">&gt; 	KEY(refno),</span>
<span class="quote1">&gt; 　・・・以下略・・・</span>
<span class="quote1">&gt; );</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　このテーブルにInsertでレコードを追加するときに、項目bbsnoは、</span>
<span class="quote1">&gt; 　AUTO_INCREMENT属性（？）なので、自動的に値が設定されます。</span>
<span class="quote1">&gt; 　そのときに項目refnoの方にも、項目bbsnoと同じ値を設定したいのですが、</span>
<span class="quote1">&gt; 　どのどうにすればいいのでしょうか？</span>
<span class="quote1">&gt; </span>
<span class="quote1">&gt; 　今は、Insert後にUpdateで、項目refnoに項目bbsnoの値を設定しています。</span>
<span class="quote1">&gt; 　これを一回のＳＱＬで行うことは、できるのでしょうか？</span>

　外しているかも知れませんが，掲示板程度のデータ更新頻度なら
ば，以下のように，一つのaspファイル内で，複数回 SQL を連続で
実行しても支障はないような気がします。


&lt;%
'データの挿入

	sql = "insert into BBS (挿入するカラム名) values(挿入データ)"
	set rs = server.createobject("adodb.recordset")
	rs.open sql, conn

'続けて，refno が nul のデータに bbsnoの値を代入

	sql = "update BBS set refno = bbsno where refno is null"
	set rs = server.createobject("adodb.recordset")
	rs.open sql, conn

%&gt;

　僕自身，当初，複数のSQLの命令を一つの aspファイル内で実行
できると思ってなかったので，ずいぶん苦労しました。



-- 
神戸市教育委員会庶務課　情報企画係
　東　大樹　tel:078-322-5761 fax:078-322-6145
　Daiju Azuma &lt;daiju_azuma@xxxxxxxxxx&gt;
＞My job is reduce the cost and make you happy
  to using informationalized technology.


</pre>
</div>
<p class="button"><a href="5825.html">[前]</a><a href="5827.html">[次]</a><a href="../list/5801-5900.html">[番号順一覧]</a><a href="../thread/5801-5900.html">[スレッド一覧]</a></p>
<pre class="list"><span>&nbsp;&nbsp;&nbsp;<a href="5807.html">   5807 2002-07-18 10:42 [Sugiyama &lt;sugiyama@x] INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方法</a></span>
<span class="current">-&gt;&nbsp;<a href="5826.html">   5826 2002-07-22 13:58 ┗[Daiju Azuma &lt;daiju_a]                                       </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5831.html">   5831 2002-07-22 15:53 　┗[Sugiyama &lt;sugiyama@x] Re: INSERT 時に AUTO_INCREMENT の項目の値を別の項目にも設定する方</a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5835.html">   5835 2002-07-22 16:53 　　┗[Daiju Azuma &lt;daiju_a]                                   </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5836.html">   5836 2002-07-22 19:50 　　　┣[小西恒紀 &lt;tkonishi@x]                                 </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5837.html">   5837 2002-07-22 20:26 　　　┃┣["K.Ono" &lt;k-ono@xxxxx]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5838.html">   5838 2002-07-23 01:06 　　　┃┃┣["T.Konishi" &lt;tkonish]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5842.html">   5842 2002-07-23 10:08 　　　┃┃┃┗[Sugiyama &lt;sugiyama@x]                           </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5841.html">   5841 2002-07-23 10:07 　　　┃┃┗[Sugiyama &lt;sugiyama@x]                             </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5840.html">   5840 2002-07-23 10:01 　　　┃┗[Sugiyama &lt;sugiyama@x]                               </a></span>
<span>&nbsp;&nbsp;&nbsp;<a href="5839.html">   5839 2002-07-23 09:59 　　　┗[Sugiyama &lt;sugiyama@x]                                 </a></span>
</pre>


</body></html>